!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.3",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};function r(a){var b="length"in a&&a.length,c=m.type(a);return"function"!==c&&!m.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===c||0===b||"number"==typeof b&&0<b&&b-1 in a))}m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(0<=c&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],g!==(c=e[d])&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&0<=a-parseFloat(a)+1},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e=0,f=a.length,g=r(a);if(c){if(g)for(;e<f&&!1!==b.apply(a[e],c);e++);else for(e in a)if(!1===b.apply(a[e],c))break}else if(g)for(;e<f&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(!1===b.call(a[e],e,a[e]))break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?c<0?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;)a[e++]=b[d++];if(c!=c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var e=[],f=0,g=a.length,h=!c;f<g;f++)!b(a[f],f)!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,i=[];if(r(a))for(;f<g;f++)null!=(d=b(a[f],f,c))&&i.push(d);else for(f in a)null!=(d=b(a[f],f,c))&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),(e=function(){return a.apply(b||this,c.concat(d.call(arguments)))}).guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function(a,b,c){var d="0x"+b-65536;return d!=d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ea=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),d=d||[],k=(b=b||n).nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(!(h=b.getElementById(j))||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){for(o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;l--;)o[l]=s+ra(o[l]);w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function ha(){var a=[];return function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){for(var c=a.split("|"),e=a.length;e--;)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pa(a){return a&&void 0!==a.getElementsByTagName&&a}for(b in c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(o=(n=g).documentElement,(e=g.defaultView)&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(void 0!==b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d||(1&(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)i.unshift(c);for(;h[d]===i[d];)d++;return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<ga(b,n,null,[a]).length},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){for(;b=a[f++];)b===a[f]&&(e=d.push(f));for(;e--;)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else for(;b=a[d++];)c+=e(b);return c},(d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&-1<e.indexOf(c):"$="===b?c&&e.slice(-c.length)===c:"~="===b?-1<(" "+e.replace(Q," ")+" ").indexOf(c):"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(n=(j=(k=q[u]||(q[u]={}))[a]||[])[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[u]||(l[u]={}))[a]=[w,m]),l!==b)););return(m-=e)===d||m%d==0&&0<=m/d}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):1<e.length?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){for(var d,f=e(a,b),g=f.length;g--;)a[d=J(a,f[g])]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return 0<ga(a,b).length}}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return-1<(b.textContent||b.innerText||e(b)).indexOf(a)}}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do{if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:oa(function(){return[0]}),last:oa(function(a,b){return[b-1]}),eq:oa(function(a,b,c){return[c<0?c+b:c]}),even:oa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:oa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:oa(function(a,b,c){for(var d=c<0?c+b:c;0<=--d;)a.push(d);return a}),gt:oa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}}).pseudos.nth=d.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function qa(){}function ra(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if((h=(i=b[u]||(b[u]={}))[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if((i[d]=j)[2]=a(b,c,g))return!0}}}function ta(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||function(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d)for(j=va(r,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));if(f){if(e||a){if(e){for(j=[],k=r.length;k--;)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}for(k=r.length;k--;)(l=r[k])&&-1<(j=e?J(f,l):m[k])&&(f[j]=!(g[j]=l))}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b},h,!0),l=sa(function(a){return-1<J(b,a)},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if((c=d.filter[a[i].type].apply(null,a[i].matches))[u]){for(e=++i;e<f&&!d.relative[a[e].type];e++);return wa(1<i&&ta(m),1<i&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,i<e&&xa(a.slice(i,e)),e<f&&xa(a=a.slice(e)),e<f&&ra(a))}m.push(c)}return ta(m)}function ya(a,b){var c=0<b.length,e=0<a.length,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){for(m=0;o=a[m++];)if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){for(m=0;o=b[m++];)o(r,s,g,h);if(f){if(0<p)for(;q--;)r[q]||s[q]||(s[q]=F.call(i));s=va(s)}H.apply(i,s),k&&!f&&0<s.length&&1<p+b.length&&ga.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ia(f):f}return qa.prototype=d.filters=d.pseudos,d.setFilters=new qa,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=d.preFilter;h;){for(g in(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length)),d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)},h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){for(b||(b=g(a)),c=b.length;c--;)(f=xa(b[c]))[u]?d.push(f):e.push(f);(f=A(a,ya(e,d))).selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(2<(j=o[0]=o[0].slice(0)).length&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(!(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0]))return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}for(i=X.needsContext.test(a)?0:j.length;i--&&(k=j[i],!d.relative[l=k.type]);)if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),!(a=f.length&&ra(j)))return H.apply(e,f),e;break}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(K,function(a,b,c){var d;return c?void 0:!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return 0<=m.inArray(a,b)!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;b<e;b++)if(m.contains(d[b],this))return!0}));for(b=0;b<e;b++)m.find(a,d[b],c);return(c=this.pushStack(1<e?m.unique(c):c)).selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(!(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:z.exec(a))||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if((d=y.getElementById(c[2]))&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?void 0!==x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))}).prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};function D(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}m.extend({dir:function(a,b,c){for(var d=[],e=a[b];e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c));)1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?-1<g.index(c):1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),1<this.length&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var H,E=/\S+/g,F={};function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.Callbacks=function(a){a="string"==typeof a?F[a]||function(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&f<e;f++)if(!1===h[f].apply(l[0],l[1])&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){for(var d;-1<(d=m.inArray(c,h,d));)h.splice(d,1),b&&(d<=e&&e--,d<=f&&f--)}),this},has:function(a){return a?-1<m.inArray(a,h):!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=[a,(c=c||[]).slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var i,j,k,b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=1<arguments.length?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}};if(1<e)for(i=new Array(e),j=new Array(e),k=new Array(e);b<e;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}}),m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(!0===a?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);(m.isReady=!0)!==a&&0<--m.readyWait||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}}),m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var L,K="undefined";for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;(c=y.getElementsByTagName("body")[0])&&c.style&&(b=y.createElement("div"),(d=y.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return(1===c||9===c)&&(!b||!0!==b&&a.getAttribute("classid")===b)};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if("string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c)}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?null==(f=g[b])&&(f=g[m.camelCase(b)]):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:b=(b=m.camelCase(b))in d?[b]:b.split(" "),e=b.length;for(;e--;)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return!!(a=a.nodeType?m.cache[a[m.expando]]:a[m.expando])&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){for(c=g.length;c--;)g[c]&&(0===(d=g[c].name).indexOf("data-")&&O(f,d=m.camelCase(d.slice(5)),e[d]));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):1<arguments.length?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b);"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,function(){m.dequeue(a,b)},f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=m._data(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c))for(h in e=!0,c)m.access(a,b,h,c[h],!0,f,g);else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=!1===d.attributes[c].expando);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function aa(){return!0}function ba(){return!1}function ca(){try{return y.activeElement}catch(a){}}function da(a){var b=ea.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){for(c.handler&&(c=(i=c).handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||((k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)}).elem=a),h=(b=(b||"").match(E)||[""]).length;h--;)o=q=(f=_.exec(b[h])||[])[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||((n=g[o]=[]).delegateCount=0,j.setup&&!1!==j.setup.call(a,d,p,k)||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){for(j=(b=(b||"").match(E)||[""]).length;j--;)if(o=q=(h=_.exec(b[j])||[])[1],p=(h[2]||"").split(".").sort(),o){for(l=m.event.special[o]||{},n=k[o=(d?l.delegateType:l.bindType)||o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;f--;)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&!1!==l.teardown.call(a,p,r.handle)||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(0<=p.indexOf(".")&&(p=(q=p.split(".")).shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,(b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b)).isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||!1!==k.trigger.apply(d,c))){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}for(n=0;(h=o[n++])&&!b.isPropagationStopped();)b.type=1<n?i:k.bindType||p,(f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"))&&f.apply(h,c),(f=g&&h[g])&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),!1===b.result&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||!1===k._default.apply(o.pop(),c))&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){(l=d[g])&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if((i[0]=a).delegateTarget=this,!k.preDispatch||!1!==k.preDispatch.call(this,a)){for(h=m.event.handlers.call(this,a,j),b=0;(f=h[b++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,g=0;(e=f.handlers[g++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,void 0!==(c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i))&&!1===(a.result=c)&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(e=[],f=0;f<h;f++)void 0===e[c=(d=b[f]).selector+" "]&&(e[c]=d.needsContext?0<=m(c,this).index(i):m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;b--;)a[c=d[b]]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(e=(d=a.target.ownerDocument||y).documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ca()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===ca()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?aa:ba):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=aa,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=aa,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=aa,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,e=a.relatedTarget,f=a.handleObj;return(!e||e!==this&&!m.contains(this,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return!m.nodeName(this,"form")&&void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return!m.nodeName(this,"form")&&void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){for(f in"string"!=typeof b&&(c=c||b,b=void 0),a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),!1===d)d=ba;else if(!d)return this;return 1===e&&(g=d,(d=function(a){return m().off(a),g.apply(this,arguments)}).guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(!1===b||"function"==typeof b)&&(c=b,b=void 0),!1===c&&(c=ba),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});var ea="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fa=/ jQuery\d+="(?:null|\d+)"/g,ga=new RegExp("<(?:"+ea+")[\\s/>]","i"),ha=/^\s+/,ia=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ja=/<([\w:]+)/,ka=/<tbody/i,la=/<|&#?\w+;/,ma=/<(?:script|style|link)/i,na=/checked\s*(?:[^=]|=\s*.checked.)/i,oa=/^$|\/(?:java|ecma)script/i,pa=/^true\/(.*)/,qa=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ra={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ta=da(y).appendChild(y.createElement("div"));function ua(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ua(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function va(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wa(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xa(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function ya(a){var b=pa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function za(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Aa(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h)for(c in delete g.handle,g.events={},h)for(d=0,e=h[c].length;d<e;d++)m.event.add(b,c,h[c][d]);g.data&&(g.data=m.extend({},g.data))}}function Ba(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){for(d in(e=m._data(b)).events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xa(b).text=a.text,ya(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}ra.optgroup=ra.option,ra.tbody=ra.tfoot=ra.colgroup=ra.caption=ra.thead,ra.th=ra.td,m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!ga.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ta.innerHTML=a.outerHTML,ta.removeChild(f=ta.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ua(f),h=ua(a),g=0;null!=(e=h[g]);++g)d[g]&&Ba(e,d[g]);if(b)if(c)for(h=h||ua(a),d=d||ua(f),g=0;null!=(e=h[g]);g++)Aa(e,d[g]);else Aa(a,f);return 0<(d=ua(f,"script")).length&&za(d,!i&&ua(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=da(b),p=[],q=0;q<n;q++)if((f=a[q])||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(la.test(f)){for(h=h||o.appendChild(b.createElement("div")),i=(ja.exec(f)||["",""])[1].toLowerCase(),l=ra[i]||ra._default,h.innerHTML=l[1]+f.replace(ia,"<$1></$2>")+l[2],e=l[0];e--;)h=h.lastChild;if(!k.leadingWhitespace&&ha.test(f)&&p.push(b.createTextNode(ha.exec(f)[0])),!k.tbody)for(e=(f="table"!==i||ka.test(f)?"<table>"!==l[1]||ka.test(f)?0:h:h.firstChild)&&f.childNodes.length;e--;)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(m.merge(p,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));for(h&&o.removeChild(h),k.appendChecked||m.grep(ua(p,"input"),va),q=0;f=p[q++];)if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ua(o.appendChild(f),"script"),g&&za(h),c))for(e=0;f=h[e++];)oa.test(f.type||"")&&c.push(f);return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(g=(f=d[i])&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||wa(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wa(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ua(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&za(ua(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&m.cleanData(ua(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fa,""):void 0;if(!("string"!=typeof a||ma.test(a)||!k.htmlSerialize&&ga.test(a)||!k.leadingWhitespace&&ha.test(a)||ra[(ja.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ia,"<$1></$2>");try{for(;c<d;c++)1===(b=this[c]||{}).nodeType&&(m.cleanData(ua(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ua(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||1<l&&"string"==typeof p&&!k.checkClone&&na.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=(i=m.buildFragment(a,this[0].ownerDocument,!1,this)).firstChild,1===i.childNodes.length&&(i=c),c)){for(f=(g=m.map(ua(i,"script"),xa)).length;j<l;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ua(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,ya),j=0;j<f;j++)d=g[j],oa.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qa,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;d<=h;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Ca,Da={};function Ea(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fa(a){var b=y,c=Da[a];return c||("none"!==(c=Ea(a,b))&&c||((b=((Ca=(Ca||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement))[0].contentWindow||Ca[0].contentDocument).document).write(),b.close(),c=Ea(a,b),Ca.detach()),Da[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){return null!=a?a:(a=!1,(c=y.getElementsByTagName("body")[0])&&c.style?(b=y.createElement("div"),(d=y.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0);var b,c,d}}();var Ia,Ja,Ga=/^margin/,Ha=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ka=/^(top|right|bottom|left)$/;function La(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}a.getComputedStyle?(Ia=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)},Ja=function(a,b,c){var d,e,f,g,h=a.style;return g=(c=c||Ia(a))?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Ha.test(g)&&Ga.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ia=function(a){return a.currentStyle},Ja=function(a,b,c){var d,e,f,g,h=a.style;return null==(g=(c=c||Ia(a))?c[b]:void 0)&&h&&h[b]&&(g=h[b]),Ha.test(g)&&!Ka.test(b)&&(d=h.left,(f=(e=a.runtimeStyle)&&e.left)&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"}),function(){var b,c,d,e,f,g,h;if((b=y.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=(d=b.getElementsByTagName("a")[0])&&d.style){function i(){var b,c,d,i;(c=y.getElementsByTagName("body")[0])&&c.style&&(b=y.createElement("div"),(d=y.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,(i=b.appendChild(y.createElement("div"))).style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight),b.removeChild(i)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(i=b.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(g=0===i[0].offsetHeight)&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}})}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];for(f in e=c.apply(a,d||[]),b)a.style[f]=g[f];return e};var Ma=/alpha\([^)]*\)/i,Na=/opacity\s*=\s*([^)]*)/,Oa=/^(none|table(?!-c[ea]).+)/,Pa=new RegExp("^("+S+")(.*)$","i"),Qa=new RegExp("^([+-])=("+S+")","i"),Ra={position:"absolute",visibility:"hidden",display:"block"},Sa={letterSpacing:"0",fontWeight:"400"},Ta=["Webkit","O","Moz","ms"];function Ua(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ta.length;e--;)if((b=Ta[e]+c)in a)return b;return d}function Va(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)(d=a[g]).style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fa(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;g<h;g++)(d=a[g]).style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wa(a,b,c){var d=Pa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xa(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Ya(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ia(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(((e=Ja(a,b,f))<0||null==e)&&(e=a.style[b]),Ha.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xa(a,b,c||(g?"border":"content"),d,f)+"px"}function Za(a,b,c,d,e){return new Za.prototype.init(a,b,c,d,e)}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ja(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ua(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if("string"===(f=typeof c)&&(e=Qa.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c==c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ua(a.style,h)),(g=m.cssHooks[b]||m.cssHooks[h])&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Ja(a,b,d)),"normal"===f&&b in Sa&&(f=Sa[b]),""===c||c?(e=parseFloat(f),!0===c||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Oa.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Ra,function(){return Ya(a,b,d)}):Ya(a,b,d):void 0},set:function(a,c,d){var e=d&&Ia(a);return Wa(0,c,d?Xa(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Na.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";((c.zoom=1)<=b||""===b)&&""===m.trim(f.replace(Ma,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Ma.test(f)?f.replace(Ma,e):f+" "+e)}}),m.cssHooks.marginRight=La(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Ja,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Ga.test(a)||(m.cssHooks[a+b].set=Wa)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ia(a),e=b.length;g<e;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,1<arguments.length)},show:function(){return Va(this,!0)},hide:function(){return Va(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}}),((m.Tween=Za).prototype={constructor:Za,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Za.propHooks[this.prop];return a&&a.get?a.get(this):Za.propHooks._default.get(this)},run:function(a){var b,c=Za.propHooks[this.prop];return this.options.duration?this.pos=b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Za.propHooks._default.set(this),this}}).init.prototype=Za.prototype,(Za.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""))&&"auto"!==b?b:0:a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}}).scrollTop=Za.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Za.prototype.init,m.fx.step={};var $a,_a,ab=/^(?:toggle|show|hide)$/,bb=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cb=/queueHooks$/,db=[function(a,b,c){var d,e,f,g,h,i,j,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");for(d in c.queue||(null==(h=m._queueHooks(a,"fx")).unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),"inline"===("none"===j?m._data(a,"olddisplay")||Fa(a.nodeName):j)&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fa(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]})),b)if(e=b[d],ab.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fa(a.nodeName):j)&&(p.display=j);else for(d in r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;for(b in m._removeData(a,"fxshow"),o)m.style(a,b,o[b])}),o)g=hb(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}],eb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bb.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bb.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f)for(f=f||g[3],e=e||[],g=+d||1;g/=h=h||".5",m.style(c.elem,a,g+f),h!==(h=c.cur()/d)&&1!==h&&--i;);return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fb(){return setTimeout(function(){$a=void 0}),$a=m.now()}function gb(a,b){var c,d={height:a},e=0;for(b=b?1:0;e<4;e+=2-b)d["margin"+(c=T[e])]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hb(a,b,c){for(var d,e=(eb[b]||[]).concat(eb["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function kb(a,b,c){var d,e,f=0,g=db.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$a||fb(),c=Math.max(0,j.startTime+j.duration-b),f=1-(c/j.duration||0),g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$a||fb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(function(a,b){var c,d,e,f,g;for(c in a)if(e=b[d=m.camelCase(c)],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=m.cssHooks[d])&&"expand"in g)for(c in f=g.expand(f),delete a[d],f)c in a||(a[c]=f[c],b[c]=e);else b[d]=e}(k,j.opts.specialEasing);f<g;f++)if(d=db[f].call(j,a,k,j.opts))return d;return m.map(k,hb,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kb,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],eb[c]=eb[c]||[],eb[c].unshift(b)},prefilter:function(a,b){b?db.unshift(a):db.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||!0===d.queue)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kb(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),m.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($a=m.now();c<b.length;c++)(a=b[c])()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$a=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_a||(_a=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_a),_a=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx&&m.fx.speeds[a]||a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;(b=y.createElement("div")).setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],e=(c=y.createElement("select")).appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,(a=y.createElement("input")).setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lb=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(null==(e=d?a.call(this,c,m(this).val()):a)?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),(b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:"string"==typeof(c=e.value)?c.replace(lb,""):null==c?"":c:void 0}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(!(!(c=d[i]).selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=m.makeArray(b),g=e.length;g--;)if(d=e[g],0<=m.inArray(m.valHooks.option.get(d),f))try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=0<=m.inArray(m(a).val(),b):void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mb,nb,ob=m.expr.attrHandle,pb=/^(?:checked|selected)$/i,qb=k.getSetAttribute,rb=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nb:mb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:null==(e=m.find.attr(a,b))?void 0:e:null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)for(;c=f[e++];)d=m.propFix[c]||c,m.expr.match.bool.test(c)?rb&&qb||!pb.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qb?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nb={set:function(a,b,c){return!1===b?m.removeAttr(a,c):rb&&qb||!pb.test(c)?a.setAttribute(!qb&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ob[b]||m.find.attr;ob[b]=rb&&qb||!pb.test(b)?function(a,b,d){var e,f;return d||(f=ob[b],ob[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,ob[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rb&&qb||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mb&&mb.set(a,b,c)}}),qb||(mb={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},ob.id=ob.name=ob.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mb.set},m.attrHooks.contenteditable={set:function(a,b,c){mb.set(a,""!==b&&b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sb=/^(?:input|select|textarea|button|object)$/i,tb=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,1<arguments.length)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{for:"htmlFor",class:"className"},prop:function(a,b,c){var d,e,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return(1!==g||!m.isXMLDoc(a))&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sb.test(a.nodeName)||tb.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var ub=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];h<i;h++)if(d=1===(c=this[h]).nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];h<i;h++)if(d=1===(c=this[h]).nodeType&&(c.className?(" "+c.className+" ").replace(ub," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=m(this),f=a.match(E)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||!1===a?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&0<=(" "+this[c].className+" ").replace(ub," ").indexOf(b))return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vb=m.now(),wb=/\?/,xb=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xb,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{a.DOMParser?c=(new DOMParser).parseFromString(b,"text/xml"):((c=new ActiveXObject("Microsoft.XMLDOM")).async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yb,zb,Ab=/#.*$/,Bb=/([?&])_=[^&]*/,Cb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Eb=/^(?:GET|HEAD)$/,Fb=/^\/\//,Gb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hb={},Ib={},Jb="*/".concat("*");try{zb=location.href}catch(Kb){(zb=y.createElement("a")).href="",zb=zb.href}function Lb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mb(a,b,c,d){var e={},f=a===Ib;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nb(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}yb=Gb.exec(zb.toLowerCase())||[],m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zb,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(yb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nb(Nb(a,m.ajaxSettings),b):Nb(m.ajaxSettings,a)},ajaxPrefilter:Lb(Hb),ajaxTransport:Lb(Ib),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j)for(j={};b=Cb.exec(f);)j[b[1].toLowerCase()]=b[2];b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(t<2)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zb)+"").replace(Ab,"").replace(Fb,yb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gb.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yb[1]&&c[2]===yb[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yb[3]||("http:"===yb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mb(Hb,k,b,v),2===t)return v;for(d in(h=m.event&&k.global)&&0==m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Eb.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wb.test(e)?"&":"?")+k.data,delete k.data),!1===k.cache&&(k.url=Bb.test(e)?e.replace(Bb,"$1_="+vb++):e+(wb.test(e)?"&":"?")+"_="+vb++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&!1!==k.contentType||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jb+"; q=0.01":""):k.accepts["*"]),k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(!1===k.beforeSend.call(l,v,k)||2===t))return v.abort();for(d in u="abort",{success:1,error:1,complete:1})v[d](k[d]);if(i=Mb(Ib,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&0<k.timeout&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(t<2))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=0<a?4:0,j=200<=a&&a<300||304===a,c&&(u=function(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}(k,v,c)),u=function(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if((h=e.split(" "))[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}(k,u,v,j),j?(k.ifModified&&((w=v.getResponseHeader("Last-Modified"))&&(m.lastModified[e]=w),(w=v.getResponseHeader("etag"))&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,j=!(s=u.error))):(s=x,(a||!x)&&(x="error",a<0&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qb=/%20/g,Rb=/\[\]$/,Sb=/\r?\n/g,Tb=/^(?:submit|button|image|reset|file)$/i,Ub=/^(?:input|select|textarea|keygen)/i;function Vb(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rb.test(a)?d(a,e):Vb(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vb(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vb(c,a[c],b,e);return d.join("&").replace(Qb,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Ub.test(this.nodeName)&&!Tb.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sb,"\r\n")}}):{name:b.name,value:c.replace(Sb,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zb()||function(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}()}:Zb;var Wb=0,Xb={},Yb=m.ajaxSettings.xhr();function Zb(){try{return new a.XMLHttpRequest}catch(b){}}a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Xb)Xb[a](void 0,!0)}),k.cors=!!Yb&&"withCredentials"in Yb,(Yb=k.ajax=!!Yb)&&m.ajaxTransport(function(a){var b;if(!a.crossDomain||k.cors)return{send:function(c,d){var e,f=a.xhr(),g=++Wb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];for(e in a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest"),c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xb[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xb[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}),m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){(b=y.createElement("script")).async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _b=[],ac=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_b.pop()||m.expando+"_"+vb++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(ac.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ac.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ac,"$1"+e):!1!==b.jsonp&&(b.url+=(wb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_b.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bc=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bc)return bc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return 0<=h&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),0<g.length&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cc=a.document.documentElement;function dc(a){return m.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),("absolute"===k||"fixed"===k)&&-1<m.inArray("auto",[f,i])?(g=(d=l.position()).top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;return f?(b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dc(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d):void 0},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||cc;a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position");)a=a.offsetParent;return a||cc})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dc(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=La(k.pixelPosition,function(a,c){return c?(c=Ja(a,b),Ha.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ec=a.jQuery,fc=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fc),b&&a.jQuery===m&&(a.jQuery=ec),m},typeof b===K&&(a.jQuery=a.$=m),m}),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing.easeOutQuad(e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return-h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){return(f/=g/2)<1?h/2*f*f+a:-h/2*(--f*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){return(f/=g/2)<1?h/2*f*f*f+a:h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return-h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){return(f/=g/2)<1?h/2*f*f*f*f+a:-h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){return(f/=g/2)<1?h/2*f*f*f*f*f+a:h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return-h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return-h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return 0==f?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return f==g?a+h:h*(1-Math.pow(2,-10*f/g))+a},easeInOutExpo:function(e,f,a,h,g){return 0==f?a:f==g?a+h:(f/=g/2)<1?h/2*Math.pow(2,10*(f-1))+a:h/2*(2-Math.pow(2,-10*--f))+a},easeInCirc:function(e,f,a,h,g){return-h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){return(f/=g/2)<1?-h/2*(Math.sqrt(1-f*f)-1)+a:h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,l,k){var i=1.70158,j=0,g=l;if(0==h)return e;if(1==(h/=k))return e+l;if(j||(j=.3*k),g<Math.abs(l)){g=l;i=j/4}else i=j/(2*Math.PI)*Math.asin(l/g);return-g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158,j=0,g=l;if(0==h)return e;if(1==(h/=k))return e+l;if(j||(j=.3*k),g<Math.abs(l)){g=l;i=j/4}else i=j/(2*Math.PI)*Math.asin(l/g);return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158,j=0,g=l;if(0==h)return e;if(2==(h/=k/2))return e+l;if(j||(j=k*(.3*1.5)),g<Math.abs(l)){g=l;i=j/4}else i=j/(2*Math.PI)*Math.asin(l/g);return h<1?g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*-.5+e:g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*.5+l+e},easeInBack:function(e,f,a,i,h,g){return null==g&&(g=1.70158),i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){return null==g&&(g=1.70158),i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){return null==g&&(g=1.70158),(f/=h/2)<1?i/2*(f*f*((1+(g*=1.525))*f-g))+a:i/2*((f-=2)*f*((1+(g*=1.525))*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){return(f/=g)<1/2.75?h*(7.5625*f*f)+a:f<2/2.75?h*(7.5625*(f-=1.5/2.75)*f+.75)+a:f<2.5/2.75?h*(7.5625*(f-=2.25/2.75)*f+.9375)+a:h*(7.5625*(f-=2.625/2.75)*f+.984375)+a},easeInOutBounce:function(e,f,a,h,g){return f<g/2?.5*jQuery.easing.easeInBounce(e,2*f,0,h,g)+a:.5*jQuery.easing.easeOutBounce(e,2*f-g,0,h,g)+.5*h+a}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).client=e()}}(function(){return function o(a,s,c){function u(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(d)return d(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return u(a[t][1][e]||e)},i,i.exports,o,a,s,c)}return s[t].exports}for(var d="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(n,r,e){(function(e){"use strict";var t=n("promise-polyfill");r.exports=e.Promise||t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"promise-polyfill":11}],2:[function(e,t,n){"use strict";var a=e("./lib/promise"),s={};function r(n){var t,r,i,e,o=JSON.stringify(n);return!n.forceScriptReload&&(e=s[o])?e:(i=document.createElement("script"),t=n.dataAttributes||{},r=n.container||document.head,i.src=n.src,i.id=n.id,i.async=!0,n.crossorigin&&i.setAttribute("crossorigin",n.crossorigin),Object.keys(t).forEach(function(e){i.setAttribute("data-"+e,t[e])}),e=new a(function(e,t){i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(){t(new Error(n.src+" failed to load."))}),i.addEventListener("abort",function(){t(new Error(n.src+" has aborted."))}),r.appendChild(i)}),s[o]=e)}r.clearCache=function(){s={}},t.exports=r},{"./lib/promise":1}],3:[function(e,r,t){(function(t){"use strict";var n=e("./is-ie11");r.exports=function(e){return-1!==(e=e||t.navigator.userAgent).indexOf("MSIE")||n(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-ie11":4}],4:[function(e,t,n){"use strict";t.exports=function(e){return-1!==(e=e||navigator.userAgent).indexOf("Trident/7")}},{}],5:[function(e,t,n){"use strict";t.exports=function(e){return-1!==(e=e||navigator.userAgent).indexOf("MSIE 9")}},{}],6:[function(e,t,n){(function(e){"use strict";function r(e){var t,n=this;return"function"==typeof e?new r.Promise(e):(this._promise=new r.Promise(function(e,t){n._resolveFunction=e,n._rejectFunction=t}),e=e||{},this._onResolve=e.onResolve||r.defaultOnResolve,this._onReject=e.onReject||r.defaultOnReject,((t=e).hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(t.suppressUnhandledPromiseMessage):Boolean(r.suppressUnhandledPromiseMessage))&&this._promise.catch(function(){}),this._resetState(),this._promise.resolve=this.resolve.bind(this),this._promise.reject=this.reject.bind(this),this._promise)}["all","allSettled","race","reject","resolve"].forEach(function(t){r[t]=function(){var e=Array.prototype.slice.call(arguments);return r.Promise[t].apply(r.Promise,e)}}),r.setPromise=function(e){r.Promise=e},r.setPromise(e.Promise),r.defaultOnResolve=function(e){return r.Promise.resolve(e)},r.defaultOnReject=function(e){return r.Promise.reject(e)},r.prototype.resolve=function(e){var t=this;return this._promise.isFulfilled||(this._setResolved(),r.Promise.resolve().then(function(){return t._onResolve(e)}).then(this._resolveFunction).catch(function(e){t._resetState(),t._promise.reject(e)})),this._promise},r.prototype.reject=function(e){var t=this;return this._promise.isFulfilled||(this._setRejected(),r.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)}).catch(this._rejectFunction)),this._promise},r.prototype._resetState=function(){this._promise.isFulfilled=!1,this._promise.isResolved=!1,this._promise.isRejected=!1},r.prototype._setResolved=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!0,this._promise.isRejected=!1},r.prototype._setRejected=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!1,this._promise.isRejected=!0},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){try{t.apply(null,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],8:[function(e,t,n){"use strict";t.exports=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}}},{}],9:[function(e,t,n){"use strict";t.exports=function(e,t){if(!t)return e;e.then(function(e){t(null,e)}).catch(function(e){t(e)})}},{}],10:[function(e,t,n){"use strict";var r=e("./lib/deferred"),i=e("./lib/once"),o=e("./lib/promise-or-callback");function s(n){return function(){var e,t=Array.prototype.slice.call(arguments);return"function"==typeof t[t.length-1]&&(e=t.pop(),e=i(r(e))),o(n.apply(this,t),e)}}s.wrapPrototype=function(i,e){var o,a;return o=(e=e||{}).ignoreMethods||[],a=!0===e.transformPrivateMethods,Object.getOwnPropertyNames(i.prototype).filter(function(e){var t,n="constructor"!==e&&"function"==typeof i.prototype[e],r=-1===o.indexOf(e);return t=a||"_"!==e.charAt(0),n&&t&&r}).forEach(function(e){var t=i.prototype[e];i.prototype[e]=s(t)}),i},t.exports=s},{"./lib/deferred":7,"./lib/once":8,"./lib/promise-or-callback":9}],11:[function(e,t,n){"use strict";var r=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function i(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function a(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void u(r.promise,e)}s(r.promise,t)}else(1===n._state?s:u)(r.promise,n._value)})):n._deferreds.push(r)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void d(t);if("function"==typeof n)return void l((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,d(t)}catch(e){u(t,e)}var r,i}function u(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(i);return a(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},o.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},o.all=function(t){return new o(function(r,i){if(!c(t))return i(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(t);if(0===o.length)return r([]);var a=o.length;function s(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){s(t,e)},i)}o[t]=e,0==--a&&r(o)}catch(e){i(e)}}for(var e=0;e<o.length;e++)s(e,o[e])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(i){return new o(function(e,t){if(!c(i))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=i.length;n<r;n++)o.resolve(i[n]).then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){r(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=o},{}],12:[function(e,t,n){"use strict";var r=e("@braintree/browser-detection/is-ie"),i=e("@braintree/browser-detection/is-ie9");t.exports={isIe:r,isIe9:i}},{"@braintree/browser-detection/is-ie":3,"@braintree/browser-detection/is-ie9":5}],13:[function(e,t,n){"use strict";var d=e("./constants").BRAINTREE_VERSION,r=e("./request/graphql"),i=e("./request"),o=e("../lib/is-verified-domain"),p=e("../lib/braintree-error"),l=e("../lib/convert-to-braintree-error"),a=e("./get-configuration").getConfiguration,s=e("../lib/create-authorization-data"),f=e("../lib/add-metadata"),c=e("../lib/promise"),u=e("@braintree/wrap-promise"),h=e("../lib/once"),y=e("../lib/deferred"),g=e("../lib/assign").assign,E=e("../lib/analytics"),m=e("./errors"),_=e("../lib/constants").VERSION,I=e("../lib/constants").GRAPHQL_URLS,A=e("../lib/methods"),T=e("../lib/convert-methods-to-error"),b=e("../lib/assets"),N=e("../lib/constants").FRAUDNET_FNCLS,R=e("../lib/constants").FRAUDNET_SOURCE,v=e("../lib/constants").FRAUDNET_URL,C={};function O(e){var t,n;if(e=e||{},t=JSON.stringify(e),!(n=e.gatewayConfiguration))throw new p(m.CLIENT_MISSING_GATEWAY_CONFIGURATION);["assetsUrl","clientApiUrl","configUrl"].forEach(function(e){if(e in n&&!o(n[e]))throw new p({type:m.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:m.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:e+" property is on an invalid domain."})}),this.getConfiguration=function(){return JSON.parse(t)},this._request=i,this._configuration=this.getConfiguration(),this._clientApiBaseUrl=n.clientApiUrl+"/v1/",n.graphQL&&(this._graphQL=new r({graphQL:n.graphQL}))}O.initialize=function(t){var n,e,r=C[t.authorization];if(r)return E.sendEvent(r,"custom.client.load.cached"),r;try{e=s(t.authorization)}catch(e){return c.reject(new p(m.CLIENT_INVALID_AUTHORIZATION))}return r=a(e).then(function(e){return t.debug&&(e.isDebug=!0),e.authorization=t.authorization,n=new O(e)}),C[t.authorization]=r,E.sendEvent(r,"custom.client.load.initialized"),r.then(function(e){return E.sendEvent(n,"custom.client.load.succeeded"),e}).catch(function(e){return delete C[t.authorization],c.reject(e)})},O.clearCache=function(){C={}},O.prototype._findOrCreateFraudnetJSON=function(e){var t,n,r,i,o=document.querySelector('script[fncls="'+N+'"]');o||((o=document.body.appendChild(document.createElement("script"))).type="application/json",o.setAttribute("fncls",N)),t=this.getConfiguration(),n={rda_tenant:"bt_card",mid:t.gatewayConfiguration.merchantId},(r=t.authorizationFingerprint)&&r.split("&").forEach(function(e){var t=e.split("=");"customer_id"===t[0]&&1<t.length&&(n.cid=t[1])}),i={f:e.substr(0,32),fp:n,bu:!1,s:R},o.text=JSON.stringify(i)},O.prototype.request=function(i,n){var u=this,e=new c(function(o,a){var e,s,t,n,r,c=Boolean("payment_methods/credit_cards"===i.endpoint&&u.getConfiguration().gatewayConfiguration.creditCards.collectDeviceData);if("graphQLApi"!==i.api&&(i.method?i.endpoint||(e="options.endpoint"):e="options.method"),e)throw new p({type:m.CLIENT_OPTION_REQUIRED.type,code:m.CLIENT_OPTION_REQUIRED.code,message:e+" is required when making a request."});if(s="api"in i?i.api:"clientApi",n={method:i.method,graphQL:u._graphQL,timeout:i.timeout,metadata:u._configuration.analyticsMetadata},"clientApi"===s)t=u._clientApiBaseUrl,n.data=f(u._configuration,i.data);else{if("graphQLApi"!==s)throw new p({type:m.CLIENT_OPTION_INVALID.type,code:m.CLIENT_OPTION_INVALID.code,message:"options.api is invalid."});t=I[u._configuration.gatewayConfiguration.environment],i.endpoint="",n.method="post",n.data=g({clientSdkMetadata:{source:u._configuration.analyticsMetadata.source,integration:u._configuration.analyticsMetadata.integration,sessionId:u._configuration.analyticsMetadata.sessionId}},i.data),n.headers={Authorization:"Bearer "+((r=u._configuration).authorizationFingerprint||r.authorization),"Braintree-Version":d}}n.url=t+i.endpoint,n.sendAnalyticsEvent=function(e){E.sendEvent(u,e)},u._request(n,function(e,t,n){var r,i;(i=function(e,t){var n;if(-1===e?n=new p(m.CLIENT_REQUEST_TIMEOUT):403===e?n=new p(m.CLIENT_AUTHORIZATION_INSUFFICIENT):429===e?n=new p(m.CLIENT_RATE_LIMITED):500<=e?n=new p(m.CLIENT_GATEWAY_NETWORK):(e<200||400<=e)&&(n=l(t,{type:m.CLIENT_REQUEST_ERROR.type,code:m.CLIENT_REQUEST_ERROR.code,message:m.CLIENT_REQUEST_ERROR.message})),n)return n.details=n.details||{},n.details.httpStatus=e,n}(n,e))?a(i):"graphQLApi"===s&&t.errors?a(l(t.errors,{type:m.CLIENT_GRAPHQL_REQUEST_ERROR.type,code:m.CLIENT_GRAPHQL_REQUEST_ERROR.code,message:m.CLIENT_GRAPHQL_REQUEST_ERROR.message})):(r=g({_httpStatus:n},t),c&&r.creditCards&&0<r.creditCards.length&&(u._findOrCreateFraudnetJSON(r.creditCards[0].nonce),b.loadScript({src:v,forceScriptReload:!0})),o(r))})});return"function"==typeof n?(n=h(y(n)),void e.then(function(e){n(null,e,e._httpStatus)}).catch(function(e){var t=e&&e.details&&e.details.httpStatus;n(e,null,t)})):e},O.prototype.toJSON=function(){return this.getConfiguration()},O.prototype.getVersion=function(){return _},O.prototype.teardown=u(function(){return delete C[this.getConfiguration().authorization],T(this,A(O.prototype)),c.resolve()}),t.exports=O},{"../lib/add-metadata":34,"../lib/analytics":35,"../lib/assets":36,"../lib/assign":37,"../lib/braintree-error":38,"../lib/constants":39,"../lib/convert-methods-to-error":40,"../lib/convert-to-braintree-error":41,"../lib/create-authorization-data":42,"../lib/deferred":43,"../lib/is-verified-domain":47,"../lib/methods":49,"../lib/once":50,"../lib/promise":51,"./constants":14,"./errors":15,"./get-configuration":16,"./request":28,"./request/graphql":26,"@braintree/wrap-promise":10}],14:[function(e,t,n){"use strict";t.exports={BRAINTREE_VERSION:"2018-05-10"}},{}],15:[function(e,t,n){"use strict";var r=e("../lib/braintree-error");t.exports={CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN:{type:r.types.MERCHANT,code:"CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN"},CLIENT_OPTION_REQUIRED:{type:r.types.MERCHANT,code:"CLIENT_OPTION_REQUIRED"},CLIENT_OPTION_INVALID:{type:r.types.MERCHANT,code:"CLIENT_OPTION_INVALID"},CLIENT_MISSING_GATEWAY_CONFIGURATION:{type:r.types.INTERNAL,code:"CLIENT_MISSING_GATEWAY_CONFIGURATION",message:"Missing gatewayConfiguration."},CLIENT_INVALID_AUTHORIZATION:{type:r.types.MERCHANT,code:"CLIENT_INVALID_AUTHORIZATION",message:"Authorization is invalid. Make sure your client token or tokenization key is valid."},CLIENT_GATEWAY_NETWORK:{type:r.types.NETWORK,code:"CLIENT_GATEWAY_NETWORK",message:"Cannot contact the gateway at this time."},CLIENT_REQUEST_TIMEOUT:{type:r.types.NETWORK,code:"CLIENT_REQUEST_TIMEOUT",message:"Request timed out waiting for a reply."},CLIENT_REQUEST_ERROR:{type:r.types.NETWORK,code:"CLIENT_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_GRAPHQL_REQUEST_ERROR:{type:r.types.NETWORK,code:"CLIENT_GRAPHQL_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_RATE_LIMITED:{type:r.types.MERCHANT,code:"CLIENT_RATE_LIMITED",message:"You are being rate-limited; please try again in a few minutes."},CLIENT_AUTHORIZATION_INSUFFICIENT:{type:r.types.MERCHANT,code:"CLIENT_AUTHORIZATION_INSUFFICIENT",message:"The authorization used has insufficient privileges."}}},{"../lib/braintree-error":38}],16:[function(n,r,e){(function(u){"use strict";var d=n("../lib/braintree-error"),e=n("../lib/promise"),t=n("@braintree/wrap-promise"),p=n("./request"),l=n("../lib/vendor/uuid"),f=n("../lib/constants"),h=n("./errors"),y=n("./request/graphql"),g=n("../lib/constants").GRAPHQL_URLS,E=n("../lib/is-date-string-before-or-on"),m=n("./constants").BRAINTREE_VERSION;r.exports={getConfiguration:t(function(r){return new e(function(i,o){var a,s,e,t,n=l(),c={merchantAppId:u.location.host,platform:f.PLATFORM,sdkVersion:f.VERSION,source:f.SOURCE,integration:f.INTEGRATION,integrationType:f.INTEGRATION,sessionId:n};s=r.attrs,e=r.configUrl,s._meta=c,s.braintreeLibraryVersion=f.BRAINTREE_LIBRARY_VERSION,s.configVersion="3",t={url:e,method:"GET",data:s},s.authorizationFingerprint&&r.graphQL?(E(r.graphQL.date,m)&&(t.graphQL=new y({graphQL:{url:r.graphQL.url,features:["configuration"]}})),t.metadata=c):s.tokenizationKey&&(t.graphQL=new y({graphQL:{url:g[r.environment],features:["configuration"]}}),t.metadata=c),p(t,function(e,t,n){var r;if(e)return r=403===n?h.CLIENT_AUTHORIZATION_INSUFFICIENT:h.CLIENT_GATEWAY_NETWORK,void o(new d({type:r.type,code:r.code,message:r.message,details:{originalError:e}}));a={authorizationType:s.tokenizationKey?"TOKENIZATION_KEY":"CLIENT_TOKEN",authorizationFingerprint:s.authorizationFingerprint,analyticsMetadata:c,gatewayConfiguration:t},i(a)})})})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/braintree-error":38,"../lib/constants":39,"../lib/is-date-string-before-or-on":46,"../lib/promise":51,"../lib/vendor/uuid":54,"./constants":14,"./errors":15,"./request":28,"./request/graphql":26,"@braintree/wrap-promise":10}],17:[function(e,t,n){"use strict";var r=e("../lib/braintree-error"),i=e("./client"),o=e("../lib/promise"),a=e("@braintree/wrap-promise"),s=e("../lib/errors");t.exports={create:a(function(e){return e.authorization?i.initialize(e):o.reject(new r({type:s.INSTANTIATION_OPTION_REQUIRED.type,code:s.INSTANTIATION_OPTION_REQUIRED.code,message:"options.authorization is required when instantiating a client."}))}),VERSION:"3.62.0"}},{"../lib/braintree-error":38,"../lib/errors":45,"../lib/promise":51,"./client":13,"@braintree/wrap-promise":10}],18:[function(e,t,n){"use strict";var g=e("../../lib/querystring"),E=e("../../lib/assign").assign,m=e("./prep-body"),_=e("./parse-body"),I=e("./xhr"),A=I.isAvailable,T=e("./graphql/request"),b=e("./default-request"),N=1,R=408;t.exports={request:function(e,t){!function v(r,i,o){var a,s,c,e,t,n,u,d=r.url,p=r.graphQL,l=r.timeout,f=I.getRequestObject(),h=o,y=Boolean(p&&p.isGraphQLRequest(d,r.data));r.headers=E({"Content-Type":"application/json"},r.headers),d=(c=new(y?T:b)(r)).getUrl(),e=c.getBody(),t=c.getMethod(),n=c.getHeaders(),"GET"===t&&(d=g.queryify(d,e),e=null),A?f.onreadystatechange=function(){if(4===f.readyState){if(0===f.status&&y)return delete r.graphQL,void v(r,i,o);if(u=_(f.responseText),s=c.adaptResponseBody(u),400<=(a=c.determineStatus(f.status,u))||a<200){if(y&&("UNKNOWN"===(n=!(t=u).data&&t.errors&&t.errors[0]&&t.errors[0].extensions&&t.errors[0].extensions.errorClass)||"INTERNAL"===n))return delete r.graphQL,void v(r,i,o);if(i<N&&(!(e=a)||e===R))return void v(r,++i,o);h(s||"error",null,a||500)}else h(null,s,a);var e,t,n}}:(r.headers&&(d=g.queryify(d,n)),f.onload=function(){h(null,_(f.responseText),f.status)},f.onerror=function(){h("error",null,500)},f.onprogress=function(){},f.ontimeout=function(){h("timeout",null,-1)});try{f.open(t,d,!0)}catch(e){if(!y)throw e;return delete r.graphQL,void v(r,i,o)}f.timeout=l,A&&Object.keys(n).forEach(function(e){f.setRequestHeader(e,n[e])});try{f.send(m(t,e))}catch(e){}}(e,0,t)}}},{"../../lib/assign":37,"../../lib/querystring":52,"./default-request":19,"./graphql/request":27,"./parse-body":31,"./prep-body":32,"./xhr":33}],19:[function(e,t,n){"use strict";function r(e){this._url=e.url,this._data=e.data,this._method=e.method,this._headers=e.headers}r.prototype.getUrl=function(){return this._url},r.prototype.getBody=function(){return this._data},r.prototype.getMethod=function(){return this._method},r.prototype.getHeaders=function(){return this._headers},r.prototype.adaptResponseBody=function(e){return e},r.prototype.determineStatus=function(e){return e},t.exports=r},{}],20:[function(e,t,n){(function(e){"use strict";t.exports=function(){return e.navigator.userAgent}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(e,t,n){"use strict";var r=e("./error"),i=e("../../../../lib/assign").assign,o_creditCard={AMERICAN_EXPRESS:"American Express",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",SOLO:"Solo",UK_MAESTRO:"UK Maestro",UNION_PAY:"UnionPay",VISA:"Visa"},o_applePayWeb={VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex"},o_visaCheckout={VISA:"Visa",MASTERCARD:"MasterCard",DISCOVER:"Discover",AMERICAN_EXPRESS:"American Express"},o_googlePay={VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex"},o_masterpass={VISA:"visa",MASTERCARD:"master",DISCOVER:"discover",AMERICAN_EXPRESS:"amex",DINERS:"diners",INTERNATIONAL_MAESTRO:"maestro",JCB:"jcb"};function a(e,n){return e.reduce(function(e,t){return n.hasOwnProperty(t)?e.concat(n[t]):e},[])}t.exports=function(e,t){return e.data&&!e.errors?function(e,t){var n,r=e.data.clientConfiguration;return n={environment:r.environment.toLowerCase(),clientApiUrl:r.clientApiUrl,assetsUrl:r.assetsUrl,analytics:{url:r.analyticsUrl},merchantId:r.merchantId,venmo:"off"},r.supportedFeatures&&(n.graphQL={url:t._graphQL._config.url,features:r.supportedFeatures.map(function(e){return e.toLowerCase()})}),r.braintreeApi&&(n.braintreeApi=r.braintreeApi),r.applePayWeb&&(n.applePayWeb=r.applePayWeb,n.applePayWeb.supportedNetworks=a(r.applePayWeb.supportedCardBrands,o_applePayWeb),delete n.applePayWeb.supportedCardBrands),r.ideal&&(n.ideal=r.ideal),r.kount&&(n.kount={kountMerchantId:r.kount.merchantId}),r.creditCard?(n.challenges=r.creditCard.challenges.map(function(e){return e.toLowerCase()}),n.creditCards={supportedCardTypes:a(r.creditCard.supportedCardBrands,o_creditCard)},n.threeDSecureEnabled=r.creditCard.threeDSecureEnabled,n.threeDSecure=r.creditCard.threeDSecure):(n.challenges=[],n.creditCards={supportedCardTypes:[]},n.threeDSecureEnabled=!1),r.googlePay&&(n.androidPay={displayName:r.googlePay.displayName,enabled:!0,environment:r.googlePay.environment.toLowerCase(),googleAuthorizationFingerprint:r.googlePay.googleAuthorization,supportedNetworks:a(r.googlePay.supportedCardBrands,o_googlePay)}),r.venmo&&(n.payWithVenmo={merchantId:r.venmo.merchantId,accessToken:r.venmo.accessToken,environment:r.venmo.environment.toLowerCase()}),r.paypal?(n.paypalEnabled=!0,n.paypal=i({},r.paypal),n.paypal.currencyIsoCode=n.paypal.currencyCode,n.paypal.environment=n.paypal.environment.toLowerCase(),delete n.paypal.currencyCode):n.paypalEnabled=!1,r.unionPay&&(n.unionPay={enabled:!0,merchantAccountId:r.unionPay.merchantAccountId}),r.visaCheckout&&(n.visaCheckout={apikey:r.visaCheckout.apiKey,externalClientId:r.visaCheckout.externalClientId,supportedCardTypes:a(r.visaCheckout.supportedCardBrands,o_visaCheckout)}),r.masterpass&&(n.masterpass={merchantCheckoutId:r.masterpass.merchantCheckoutId,supportedNetworks:a(r.masterpass.supportedCardBrands,o_masterpass)}),r.usBankAccount&&(n.usBankAccount={routeId:r.usBankAccount.routeId,plaid:{publicKey:r.usBankAccount.plaidPublicKey}}),n}(e,t):r(e)}},{"../../../../lib/assign":37,"./error":23}],22:[function(e,t,n){"use strict";var r=e("./error"),s={AMERICAN_EXPRESS:"American Express",DINERS:"Discover",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",UK_MAESTRO:"Maestro",UNION_PAY:"Union Pay",VISA:"Visa"},c={YES:"Yes",NO:"No",UNKNOWN:"Unknown"},u={PSDTWO:"psd2"};t.exports=function(e){return(e.data&&!e.errors?function(e){var t,n,r=e.data.tokenizeCreditCard,i=r.creditCard,o=i.last4?i.last4.substr(2,4):"",a=i.binData;return a&&(["commercial","debit","durbinRegulated","healthcare","payroll","prepaid"].forEach(function(e){a[e]?a[e]=c[a[e]]:a[e]="Unknown"}),["issuingBank","countryOfIssuance","productId"].forEach(function(e){a[e]||(a[e]="Unknown")})),t={creditCards:[{binData:a,consumed:!1,description:o?"ending in "+o:"",nonce:r.token,details:{expirationMonth:i.expirationMonth,expirationYear:i.expirationYear,bin:i.bin||"",cardType:s[i.brandCode]||"Unknown",lastFour:i.last4||"",lastTwo:o},type:"CreditCard",threeDSecureInfo:null}]},r.authenticationInsight&&(n=r.authenticationInsight.customerAuthenticationRegulationEnvironment,t.creditCards[0].authenticationInsight={regulationEnvironment:u[n]||n.toLowerCase()}),t}:r)(e)}},{"./error":23}],23:[function(e,t,n){"use strict";t.exports=function(e){var t,n,r=e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorClass;return"VALIDATION"===r?0!==(n=function(e){var t=[];return e.forEach(function(e){e.extensions&&e.extensions.inputPath&&function e(t,n,r){var i,o=n.extensions.legacyCode,a=t[0];1!==t.length?(r.forEach(function(e){e.field===a&&(i=e)}),i||(i={field:a,fieldErrors:[]},r.push(i)),e(t.slice(1),n,i.fieldErrors)):r.push({code:o,field:a,message:n.message})}(e.extensions.inputPath.slice(1),e,t)}),t}((t=e).errors)).length?{error:{message:{creditCard:"Credit card is invalid"}[n[0].field]},fieldErrors:n}:{error:{message:t.errors[0].message}}:r?{error:{message:e.errors[0].message},fieldErrors:[]}:{error:{message:"There was a problem serving your request"},fieldErrors:[]}}},{}],24:[function(e,t,n){"use strict";t.exports=function(){return{query:"query ClientConfiguration {   clientConfiguration {     analyticsUrl     environment     merchantId     assetsUrl     clientApiUrl     creditCard {       supportedCardBrands       challenges       threeDSecureEnabled       threeDSecure {         cardinalAuthenticationJWT       }     }     applePayWeb {       countryCode       currencyCode       merchantIdentifier       supportedCardBrands     }     googlePay {       displayName       supportedCardBrands       environment       googleAuthorization     }     ideal {       routeId       assetsUrl     }     kount {       merchantId     }     masterpass {       merchantCheckoutId       supportedCardBrands     }     paypal {       displayName       clientId       privacyUrl       userAgreementUrl       assetsUrl       environment       environmentNoNetwork       unvettedMerchant       braintreeClientId       billingAgreementsEnabled       merchantAccountId       currencyCode       payeeEmail     }     unionPay {       merchantAccountId     }     usBankAccount {       routeId       plaidPublicKey     }     venmo {       merchantId       accessToken       environment     }     visaCheckout {       apiKey       externalClientId       supportedCardBrands     }     braintreeApi {       accessToken       url     }     supportedFeatures   } }",operationName:"ClientConfiguration"}}},{}],25:[function(e,t,n){"use strict";var c=e("../../../../lib/assign").assign;t.exports=function(e){var t,n,r={hasAuthenticationInsight:Boolean(e.authenticationInsight&&e.merchantAccountId)};return{query:(n="mutation TokenizeCreditCard($input: TokenizeCreditCardInput!",(t=r.hasAuthenticationInsight)&&(n+=", $authenticationInsightInput: AuthenticationInsightInput!"),n+=") {   tokenizeCreditCard(input: $input) {     token     creditCard {       bin       brandCode       last4       expirationMonth      expirationYear      binData {         prepaid         healthcare         debit         durbinRegulated         commercial         payroll         issuingBank         countryOfIssuance         productId       }     } ",t&&(n+="    authenticationInsight(input: $authenticationInsightInput) {      customerAuthenticationRegulationEnvironment    }"),n+="  } }"),variables:function(e,t){var n=e.creditCard,r=n&&n.billingAddress,i=n&&n.expirationDate,o=n&&(n.expirationMonth||i&&i.split("/")[0].trim()),a=n&&(n.expirationYear||i&&i.split("/")[1].trim()),s={input:{creditCard:{number:n&&n.number,expirationMonth:o,expirationYear:a,cvv:n&&n.cvv,cardholderName:n&&n.cardholderName},options:{}}};return t.hasAuthenticationInsight&&(s.authenticationInsightInput={merchantAccountId:e.merchantAccountId}),r&&(s.input.creditCard.billingAddress=r),s.input=function(e,t){var n;return e.creditCard&&e.creditCard.options&&"boolean"==typeof e.creditCard.options.validate?n=e.creditCard.options.validate:e.authorizationFingerprint&&e.tokenizationKey||e.authorizationFingerprint?n=!0:e.tokenizationKey&&(n=!1),"boolean"==typeof n&&(t.options=c({validate:n},t.options)),t}(e,s.input),s}(e,r),operationName:"TokenizeCreditCard"}}},{"../../../../lib/assign":37}],26:[function(e,t,n){"use strict";var o=e("../../browser-detection"),a={tokenize_credit_cards:"payment_methods/credit_cards",configuration:"configuration"},s=["creditCard.options.unionPayEnrollment"];function r(e){this._config=e.graphQL}r.prototype.getGraphQLEndpoint=function(){return this._config.url},r.prototype.isGraphQLRequest=function(e,t){var n,r,i=this.getClientApiPath(e);return!(!this._isGraphQLEnabled()||!i||o.isIe9())&&(n=this._config.features.some(function(e){return a[e]===i}),r=t,!s.some(function(e){return void 0!==e.split(".").reduce(function(e,t){return e&&e[t]},r)})&&n)},r.prototype.getClientApiPath=function(e){var t,n=e.split("/client_api/v1/");return 1<n.length&&(t=n[1].split("?")[0]),t},r.prototype._isGraphQLEnabled=function(){return Boolean(this._config)},t.exports=r},{"../../browser-detection":12}],27:[function(e,t,n){"use strict";var r=e("../../constants").BRAINTREE_VERSION,i=e("../../../lib/assign").assign,o=e("./generators/credit-card-tokenization"),a=e("./adapters/credit-card-tokenization"),s=e("./generators/configuration"),c=e("./adapters/configuration"),u={"payment_methods/credit_cards":o,configuration:s},d={"payment_methods/credit_cards":a,configuration:c};function p(e){var t=e.graphQL.getClientApiPath(e.url);this._graphQL=e.graphQL,this._data=e.data,this._method=e.method,this._headers=e.headers,this._clientSdkMetadata={source:e.metadata.source,integration:e.metadata.integration,sessionId:e.metadata.sessionId},this._sendAnalyticsEvent=e.sendAnalyticsEvent||Function.prototype,this._generator=u[t],this._adapter=d[t],this._sendAnalyticsEvent("graphql.init")}p.prototype.getUrl=function(){return this._graphQL.getGraphQLEndpoint()},p.prototype.getBody=function(){var e=function n(r){var i={};return Object.keys(r).forEach(function(e){var t=function(e){return-1===e.indexOf("_")?e:e.toLowerCase().replace(/(\_\w)/g,function(e){return e[1].toUpperCase()})}(e);"object"==typeof r[e]?i[t]=n(r[e]):"number"==typeof r[e]?i[t]=String(r[e]):i[t]=r[e]}),i}(this._data),t=this._generator(e),n=i({clientSdkMetadata:this._clientSdkMetadata},t);return JSON.stringify(n)},p.prototype.getMethod=function(){return"POST"},p.prototype.getHeaders=function(){var e;return e={Authorization:"Bearer "+(this._data.authorizationFingerprint?(this._sendAnalyticsEvent("graphql.authorization-fingerprint"),this._data.authorizationFingerprint):(this._sendAnalyticsEvent("graphql.tokenization-key"),this._data.tokenizationKey)),"Braintree-Version":r},i({},this._headers,e)},p.prototype.adaptResponseBody=function(e){return this._adapter(e,this)},p.prototype.determineStatus=function(e,t){var n,r;return n=200===e?(r=t.errors&&t.errors[0]&&t.errors[0].extensions&&t.errors[0].extensions.errorClass,t.data&&!t.errors?200:"VALIDATION"===r?422:"AUTHORIZATION"===r?403:"AUTHENTICATION"===r?401:!r&&t.errors[0].message?403:500):e||500,this._sendAnalyticsEvent("graphql.status."+e),this._sendAnalyticsEvent("graphql.determinedStatus."+n),n},t.exports=p},{"../../../lib/assign":37,"../../constants":14,"./adapters/configuration":21,"./adapters/credit-card-tokenization":22,"./generators/configuration":24,"./generators/credit-card-tokenization":25}],28:[function(e,t,n){"use strict";var r,i=e("../../lib/once"),o=e("./jsonp-driver"),a=e("./ajax-driver"),s=e("./get-user-agent"),c=e("./is-http");t.exports=function(e,t){t=i(t||Function.prototype),e.method=(e.method||"GET").toUpperCase(),e.timeout=null==e.timeout?6e4:e.timeout,e.data=e.data||{},null==r&&(r=!(c()&&/MSIE\s(8|9)/.test(s()))),r?a.request(e,t):o.request(e,t)}},{"../../lib/once":50,"./ajax-driver":18,"./get-user-agent":20,"./is-http":29,"./jsonp-driver":30}],29:[function(e,t,n){(function(e){"use strict";t.exports=function(){return"http:"===e.location.protocol}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],30:[function(e,t,n){(function(h){"use strict";var y,g=e("../../lib/vendor/uuid"),E=e("../../lib/querystring"),m={};function _(t){try{delete h[t]}catch(e){h[t]=null}}t.exports={request:function(e,t){var n,r,i,o,a,s,c,u="callback_json_"+g().replace(/-/g,""),d=e.url,p=e.data,l=e.method,f=e.timeout;d=E.queryify(d,p),r=d=E.queryify(d,{_method:l,callback:u}),i=u,o=document.createElement("script"),a=!1,o.src=r,o.async=!0,o.onerror=function(){h[i]({message:"error",status:500})},o.onload=o.onreadystatechange=function(){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a=!0,o.onload=o.onreadystatechange=null)},function(o,a,s){h[s]=function(e){var t,n=e.status||500,r=null,i=null;delete e.status,400<=n||n<200?r=e:i=e,_(s),(t=o)&&t.parentNode&&t.parentNode.removeChild(t),clearTimeout(m[s]),a(r,i,n)}}(n=o,t,u),s=f,m[c=u]=setTimeout(function(){m[c]=null,h[c]({error:"timeout",status:-1}),h[c]=function(){_(c)}},s),(y=y||document.getElementsByTagName("head")[0]).appendChild(n)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/querystring":52,"../../lib/vendor/uuid":54}],31:[function(e,t,n){"use strict";t.exports=function(e){try{e=JSON.parse(e)}catch(e){}return e}},{}],32:[function(e,t,n){"use strict";t.exports=function(e,t){if("string"!=typeof e)throw new Error("Method must be a string");return"get"!==e.toLowerCase()&&null!=t&&(t="string"==typeof t?t:JSON.stringify(t)),t}},{}],33:[function(e,n,t){(function(e){"use strict";var t=e.XMLHttpRequest&&"withCredentials"in new e.XMLHttpRequest;n.exports={isAvailable:t,getRequestObject:function(){return t?new e.XMLHttpRequest:new e.XDomainRequest}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(e,t,n){"use strict";var a=e("./create-authorization-data"),s=e("./json-clone"),c=e("./constants");t.exports=function(e,t){var n,r=t?s(t):{},i=a(e.authorization).attrs,o=s(e.analyticsMetadata);for(n in r.braintreeLibraryVersion=c.BRAINTREE_LIBRARY_VERSION,r._meta)r._meta.hasOwnProperty(n)&&(o[n]=r._meta[n]);return r._meta=o,i.tokenizationKey?r.tokenizationKey=i.tokenizationKey:r.authorizationFingerprint=i.authorizationFingerprint,r}},{"./constants":39,"./create-authorization-data":42,"./json-clone":48}],35:[function(e,t,n){"use strict";var r=e("./promise"),u=e("./constants"),d=e("./add-metadata");t.exports={sendEvent:function(e,a,s){var c=Date.now();return r.resolve(e).then(function(e){var t=Date.now(),n=e.getConfiguration(),r=e._request,i=n.gatewayConfiguration.analytics.url,o={analytics:[{kind:u.ANALYTICS_PREFIX+a,isAsync:Math.floor(t/1e3)!==Math.floor(c/1e3),timestamp:c}]};r({url:i,method:"post",data:d(n,o),timeout:u.ANALYTICS_REQUEST_TIMEOUT_MS},s)})}}},{"./add-metadata":34,"./constants":39,"./promise":51}],36:[function(e,t,n){"use strict";var r=e("@braintree/asset-loader/load-script");t.exports={loadScript:r}},{"@braintree/asset-loader/load-script":2}],37:[function(e,t,n){"use strict";var r="function"==typeof Object.assign?Object.assign:i;function i(e){var t,n,r;for(t=1;t<arguments.length;t++)for(r in n=arguments[t])n.hasOwnProperty(r)&&(e[r]=n[r]);return e}t.exports={assign:r,_assign:i}},{}],38:[function(e,t,n){"use strict";var r=e("./enumerate");function i(e){if(!i.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}((i.prototype=Object.create(Error.prototype)).constructor=i).types=r(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),i.findRootError=function(e){return e instanceof i&&e.details&&e.details.originalError?i.findRootError(e.details.originalError):e},t.exports=i},{"./enumerate":44}],39:[function(e,t,n){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.62.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.62.0"}},{}],40:[function(e,t,n){"use strict";var r=e("./braintree-error"),i=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new r({type:i.METHOD_CALLED_AFTER_TEARDOWN.type,code:i.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":38,"./errors":45}],41:[function(e,t,n){"use strict";var r=e("./braintree-error");t.exports=function(e,t){return e instanceof r?e:new r({type:t.type,code:t.code,message:t.message,details:{originalError:e}})}},{"./braintree-error":38}],42:[function(e,t,n){"use strict";var a=e("../lib/vendor/polyfill").atob,s=e("../lib/constants").CLIENT_API_URLS;t.exports=function(e){var t,n,r,i,o={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(i=(r=e.split("_"))[0],n={merchantId:r.slice(2).join("_"),environment:i},o.environment=n.environment,o.attrs.tokenizationKey=e,o.configUrl=s[n.environment]+"/merchants/"+n.merchantId+"/client_api/v1/configuration"):(t=JSON.parse(a(e)),o.environment=t.environment,o.attrs.authorizationFingerprint=t.authorizationFingerprint,o.configUrl=t.configUrl,o.graphQL=t.graphQL),o}},{"../lib/constants":39,"../lib/vendor/polyfill":53}],43:[function(e,t,n){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){t.apply(null,e)},1)}}},{}],44:[function(e,t,n){"use strict";t.exports=function(e,n){return n=null==n?"":n,e.reduce(function(e,t){return e[t]=n+t,e},{})}},{}],45:[function(e,t,n){"use strict";var r=e("./braintree-error");t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:r.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:r.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:r.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:r.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:r.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":38}],46:[function(e,t,n){"use strict";function r(e){var t=e.split("-");return new Date(t[0],t[1],t[2])}t.exports=function(e,t){return r(e)<=r(t)}},{}],47:[function(e,t,n){"use strict";var r,i={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};t.exports=function(e){var t;return e=e.toLowerCase(),!!/^https:/.test(e)&&((r=r||document.createElement("a")).href=e,t=r.hostname.split(".").slice(-2).join("."),i.hasOwnProperty(t))}},{}],48:[function(e,t,n){"use strict";t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],49:[function(e,t,n){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],50:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],51:[function(r,i,e){(function(e){"use strict";var t=e.Promise||r("promise-polyfill"),n=r("@braintree/extended-promise");n.suppressUnhandledPromiseMessage=!0,n.setPromise(t),i.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@braintree/extended-promise":6,"promise-polyfill":11}],52:[function(e,n,t){(function(t){"use strict";function s(e,t){var n,r,i,o,a=[];for(i in e)e.hasOwnProperty(i)&&(r=e[i],n=t?(o=e)&&"object"==typeof o&&"number"==typeof o.length&&"[object Array]"===Object.prototype.toString.call(o)?t+"[]":t+"["+i+"]":i,"object"==typeof r?a.push(s(r,n)):a.push(encodeURIComponent(n)+"="+encodeURIComponent(r)));return a.join("&")}n.exports={parse:function(e){return e=e||t.location.href,/\?/.test(e)?e.replace(/#.*$/,"").replace(/^.*\?/,"").split("&").reduce(function(e,t){var n=t.split("="),r=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]);return e[r]=i,e},{}):{}},stringify:s,queryify:function(e,t){return e=e||"",null!=t&&"object"==typeof t&&function(e){var t;for(t in e)if(e.hasOwnProperty(t))return 1}(t)&&(e+=-1===e.indexOf("?")?"?":"",e+=-1!==e.indexOf("=")?"&":"",e+=s(t)),e}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],53:[function(e,r,t){(function(t){"use strict";var n="function"==typeof t.atob?t.atob:e;function e(e){var t,n,r,i,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");for(a=0;t=(63&s.indexOf(e.charAt(a++)))<<2|(i=s.indexOf(e.charAt(a++)))>>4&3,n=(15&i)<<4|(o=s.indexOf(e.charAt(a++)))>>2&15,r=(3&o)<<6|63&s.indexOf(e.charAt(a++)),c+=String.fromCharCode(t)+(n?String.fromCharCode(n):"")+(r?String.fromCharCode(r):""),a<e.length;);return c}r.exports={atob:function(e){return n.call(t,e)},_atob:e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],54:[function(e,t,n){"use strict";t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},{}]},{},[17])(17)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).dataCollector=e()}}(function(){return function o(s,a,c){function u(t,e){if(!a[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=a[t]={exports:{}};s[t][0].call(i.exports,function(e){return u(s[t][1][e]||e)},i,i.exports,o,s,a,c)}return a[t].exports}for(var h="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(n,r,e){(function(e){"use strict";var t=n("promise-polyfill");r.exports=e.Promise||t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"promise-polyfill":8}],2:[function(e,t,n){"use strict";var s=e("./lib/promise"),a={};function r(n){var t,r,i,e,o=JSON.stringify(n);return!n.forceScriptReload&&(e=a[o])?e:(i=document.createElement("script"),t=n.dataAttributes||{},r=n.container||document.head,i.src=n.src,i.id=n.id,i.async=!0,n.crossorigin&&i.setAttribute("crossorigin",n.crossorigin),Object.keys(t).forEach(function(e){i.setAttribute("data-"+e,t[e])}),e=new s(function(e,t){i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(){t(new Error(n.src+" failed to load."))}),i.addEventListener("abort",function(){t(new Error(n.src+" has aborted."))}),r.appendChild(i)}),a[o]=e)}r.clearCache=function(){a={}},t.exports=r},{"./lib/promise":1}],3:[function(e,t,n){(function(e){"use strict";function r(e){var t,n=this;return"function"==typeof e?new r.Promise(e):(this._promise=new r.Promise(function(e,t){n._resolveFunction=e,n._rejectFunction=t}),e=e||{},this._onResolve=e.onResolve||r.defaultOnResolve,this._onReject=e.onReject||r.defaultOnReject,((t=e).hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(t.suppressUnhandledPromiseMessage):Boolean(r.suppressUnhandledPromiseMessage))&&this._promise.catch(function(){}),this._resetState(),this._promise.resolve=this.resolve.bind(this),this._promise.reject=this.reject.bind(this),this._promise)}["all","allSettled","race","reject","resolve"].forEach(function(t){r[t]=function(){var e=Array.prototype.slice.call(arguments);return r.Promise[t].apply(r.Promise,e)}}),r.setPromise=function(e){r.Promise=e},r.setPromise(e.Promise),r.defaultOnResolve=function(e){return r.Promise.resolve(e)},r.defaultOnReject=function(e){return r.Promise.reject(e)},r.prototype.resolve=function(e){var t=this;return this._promise.isFulfilled||(this._setResolved(),r.Promise.resolve().then(function(){return t._onResolve(e)}).then(this._resolveFunction).catch(function(e){t._resetState(),t._promise.reject(e)})),this._promise},r.prototype.reject=function(e){var t=this;return this._promise.isFulfilled||(this._setRejected(),r.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)}).catch(this._rejectFunction)),this._promise},r.prototype._resetState=function(){this._promise.isFulfilled=!1,this._promise.isResolved=!1,this._promise.isRejected=!1},r.prototype._setResolved=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!0,this._promise.isRejected=!1},r.prototype._setRejected=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!1,this._promise.isRejected=!0},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){try{t.apply(null,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],5:[function(e,t,n){"use strict";t.exports=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}}},{}],6:[function(e,t,n){"use strict";t.exports=function(e,t){if(!t)return e;e.then(function(e){t(null,e)}).catch(function(e){t(e)})}},{}],7:[function(e,t,n){"use strict";var r=e("./lib/deferred"),i=e("./lib/once"),o=e("./lib/promise-or-callback");function a(n){return function(){var e,t=Array.prototype.slice.call(arguments);return"function"==typeof t[t.length-1]&&(e=t.pop(),e=i(r(e))),o(n.apply(this,t),e)}}a.wrapPrototype=function(i,e){var o,s;return o=(e=e||{}).ignoreMethods||[],s=!0===e.transformPrivateMethods,Object.getOwnPropertyNames(i.prototype).filter(function(e){var t,n="constructor"!==e&&"function"==typeof i.prototype[e],r=-1===o.indexOf(e);return t=s||"_"!==e.charAt(0),n&&t&&r}).forEach(function(e){var t=i.prototype[e];i.prototype[e]=a(t)}),i},t.exports=a},{"./lib/deferred":4,"./lib/once":5,"./lib/promise-or-callback":6}],8:[function(e,t,n){"use strict";var r=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function i(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function s(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void u(r.promise,e)}a(r.promise,t)}else(1===n._state?a:u)(r.promise,n._value)})):n._deferreds.push(r)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void h(t);if("function"==typeof n)return void f((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,h(t)}catch(e){u(t,e)}var r,i}function u(e,t){e._state=2,e._value=t,h(e)}function h(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function f(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(i);return s(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},o.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},o.all=function(t){return new o(function(r,i){if(!c(t))return i(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(t);if(0===o.length)return r([]);var s=o.length;function a(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){a(t,e)},i)}o[t]=e,0==--s&&r(o)}catch(e){i(e)}}for(var e=0;e<o.length;e++)a(e,o[e])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(i){return new o(function(e,t){if(!c(i))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=i.length;n<r;n++)o.resolve(i[n]).then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){r(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=o},{}],9:[function(e,t,n){"use strict";var r=e("../lib/braintree-error");t.exports={DATA_COLLECTOR_KOUNT_NOT_ENABLED:{type:r.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_NOT_ENABLED",message:"Kount is not enabled for this merchant."},DATA_COLLECTOR_KOUNT_ERROR:{type:r.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_ERROR"},DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS:{type:r.types.MERCHANT,code:"DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS",message:"Data Collector must be created with Kount and/or PayPal."}}},{"../lib/braintree-error":16}],10:[function(e,t,n){"use strict";var s,a=e("../lib/constants").FRAUDNET_FNCLS,c=e("../lib/constants").FRAUDNET_SOURCE,u=e("../lib/constants").FRAUDNET_URL,h=e("../lib/assets").loadScript,r=e("../lib/promise");function i(){}function o(e){e&&e.parentNode&&e.parentNode.removeChild(e)}i.prototype.initialize=function(){var n,r,i,o=this;return this.sessionId=s=function(){var e,t="";for(e=0;e<32;e++)t+=Math.floor(16*Math.random()).toString(16);return t}(),this._beaconId="https://b.stats.paypal.com/counter.cgi?i=127.0.0.1&p="+this.sessionId+"&t="+(new Date).getTime()/1e3+"&a=14",this._parameterBlock=(n=this.sessionId,r=this._beaconId,(i=document.body.appendChild(document.createElement("script"))).type="application/json",i.setAttribute("fncls",a),i.text=JSON.stringify({f:n,s:c,b:r}),i),h({src:u}).then(function(e){return o._thirdPartyBlock=e,o}).catch(function(){return null})},i.prototype.teardown=function(){o(document.querySelector('iframe[title="ppfniframe"]')),o(document.querySelector('iframe[title="pbf"]')),o(this._parameterBlock),o(this._thirdPartyBlock)},t.exports={setup:function(){var e=new i;return s?(e.sessionId=s,r.resolve(e)):e.initialize()},clearSessionIdCache:function(){s=null}}},{"../lib/assets":14,"../lib/constants":18,"../lib/promise":25}],11:[function(e,t,n){"use strict";var s=e("./kount"),a=e("./fraudnet"),c=e("../lib/braintree-error"),u=e("../lib/basic-component-verification"),h=e("../lib/create-deferred-client"),l=e("../lib/create-assets-url"),f=e("../lib/methods"),d=e("../lib/convert-methods-to-error"),p=e("../lib/promise"),m=e("@braintree/wrap-promise"),v=e("./errors");t.exports={create:m(function(r){var i,n="Data Collector",o={_instances:[]};return u.verify({name:n,client:r.client,authorization:r.authorization}).then(function(){var e,t;return o._instantiatedWithAClient=!r.useDeferredClient,o._createPromise=h.create({authorization:r.authorization,client:r.client,debug:r.debug,assetsUrl:l.create(r.authorization),name:n}).then(function(e){var t,n=e.getConfiguration();if(!0===r.kount&&n.gatewayConfiguration.kount){try{t=s.setup({environment:n.gatewayConfiguration.environment,merchantId:n.gatewayConfiguration.kount.kountMerchantId})}catch(e){return p.reject(new c({type:v.DATA_COLLECTOR_KOUNT_ERROR.type,code:v.DATA_COLLECTOR_KOUNT_ERROR.code,message:e.message}))}i=t.deviceData,o._instances.push(t)}else i={};return p.resolve()}).then(function(){return a.setup().then(function(e){e&&(i.correlation_id=e.sessionId,o._instances.push(e))})}).then(function(){return 0===o._instances.length?p.reject(new c(v.DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS)):(o.deviceData=JSON.stringify(i),o.rawDeviceData=i,o)}),o.teardown=(e=o,m(function(){return e._createPromise.then(function(){e._instances.forEach(function(e){e&&e.teardown()}),d(e,f(e))})})),o.getDeviceData=(t=o,m(function(e){return e=e||{},t._createPromise.then(function(){return e.raw?p.resolve(t.rawDeviceData):p.resolve(t.deviceData)})})),o._instantiatedWithAClient?o._createPromise:o})}),VERSION:"3.62.0"}},{"../lib/basic-component-verification":15,"../lib/braintree-error":16,"../lib/convert-methods-to-error":19,"../lib/create-assets-url":20,"../lib/create-deferred-client":21,"../lib/methods":24,"../lib/promise":25,"./errors":9,"./fraudnet":10,"./kount":12,"@braintree/wrap-promise":7}],12:[function(e,t,n){"use strict";var r=e("./vendor/sjcl"),i=e("../lib/camel-case-to-snake-case"),o="https://assets.qa.braintreepayments.com/data",s={development:o,qa:o,sandbox:"https://assets.braintreegateway.com/sandbox/data",production:"https://assets.braintreegateway.com/data"},a={};function c(e){var t=c.getCachedDeviceData(e.merchantId);if(t)return this.deviceData=t,void(this._isCached=!0);this._currentEnvironment=this._initializeEnvironment(e),r.random.startCollectors(),this._deviceSessionId=this._generateDeviceSessionId(),this.deviceData=this._getDeviceData(),c.setCachedDeviceData(e.merchantId,this.deviceData),this._iframe=this._setupIFrame()}c.getCachedDeviceData=function(e){return a[e]},c.setCachedDeviceData=function(e,t){a[e]=t},c.prototype.teardown=function(){this._isCached||(r.random.stopCollectors(),this._removeIframe())},c.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)},c.prototype._getDeviceData=function(){return i({deviceSessionId:this._deviceSessionId,fraudMerchantId:this._currentEnvironment.id})},c.prototype._generateDeviceSessionId=function(){var e;return e=r.random.randomWords(4,0),r.codec.hex.fromBits(e)},c.prototype._setupIFrame=function(){var e,t,n=this;return e="?m="+this._currentEnvironment.id+"&s="+this._deviceSessionId,(t=document.createElement("iframe")).width=1,t.id="braintreeDataFrame-"+this._deviceSessionId,t.height=1,t.frameBorder=0,t.scrolling="no",t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",t.title="Braintree-Kount-iframe",t.setAttribute("aria-hidden","true"),document.body.appendChild(t),setTimeout(function(){t.src=n._currentEnvironment.url+"/logo.htm"+e,t.innerHTML='<img src="'+n._currentEnvironment.url+"/logo.gif"+e+'" alt="" />'},10),t},c.prototype._initializeEnvironment=function(e){var t=s[e.environment];if(null==t)throw new Error(e.environment+" is not a valid environment for kount.environment");return{url:t,name:e.environment,id:e.merchantId}},t.exports={setup:function(e){return new c(null!=e?e:{})},Kount:c,environmentUrls:s}},{"../lib/camel-case-to-snake-case":17,"./vendor/sjcl":13}],13:[function(e,t,n){"use strict";var _={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};function r(e,t,n){if(4!==t.length)throw new _.exception.invalid("invalid aes block size");var r=e.b[n],i=t[0]^r[0],o=t[n?3:1]^r[1],s=t[2]^r[2];t=t[n?1:3]^r[3];var a,c,u,h,l=r.length/4-2,f=4,d=[0,0,0,0];e=(a=e.l[n])[0];var p=a[1],m=a[2],v=a[3],y=a[4];for(h=0;h<l;h++)a=e[i>>>24]^p[o>>16&255]^m[s>>8&255]^v[255&t]^r[f],c=e[o>>>24]^p[s>>16&255]^m[t>>8&255]^v[255&i]^r[f+1],u=e[s>>>24]^p[t>>16&255]^m[i>>8&255]^v[255&o]^r[f+2],t=e[t>>>24]^p[i>>16&255]^m[o>>8&255]^v[255&s]^r[f+3],f+=4,i=a,o=c,s=u;for(h=0;h<4;h++)d[n?3&-h:h]=y[i>>>24]<<24^y[o>>16&255]<<16^y[s>>8&255]<<8^y[255&t]^r[f++],a=i,i=o,o=s,s=t,t=a;return d}function o(e,t){var n,r,i,o=e.u,s=e.b,a=o[0],c=o[1],u=o[2],h=o[3],l=o[4],f=o[5],d=o[6],p=o[7];for(n=0;n<64;n++)r=(r=n<16?t[n]:(r=t[n+1&15],i=t[n+14&15],t[15&n]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[15&n]+t[n+9&15]|0))+p+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(d^l&(f^d))+s[n],p=d,d=f,f=l,l=h+r|0,h=u,u=c,a=r+((c=a)&u^h&(c^u))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;o[0]=o[0]+a|0,o[1]=o[1]+c|0,o[2]=o[2]+u|0,o[3]=o[3]+h|0,o[4]=o[4]+l|0,o[5]=o[5]+f|0,o[6]=o[6]+d|0,o[7]=o[7]+p|0}function u(e,t){var n,r=_.random.B[e],i=[];for(n in r)r.hasOwnProperty(n)&&i.push(r[n]);for(n=0;n<i.length;n++)i[n](t)}function i(e,t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy((new Date).valueOf(),t,"loadtime")}function a(e){e.b=c(e).concat(c(e)),e.C=new _.cipher.aes(e.b)}function c(e){for(var t=0;t<4&&(e.g[t]=e.g[t]+1|0,!e.g[t]);t++);return e.C.encrypt(e.g)}function s(e,t){return function(){t.apply(e,arguments)}}_.cipher.aes=function(e){this.l[0][0][0]||this.G();var t,n,r,i,o=this.l[0][4],s=this.l[1],a=1;if(4!==(t=e.length)&&6!==t&&8!==t)throw new _.exception.invalid("invalid aes key size");for(this.b=[r=e.slice(0),i=[]],e=t;e<4*t+28;e++)n=r[e-1],(0==e%t||8===t&&4==e%t)&&(n=o[n>>>24]<<24^o[n>>16&255]<<16^o[n>>8&255]<<8^o[255&n],0==e%t&&(n=n<<8^n>>>24^a<<24,a=a<<1^283*(a>>7))),r[e]=r[e-t]^n;for(t=0;e;t++,e--)n=r[3&t?e:e-4],i[t]=e<=4||t<4?n:s[0][o[n>>>24]]^s[1][o[n>>16&255]]^s[2][o[n>>8&255]]^s[3][o[255&n]]},_.cipher.aes.prototype={encrypt:function(e){return r(this,e,0)},decrypt:function(e){return r(this,e,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){var e,t,n,r,i,o,s,a=this.l[0],c=this.l[1],u=a[4],h=c[4],l=[],f=[];for(e=0;e<256;e++)f[(l[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!u[t];t^=r||1,n=f[n]||1)for(o=(o=n^n<<1^n<<2^n<<3^n<<4)>>8^255&o^99,s=16843009*(i=l[e=l[r=l[h[u[t]=o]=t]]])^65537*e^257*r^16843008*t,i=257*l[o]^16843008*o,e=0;e<4;e++)a[e][t]=i=i<<24^i>>>8,c[e][o]=s=s<<24^s>>>8;for(e=0;e<5;e++)a[e]=a[e].slice(0),c[e]=c[e].slice(0)}},_.bitArray={bitSlice:function(e,t,n){return e=_.bitArray.M(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:_.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=_.bitArray.getPartial(n);return 32===r?e.concat(t):_.bitArray.M(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+_.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,0<n&&t&&(e[n-1]=_.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(_.bitArray.bitLength(e)!==_.bitArray.bitLength(t))return!1;var n,r=0;for(n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},M:function(e,t,n,r){var i;for(void(i=0)===r&&(r=[]);32<=t;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=_.bitArray.getPartial(i),r.push(_.bitArray.partial(t+e&31,32<t+e?n:r.pop(),1)),r},Y:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},_.codec.utf8String={fromBits:function(e){var t,n,r="",i=_.bitArray.bitLength(e);for(t=0;t<i/8;t++)0==(3&t)&&(n=e[t/4]),r+=String.fromCharCode(n>>>8>>>8>>>8),n<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,n=[],r=0;for(t=0;t<e.length;t++)r=r<<8|e.charCodeAt(t),3==(3&t)&&(n.push(r),r=0);return 3&t&&n.push(_.bitArray.partial(8*(3&t),r)),n}},_.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=(0xf00000000000+(0|e[t])).toString(16).substr(4);return n.substr(0,_.bitArray.bitLength(e)/4)},toBits:function(e){var t,n,r=[];for(n=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",t=0;t<e.length;t+=8)r.push(0^parseInt(e.substr(t,8),16));return _.bitArray.clamp(r,4*n)}},_.hash.sha256=function(e){this.b[0]||this.G(),e?(this.u=e.u.slice(0),this.o=e.o.slice(0),this.h=e.h):this.reset()},_.hash.sha256.hash=function(e){return(new _.hash.sha256).update(e).finalize()},_.hash.sha256.prototype={blockSize:512,reset:function(){return this.u=this.K.slice(0),this.o=[],this.h=0,this},update:function(e){"string"==typeof e&&(e=_.codec.utf8String.toBits(e));var t,n=this.o=_.bitArray.concat(this.o,e);if(t=this.h,9007199254740991<(e=this.h=t+_.bitArray.bitLength(e)))throw new _.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var r=new Uint32Array(n),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)o(this,r.subarray(16*i,16*(i+1))),i+=1;n.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)o(this,n.splice(0,16));return this},finalize:function(){var e,t=this.o,n=this.u;for(e=(t=_.bitArray.concat(t,[_.bitArray.partial(1,1)])).length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this.h/4294967296)),t.push(0|this.h);t.length;)o(this,t.splice(0,16));return this.reset(),n},K:[],b:[],G:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}for(var t,n,r=0,i=2;r<64;i++){for(n=!0,t=2;t*t<=i;t++)if(0==i%t){n=!1;break}n&&(r<8&&(this.K[r]=e(Math.pow(i,.5))),this.b[r]=e(Math.pow(i,1/3)),r++)}}},_.prng=function(e){this.c=[new _.hash.sha256],this.i=[0],this.H=0,this.v={},this.F=0,this.J={},this.L=this.f=this.j=this.T=0,this.b=[0,0,0,0,0,0,0,0],this.g=[0,0,0,0],this.C=void 0,this.D=e,this.s=!1,this.B={progress:{},seeded:{}},this.m=this.S=0,this.w=1,this.A=2,this.O=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.P=3e4,this.N=80},_.prng.prototype={randomWords:function(e,t){var n,r,i=[];if((n=this.isReady(t))===this.m)throw new _.exception.notReady("generator isn't seeded");if(n&this.A){n=!(n&this.w),r=[];var o,s=0;for(this.L=r[0]=(new Date).valueOf()+this.P,o=0;o<16;o++)r.push(4294967296*Math.random()|0);for(o=0;o<this.c.length&&(r=r.concat(this.c[o].finalize()),s+=this.i[o],this.i[o]=0,n||!(this.H&1<<o));o++);for(this.H>=1<<this.c.length&&(this.c.push(new _.hash.sha256),this.i.push(0)),this.f-=s,s>this.j&&(this.j=s),this.H++,this.b=_.hash.sha256.hash(this.b.concat(r)),this.C=new _.cipher.aes(this.b),n=0;n<4&&(this.g[n]=this.g[n]+1|0,!this.g[n]);n++);}for(n=0;n<e;n+=4)0==(n+1)%this.O&&a(this),r=c(this),i.push(r[0],r[1],r[2],r[3]);return a(this),i.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new _.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.D=e},addEntropy:function(e,t,n){n=n||"user";var r,i,o=(new Date).valueOf(),s=this.v[n],a=this.isReady(),c=0;switch(void 0===(r=this.J[n])&&(r=this.J[n]=this.T++),void 0===s&&(s=this.v[n]=0),this.v[n]=(this.v[n]+1)%this.c.length,typeof e){case"number":void 0===t&&(t=1),this.c[s].update([r,this.F++,1,t,o,1,0|e]);break;case"object":if("[object Uint32Array]"===(n=Object.prototype.toString.call(e))){for(i=[],n=0;n<e.length;n++)i.push(e[n]);e=i}else for("[object Array]"!==n&&(c=1),n=0;n<e.length&&!c;n++)"number"!=typeof e[n]&&(c=1);if(!c){if(void 0===t)for(n=t=0;n<e.length;n++)for(i=e[n];0<i;)t++,i>>>=1;this.c[s].update([r,this.F++,2,t,o,e.length].concat(e))}break;case"string":void 0===t&&(t=e.length),this.c[s].update([r,this.F++,3,t,o,e.length]),this.c[s].update(e);break;default:c=1}if(c)throw new _.exception.bug("random: addEntropy only supports number, array of numbers or string");this.i[s]+=t,this.f+=t,a===this.m&&(this.isReady()!==this.m&&u("seeded",Math.max(this.j,this.f)),u("progress",this.getProgress()))},isReady:function(e){return e=this.I[void 0!==e?e:this.D],this.j&&this.j>=e?this.i[0]>this.N&&(new Date).valueOf()>this.L?this.A|this.w:this.w:this.f>=e?this.A|this.m:this.m},getProgress:function(e){return e=this.I[e||this.D],this.j>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.s){if(this.a={loadTimeCollector:s(this,this.V),mouseCollector:s(this,this.W),keyboardCollector:s(this,this.U),accelerometerCollector:s(this,this.R),touchCollector:s(this,this.X)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new _.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.s=!0}},stopCollectors:function(){this.s&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.s=!1)},addEventListener:function(e,t){this.B[e][this.S++]=t},removeEventListener:function(e,t){var n,r,i=this.B[e],o=[];for(r in i)i.hasOwnProperty(r)&&i[r]===t&&o.push(r);for(n=0;n<o.length;n++)delete i[r=o[n]]},U:function(){i(this,1)},W:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(e){n=t=0}0!=t&&0!=n&&this.addEntropy([t,n],2,"mouse"),i(this,0)},X:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),i(this,0)},V:function(){i(this,2)},R:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;"number"==typeof t&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),i(this,0)}},_.random=new _.prng(6);e:try{var h,l,f,d;if(d=void 0!==t&&t.exports){var p;try{p=e("crypto")}catch(e){p=null}d=l=p}if(d&&l.randomBytes)h=l.randomBytes(128),h=new Uint32Array(new Uint8Array(h).buffer),_.random.addEntropy(h,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(f=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(f);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break e;window.msCrypto.getRandomValues(f)}_.random.addEntropy(f,1024,"crypto['getRandomValues']")}}catch(e){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}void 0!==t&&t.exports&&(t.exports=_)},{crypto:void 0}],14:[function(e,t,n){"use strict";var r=e("@braintree/asset-loader/load-script");t.exports={loadScript:r}},{"@braintree/asset-loader/load-script":2}],15:[function(e,t,n){"use strict";var i=e("./braintree-error"),o=e("./promise"),s=e("./errors");t.exports={verify:function(e){var t,n,r;return e?(r=e.name,t=e.client,n=e.authorization,t||n?n||"3.62.0"===t.getVersion()?o.resolve():o.reject(new i({type:s.INCOMPATIBLE_VERSIONS.type,code:s.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+t.getVersion()+") and "+r+" (version 3.62.0) components must be from the same SDK version."})):o.reject(new i({type:s.INSTANTIATION_OPTION_REQUIRED.type,code:s.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+r+"."}))):o.reject(new i({type:s.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:s.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}}},{"./braintree-error":16,"./errors":23,"./promise":25}],16:[function(e,t,n){"use strict";var r=e("./enumerate");function i(e){if(!i.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}((i.prototype=Object.create(Error.prototype)).constructor=i).types=r(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),i.findRootError=function(e){return e instanceof i&&e.details&&e.details.originalError?i.findRootError(e.details.originalError):e},t.exports=i},{"./enumerate":22}],17:[function(e,t,n){"use strict";t.exports=function(n){return Object.keys(n).reduce(function(e,t){return e[t.replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1_$2").toLowerCase()]=n[t],e},{})}},{}],18:[function(e,t,n){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.62.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.62.0"}},{}],19:[function(e,t,n){"use strict";var r=e("./braintree-error"),i=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new r({type:i.METHOD_CALLED_AFTER_TEARDOWN.type,code:i.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":16,"./errors":23}],20:[function(e,t,n){"use strict";var r=e("./constants").ASSETS_URLS;t.exports={create:function(e){return r.production}}},{"./constants":18}],21:[function(e,t,n){(function(n){"use strict";var r=e("./braintree-error"),i=e("./promise"),o=e("./assets"),s=e("./errors"),a="3.62.0";t.exports={create:function(e){var t=i.resolve();return e.client?i.resolve(e.client):(n.braintree&&n.braintree.client||(t=o.loadScript({src:e.assetsUrl+"/web/"+a+"/js/client.min.js"}).catch(function(e){return i.reject(new r({type:s.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:s.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:s.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:e}}))})),t.then(function(){return n.braintree.client.VERSION!==a?i.reject(new r({type:s.INCOMPATIBLE_VERSIONS.type,code:s.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+n.braintree.client.VERSION+") and "+e.name+" (version "+a+") components must be from the same SDK version."})):n.braintree.client.create({authorization:e.authorization,debug:e.debug})}))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./assets":14,"./braintree-error":16,"./errors":23,"./promise":25}],22:[function(e,t,n){"use strict";t.exports=function(e,n){return n=null==n?"":n,e.reduce(function(e,t){return e[t]=n+t,e},{})}},{}],23:[function(e,t,n){"use strict";var r=e("./braintree-error");t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:r.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:r.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:r.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:r.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:r.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":16}],24:[function(e,t,n){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],25:[function(r,i,e){(function(e){"use strict";var t=e.Promise||r("promise-polyfill"),n=r("@braintree/extended-promise");n.suppressUnhandledPromiseMessage=!0,n.setPromise(t),i.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@braintree/extended-promise":3,"promise-polyfill":8}]},{},[11])(11)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).googlePayment=e()}}(function(){return function i(a,s,c){function u(t,e){if(!s[t]){if(!a[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[t]={exports:{}};a[t][0].call(o.exports,function(e){return u(a[t][1][e]||e)},o,o.exports,i,a,s,c)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(r,n,e){(function(e){"use strict";var t=r("promise-polyfill");n.exports=e.Promise||t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"promise-polyfill":8}],2:[function(e,t,r){"use strict";var a=e("./lib/promise"),s={};function n(r){var t,n,o,e,i=JSON.stringify(r);return!r.forceScriptReload&&(e=s[i])?e:(o=document.createElement("script"),t=r.dataAttributes||{},n=r.container||document.head,o.src=r.src,o.id=r.id,o.async=!0,r.crossorigin&&o.setAttribute("crossorigin",r.crossorigin),Object.keys(t).forEach(function(e){o.setAttribute("data-"+e,t[e])}),e=new a(function(e,t){o.addEventListener("load",function(){e(o)}),o.addEventListener("error",function(){t(new Error(r.src+" failed to load."))}),o.addEventListener("abort",function(){t(new Error(r.src+" has aborted."))}),n.appendChild(o)}),s[i]=e)}n.clearCache=function(){s={}},t.exports=n},{"./lib/promise":1}],3:[function(e,t,r){(function(e){"use strict";function n(e){var t,r=this;return"function"==typeof e?new n.Promise(e):(this._promise=new n.Promise(function(e,t){r._resolveFunction=e,r._rejectFunction=t}),e=e||{},this._onResolve=e.onResolve||n.defaultOnResolve,this._onReject=e.onReject||n.defaultOnReject,((t=e).hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(t.suppressUnhandledPromiseMessage):Boolean(n.suppressUnhandledPromiseMessage))&&this._promise.catch(function(){}),this._resetState(),this._promise.resolve=this.resolve.bind(this),this._promise.reject=this.reject.bind(this),this._promise)}["all","allSettled","race","reject","resolve"].forEach(function(t){n[t]=function(){var e=Array.prototype.slice.call(arguments);return n.Promise[t].apply(n.Promise,e)}}),n.setPromise=function(e){n.Promise=e},n.setPromise(e.Promise),n.defaultOnResolve=function(e){return n.Promise.resolve(e)},n.defaultOnReject=function(e){return n.Promise.reject(e)},n.prototype.resolve=function(e){var t=this;return this._promise.isFulfilled||(this._setResolved(),n.Promise.resolve().then(function(){return t._onResolve(e)}).then(this._resolveFunction).catch(function(e){t._resetState(),t._promise.reject(e)})),this._promise},n.prototype.reject=function(e){var t=this;return this._promise.isFulfilled||(this._setRejected(),n.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)}).catch(this._rejectFunction)),this._promise},n.prototype._resetState=function(){this._promise.isFulfilled=!1,this._promise.isResolved=!1,this._promise.isRejected=!1},n.prototype._setResolved=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!0,this._promise.isRejected=!1},n.prototype._setRejected=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!1,this._promise.isRejected=!0},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){try{t.apply(null,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],5:[function(e,t,r){"use strict";t.exports=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}}},{}],6:[function(e,t,r){"use strict";t.exports=function(e,t){if(!t)return e;e.then(function(e){t(null,e)}).catch(function(e){t(e)})}},{}],7:[function(e,t,r){"use strict";var n=e("./lib/deferred"),o=e("./lib/once"),i=e("./lib/promise-or-callback");function s(r){return function(){var e,t=Array.prototype.slice.call(arguments);return"function"==typeof t[t.length-1]&&(e=t.pop(),e=o(n(e))),i(r.apply(this,t),e)}}s.wrapPrototype=function(o,e){var i,a;return i=(e=e||{}).ignoreMethods||[],a=!0===e.transformPrivateMethods,Object.getOwnPropertyNames(o.prototype).filter(function(e){var t,r="constructor"!==e&&"function"==typeof o.prototype[e],n=-1===i.indexOf(e);return t=a||"_"!==e.charAt(0),r&&t&&n}).forEach(function(e){var t=o.prototype[e];o.prototype[e]=s(t)}),o},t.exports=s},{"./lib/deferred":4,"./lib/once":5,"./lib/promise-or-callback":6}],8:[function(e,t,r){"use strict";var n=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(r,n){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var e=1===r._state?n.onFulfilled:n.onRejected;if(null!==e){var t;try{t=e(r._value)}catch(e){return void u(n.promise,e)}s(n.promise,t)}else(1===r._state?s:u)(n.promise,r._value)})):r._deferreds.push(n)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if("function"==typeof r)return void f((n=r,o=e,function(){n.apply(o,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){u(t,e)}var n,o}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)a(e,e._deferreds[t]);e._deferreds=null}function f(e,t){var r=!1;try{e(function(e){r||(r=!0,s(t,e))},function(e){r||(r=!0,u(t,e))})}catch(e){if(r)return;r=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var r=new this.constructor(o);return a(this,new function(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}(e,t,r)),r},i.prototype.finally=function(t){var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){return r.reject(e)})})},i.all=function(t){return new i(function(n,o){if(!c(t))return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return n([]);var a=i.length;function s(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){s(t,e)},o)}i[t]=e,0==--a&&n(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)s(e,i[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(r){return new i(function(e,t){t(r)})},i.race=function(o){return new i(function(e,t){if(!c(o))return t(new TypeError("Promise.race accepts an array"));for(var r=0,n=o.length;r<n;r++)i.resolve(o[r]).then(e,t)})},i._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=i},{}],9:[function(e,t,r){"use strict";var n=e("../lib/braintree-error");t.exports={GOOGLE_PAYMENT_NOT_ENABLED:{type:n.types.MERCHANT,code:"GOOGLE_PAYMENT_NOT_ENABLED",message:"Google Pay is not enabled for this merchant."},GOOGLE_PAYMENT_GATEWAY_ERROR:{code:"GOOGLE_PAYMENT_GATEWAY_ERROR",message:"There was an error when tokenizing the Google Pay payment method.",type:n.types.UNKNOWN},GOOGLE_PAYMENT_UNSUPPORTED_VERSION:{code:"GOOGLE_PAYMENT_UNSUPPORTED_VERSION",type:n.types.MERCHANT}}},{"../lib/braintree-error":17}],10:[function(e,t,r){"use strict";var a=e("../lib/analytics"),i=e("../lib/assign").assign,n=e("../lib/convert-methods-to-error"),s=e("../lib/find"),o=e("../lib/generate-google-pay-configuration"),c=e("../lib/braintree-error"),u=e("./errors"),l=e("../lib/methods"),p=e("../lib/promise"),f=e("@braintree/wrap-promise"),d={1:"_createV1PaymentDataRequest",2:"_createV2PaymentDataRequest"};function h(e){if(this._createPromise=e.createPromise,this._client=e.client,this._useDeferredClient=e.useDeferredClient,this._googlePayVersion=e.googlePayVersion||1,this._googleMerchantId=e.googleMerchantId,this._isUnsupportedGooglePayAPIVersion())throw new c({code:u.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.code,message:"The Braintree SDK does not support Google Pay version "+this._googlePayVersion+". Please upgrade the version of your Braintree SDK and contact support if this error persists.",type:u.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.type})}h.prototype._waitForClient=function(){return this._client?p.resolve():this._createPromise.then(function(e){this._client=e}.bind(this))},h.prototype._isUnsupportedGooglePayAPIVersion=function(){return!(this._googlePayVersion in d)},h.prototype._getDefaultConfig=function(){return this._defaultConfig||(this._defaultConfig=o(this._client.getConfiguration(),this._googlePayVersion,this._googleMerchantId)),this._defaultConfig},h.prototype._createV1PaymentDataRequest=function(e){var t=this._getDefaultConfig(),r=e.cardRequirements&&e.cardRequirements.allowedCardNetworks,n=t.cardRequirements.allowedCardNetworks,o=r||n;return(e=i({},t,e)).cardRequirements.allowedCardNetworks=o,e},h.prototype._createV2PaymentDataRequest=function(e){var o=this._getDefaultConfig();return e.allowedPaymentMethods&&e.allowedPaymentMethods.forEach(function(e){var t,r,n=s(o.allowedPaymentMethods,"type",e.type);n&&(t=e,r=n,Object.keys(r).forEach(function(e){"object"==typeof r[e]?t[e]=i({},r[e],t[e]):t[e]=t[e]||r[e]}))}),i({},o,e)},h.prototype.createPaymentDataRequest=function(e){return this._useDeferredClient?this._waitForClient().then(function(){return this._createPaymentDataRequestSyncronously(e)}.bind(this)):this._createPaymentDataRequestSyncronously(e)},h.prototype._createPaymentDataRequestSyncronously=function(e){var t=i({},e),r=this._googlePayVersion,n=d[r];return a.sendEvent(this._createPromise,"google-payment.v"+r+".createPaymentDataRequest"),this[n](t)},h.prototype.parseResponse=function(o){var i=this;return p.resolve().then(function(){var e,t=2===o.apiVersion?o.paymentMethodData.tokenizationData.token:o.paymentMethodToken.token,r=JSON.parse(t),n=r.error;return n?p.reject(n):(a.sendEvent(i._createPromise,"google-payment.parseResponse.succeeded"),r.paypalAccounts?(e=r.paypalAccounts[0],a.sendEvent(i._createPromise,"google-payment.parseResponse.succeeded.paypal"),p.resolve({nonce:e.nonce,type:e.type,description:e.description})):(e=r.androidPayCards[0],a.sendEvent(i._createPromise,"google-payment.parseResponse.succeeded.google-payment"),p.resolve({nonce:e.nonce,type:e.type,description:e.description,details:{cardType:e.details.cardType,lastFour:e.details.lastFour,lastTwo:e.details.lastTwo,isNetworkTokenized:e.details.isNetworkTokenized,bin:e.details.bin},binData:e.binData})))}).catch(function(e){return a.sendEvent(i._createPromise,"google-payment.parseResponse.failed"),p.reject(new c({code:u.GOOGLE_PAYMENT_GATEWAY_ERROR.code,message:u.GOOGLE_PAYMENT_GATEWAY_ERROR.message,type:u.GOOGLE_PAYMENT_GATEWAY_ERROR.type,details:{originalError:e}}))})},h.prototype.teardown=function(){return n(this,l(h.prototype)),p.resolve()},t.exports=f.wrapPrototype(h)},{"../lib/analytics":13,"../lib/assign":15,"../lib/braintree-error":17,"../lib/convert-methods-to-error":19,"../lib/find":25,"../lib/generate-google-pay-configuration":26,"../lib/methods":28,"../lib/promise":29,"./errors":9,"@braintree/wrap-promise":7}],11:[function(e,t,r){"use strict";var o=e("./google-payment"),i=e("../lib/braintree-error"),a=e("../lib/promise"),s=e("../lib/create-assets-url"),c=e("../lib/create-deferred-client"),u=e("../lib/basic-component-verification"),n=e("@braintree/wrap-promise"),l=e("./errors");t.exports={create:n(function(r){var n="Google Pay";return u.verify({name:n,client:r.client,authorization:r.authorization}).then(function(){var e,t;return e=c.create({authorization:r.authorization,client:r.client,debug:r.debug,assetsUrl:s.create(r.authorization),name:n}).then(function(e){var t=e.getConfiguration();return r.client=e,t.gatewayConfiguration.androidPay?e:a.reject(new i(l.GOOGLE_PAYMENT_NOT_ENABLED))}),r.createPromise=e,t=new o(r),r.useDeferredClient?t:e.then(function(e){return t._client=e,t})})}),VERSION:"3.62.0"}},{"../lib/basic-component-verification":16,"../lib/braintree-error":17,"../lib/create-assets-url":20,"../lib/create-deferred-client":22,"../lib/promise":29,"./errors":9,"./google-payment":10,"@braintree/wrap-promise":7}],12:[function(e,t,r){"use strict";var a=e("./create-authorization-data"),s=e("./json-clone"),c=e("./constants");t.exports=function(e,t){var r,n=t?s(t):{},o=a(e.authorization).attrs,i=s(e.analyticsMetadata);for(r in n.braintreeLibraryVersion=c.BRAINTREE_LIBRARY_VERSION,n._meta)n._meta.hasOwnProperty(r)&&(i[r]=n._meta[r]);return n._meta=i,o.tokenizationKey?n.tokenizationKey=o.tokenizationKey:n.authorizationFingerprint=o.authorizationFingerprint,n}},{"./constants":18,"./create-authorization-data":21,"./json-clone":27}],13:[function(e,t,r){"use strict";var n=e("./promise"),u=e("./constants"),l=e("./add-metadata");t.exports={sendEvent:function(e,a,s){var c=Date.now();return n.resolve(e).then(function(e){var t=Date.now(),r=e.getConfiguration(),n=e._request,o=r.gatewayConfiguration.analytics.url,i={analytics:[{kind:u.ANALYTICS_PREFIX+a,isAsync:Math.floor(t/1e3)!==Math.floor(c/1e3),timestamp:c}]};n({url:o,method:"post",data:l(r,i),timeout:u.ANALYTICS_REQUEST_TIMEOUT_MS},s)})}}},{"./add-metadata":12,"./constants":18,"./promise":29}],14:[function(e,t,r){"use strict";var n=e("@braintree/asset-loader/load-script");t.exports={loadScript:n}},{"@braintree/asset-loader/load-script":2}],15:[function(e,t,r){"use strict";var n="function"==typeof Object.assign?Object.assign:o;function o(e){var t,r,n;for(t=1;t<arguments.length;t++)for(n in r=arguments[t])r.hasOwnProperty(n)&&(e[n]=r[n]);return e}t.exports={assign:n,_assign:o}},{}],16:[function(e,t,r){"use strict";var o=e("./braintree-error"),i=e("./promise"),a=e("./errors");t.exports={verify:function(e){var t,r,n;return e?(n=e.name,t=e.client,r=e.authorization,t||r?r||"3.62.0"===t.getVersion()?i.resolve():i.reject(new o({type:a.INCOMPATIBLE_VERSIONS.type,code:a.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+t.getVersion()+") and "+n+" (version 3.62.0) components must be from the same SDK version."})):i.reject(new o({type:a.INSTANTIATION_OPTION_REQUIRED.type,code:a.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+n+"."}))):i.reject(new o({type:a.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:a.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}}},{"./braintree-error":17,"./errors":24,"./promise":29}],17:[function(e,t,r){"use strict";var n=e("./enumerate");function o(e){if(!o.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}((o.prototype=Object.create(Error.prototype)).constructor=o).types=n(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),o.findRootError=function(e){return e instanceof o&&e.details&&e.details.originalError?o.findRootError(e.details.originalError):e},t.exports=o},{"./enumerate":23}],18:[function(e,t,r){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.62.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.62.0"}},{}],19:[function(e,t,r){"use strict";var n=e("./braintree-error"),o=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new n({type:o.METHOD_CALLED_AFTER_TEARDOWN.type,code:o.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":17,"./errors":24}],20:[function(e,t,r){"use strict";var n=e("./constants").ASSETS_URLS;t.exports={create:function(e){return n.production}}},{"./constants":18}],21:[function(e,t,r){"use strict";var a=e("../lib/vendor/polyfill").atob,s=e("../lib/constants").CLIENT_API_URLS;t.exports=function(e){var t,r,n,o,i={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(o=(n=e.split("_"))[0],r={merchantId:n.slice(2).join("_"),environment:o},i.environment=r.environment,i.attrs.tokenizationKey=e,i.configUrl=s[r.environment]+"/merchants/"+r.merchantId+"/client_api/v1/configuration"):(t=JSON.parse(a(e)),i.environment=t.environment,i.attrs.authorizationFingerprint=t.authorizationFingerprint,i.configUrl=t.configUrl,i.graphQL=t.graphQL),i}},{"../lib/constants":18,"../lib/vendor/polyfill":30}],22:[function(e,t,r){(function(r){"use strict";var n=e("./braintree-error"),o=e("./promise"),i=e("./assets"),a=e("./errors"),s="3.62.0";t.exports={create:function(e){var t=o.resolve();return e.client?o.resolve(e.client):(r.braintree&&r.braintree.client||(t=i.loadScript({src:e.assetsUrl+"/web/"+s+"/js/client.min.js"}).catch(function(e){return o.reject(new n({type:a.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:a.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:a.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:e}}))})),t.then(function(){return r.braintree.client.VERSION!==s?o.reject(new n({type:a.INCOMPATIBLE_VERSIONS.type,code:a.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+r.braintree.client.VERSION+") and "+e.name+" (version "+s+") components must be from the same SDK version."})):r.braintree.client.create({authorization:e.authorization,debug:e.debug})}))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./assets":14,"./braintree-error":17,"./errors":24,"./promise":29}],23:[function(e,t,r){"use strict";t.exports=function(e,r){return r=null==r?"":r,e.reduce(function(e,t){return e[t]=r+t,e},{})}},{}],24:[function(e,t,r){"use strict";var n=e("./braintree-error");t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:n.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:n.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:n.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:n.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:n.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":17}],25:[function(e,t,r){"use strict";t.exports=function(e,t,r){var n;for(n=0;n<e.length;n++)if(e[n].hasOwnProperty(t)&&e[n][t]===r)return e[n];return null}},{}],26:[function(e,t,r){"use strict";var o=e("./assign").assign;function s(e,t){var r=e.analyticsMetadata,n={gateway:"braintree","braintree:merchantId":e.gatewayConfiguration.merchantId,"braintree:apiVersion":"v1","braintree:sdkVersion":"3.62.0","braintree:metadata":JSON.stringify({source:r.source,integration:r.integration,sessionId:r.sessionId,version:"3.62.0",platform:r.platform})};return o({},n,t)}t.exports=function(e,t,r){var n,o,i=e.gatewayConfiguration.androidPay,a="production"===e.gatewayConfiguration.environment?"PRODUCTION":"TEST";return 2===t?(n={apiVersion:2,apiVersionMinor:0,environment:a,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:i.supportedNetworks.map(function(e){return e.toUpperCase()})},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:s(e,{"braintree:authorizationFingerprint":i.googleAuthorizationFingerprint})}}]},r&&(n.merchantInfo={merchantId:r}),i.paypalClientId&&(o={type:"PAYPAL",parameters:{purchase_context:{purchase_units:[{payee:{client_id:i.paypalClientId},recurring_payment:!0}]}},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:s(e,{"braintree:paypalClientId":i.paypalClientId})}},n.allowedPaymentMethods.push(o))):(n={environment:a,allowedPaymentMethods:["CARD","TOKENIZED_CARD"],paymentMethodTokenizationParameters:{tokenizationType:"PAYMENT_GATEWAY",parameters:s(e,{"braintree:authorizationFingerprint":i.googleAuthorizationFingerprint})},cardRequirements:{allowedCardNetworks:i.supportedNetworks.map(function(e){return e.toUpperCase()})}},"TOKENIZATION_KEY"===e.authorizationType&&(n.paymentMethodTokenizationParameters.parameters["braintree:clientKey"]=e.authorization),r&&(n.merchantId=r),t&&(n.apiVersion=t)),n}},{"./assign":15}],27:[function(e,t,r){"use strict";t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],28:[function(e,t,r){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],29:[function(n,o,e){(function(e){"use strict";var t=e.Promise||n("promise-polyfill"),r=n("@braintree/extended-promise");r.suppressUnhandledPromiseMessage=!0,r.setPromise(t),o.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@braintree/extended-promise":3,"promise-polyfill":8}],30:[function(e,n,t){(function(t){"use strict";var r="function"==typeof t.atob?t.atob:e;function e(e){var t,r,n,o,i,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");for(a=0;t=(63&s.indexOf(e.charAt(a++)))<<2|(o=s.indexOf(e.charAt(a++)))>>4&3,r=(15&o)<<4|(i=s.indexOf(e.charAt(a++)))>>2&15,n=(3&i)<<6|63&s.indexOf(e.charAt(a++)),c+=String.fromCharCode(t)+(r?String.fromCharCode(r):"")+(n?String.fromCharCode(n):""),a<e.length;);return c}n.exports={atob:function(e){return r.call(t,e)},_atob:e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[11])(11)}),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports?module.exports=factory:factory(jQuery)}(function($){var nullLowestDeltaTimeout,lowestDelta,toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],slice=Array.prototype.slice;if($.event.fixHooks)for(var i=toFix.length;i;)$.event.fixHooks[toFix[--i]]=$.event.mouseHooks;var special=$.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=toBind.length;i;)this.addEventListener(toBind[--i],handler,!1);else this.onmousewheel=handler;$.data(this,"mousewheel-line-height",special.getLineHeight(this)),$.data(this,"mousewheel-page-height",special.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=toBind.length;i;)this.removeEventListener(toBind[--i],handler,!1);else this.onmousewheel=null;$.removeData(this,"mousewheel-line-height"),$.removeData(this,"mousewheel-page-height")},getLineHeight:function(elem){var $elem=$(elem),$parent=$elem["offsetParent"in $.fn?"offsetParent":"parent"]();return $parent.length||($parent=$("body")),parseInt($parent.css("fontSize"),10)||parseInt($elem.css("fontSize"),10)||16},getPageHeight:function(elem){return $(elem).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function handler(event){var absDelta,orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,offsetX=0,offsetY=0;if((event=$.event.fix(orgEvent)).type="mousewheel","detail"in orgEvent&&(deltaY=-1*orgEvent.detail),"wheelDelta"in orgEvent&&(deltaY=orgEvent.wheelDelta),"wheelDeltaY"in orgEvent&&(deltaY=orgEvent.wheelDeltaY),"wheelDeltaX"in orgEvent&&(deltaX=-1*orgEvent.wheelDeltaX),"axis"in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS&&(deltaX=-1*deltaY,deltaY=0),delta=0===deltaY?deltaX:deltaY,"deltaY"in orgEvent&&(delta=deltaY=-1*orgEvent.deltaY),"deltaX"in orgEvent&&(deltaX=orgEvent.deltaX,0===deltaY&&(delta=-1*deltaX)),0!==deltaY||0!==deltaX){if(1===orgEvent.deltaMode){var lineHeight=$.data(this,"mousewheel-line-height");delta*=lineHeight,deltaY*=lineHeight,deltaX*=lineHeight}else if(2===orgEvent.deltaMode){var pageHeight=$.data(this,"mousewheel-page-height");delta*=pageHeight,deltaY*=pageHeight,deltaX*=pageHeight}if(absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX)),(!lowestDelta||absDelta<lowestDelta)&&shouldAdjustOldDeltas(orgEvent,lowestDelta=absDelta)&&(lowestDelta/=40),shouldAdjustOldDeltas(orgEvent,absDelta)&&(delta/=40,deltaX/=40,deltaY/=40),delta=Math[1<=delta?"floor":"ceil"](delta/lowestDelta),deltaX=Math[1<=deltaX?"floor":"ceil"](deltaX/lowestDelta),deltaY=Math[1<=deltaY?"floor":"ceil"](deltaY/lowestDelta),special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left,offsetY=event.clientY-boundingRect.top}return event.deltaX=deltaX,event.deltaY=deltaY,event.deltaFactor=lowestDelta,event.offsetX=offsetX,event.offsetY=offsetY,event.deltaMode=0,args.unshift(event,delta,deltaX,deltaY),nullLowestDeltaTimeout&&clearTimeout(nullLowestDeltaTimeout),nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200),($.event.dispatch||$.event.handle).apply(this,args)}}function nullLowestDelta(){lowestDelta=null}function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&"mousewheel"===orgEvent.type&&absDelta%120==0}$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}})}),function(){"use strict";function Md5(t){if(t)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var r=new ArrayBuffer(68);this.buffer8=new Uint8Array(r),this.blocks=new Uint32Array(r)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD="function"==typeof define&&define.amd,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}(root.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t){return function(r){return new Md5(!0).update(r)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(r){return t.create().update(r)};for(var r=0;r<OUTPUT_TYPES.length;++r){var e=OUTPUT_TYPES[r];t[e]=createOutputMethod(e)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("md5").update(t,"utf8").digest("hex");if(null==t)throw ERROR;return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash("md5").update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod};Md5.prototype.update=function(t){if(!this.finalized){var r,e=typeof t;if("string"!==e){if("object"!==e)throw ERROR;if(null===t)throw ERROR;if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||ARRAY_BUFFER&&ArrayBuffer.isView(t)))throw ERROR;r=!0}for(var s,i,o=0,h=t.length,f=this.blocks,a=this.buffer8;o<h;){if(this.hashed&&(this.hashed=!1,f[0]=f[16],f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0),r)if(ARRAY_BUFFER)for(i=this.start;o<h&&i<64;++o)a[i++]=t[o];else for(i=this.start;o<h&&i<64;++o)f[i>>2]|=t[o]<<SHIFT[3&i++];else if(ARRAY_BUFFER)for(i=this.start;o<h&&i<64;++o)(s=t.charCodeAt(o))<128?a[i++]=s:(s<2048?a[i++]=192|s>>6:(s<55296||57344<=s?a[i++]=224|s>>12:(s=65536+((1023&s)<<10|1023&t.charCodeAt(++o)),a[i++]=240|s>>18,a[i++]=128|s>>12&63),a[i++]=128|s>>6&63),a[i++]=128|63&s);else for(i=this.start;o<h&&i<64;++o)(s=t.charCodeAt(o))<128?f[i>>2]|=s<<SHIFT[3&i++]:(s<2048?f[i>>2]|=(192|s>>6)<<SHIFT[3&i++]:(s<55296||57344<=s?f[i>>2]|=(224|s>>12)<<SHIFT[3&i++]:(s=65536+((1023&s)<<10|1023&t.charCodeAt(++o)),f[i>>2]|=(240|s>>18)<<SHIFT[3&i++],f[i>>2]|=(128|s>>12&63)<<SHIFT[3&i++]),f[i>>2]|=(128|s>>6&63)<<SHIFT[3&i++]),f[i>>2]|=(128|63&s)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,64<=i?(this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,r=this.lastByteIndex;t[r>>2]|=EXTRA[3&r],56<=r&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,t[15]=this.hBytes<<3|this.bytes>>29,this.hash()}},Md5.prototype.hash=function(){var t,r,e,s,i,o,h=this.blocks;this.first?r=((t=((t=h[0]-680876937)<<7|t>>>25)-271733879<<0)^(e=((e=(-271733879^(s=((s=(-1732584194^2004318071&t)+h[1]-117830708)<<12|s>>>20)+t<<0)&(-271733879^t))+h[2]-1126478375)<<17|e>>>15)+s<<0)&(s^t))+h[3]-1316259209:(t=this.h0,r=this.h1,e=this.h2,r+=((t=((t+=((s=this.h3)^r&(e^s))+h[0]-680876936)<<7|t>>>25)+r<<0)^(e=((e+=(r^(s=((s+=(e^t&(r^e))+h[1]-389564586)<<12|s>>>20)+t<<0)&(t^r))+h[2]+606105819)<<17|e>>>15)+s<<0)&(s^t))+h[3]-1044525330),r=(r<<22|r>>>10)+e<<0,r=((r+=((t=((t+=(s^r&(e^s))+h[4]-176418897)<<7|t>>>25)+r<<0)^(e=((e+=(r^(s=((s+=(e^t&(r^e))+h[5]+1200080426)<<12|s>>>20)+t<<0)&(t^r))+h[6]-1473231341)<<17|e>>>15)+s<<0)&(s^t))+h[7]-45705983)<<22|r>>>10)+e<<0,r=((r+=((t=((t+=(s^r&(e^s))+h[8]+1770035416)<<7|t>>>25)+r<<0)^(e=((e+=(r^(s=((s+=(e^t&(r^e))+h[9]-1958414417)<<12|s>>>20)+t<<0)&(t^r))+h[10]-42063)<<17|e>>>15)+s<<0)&(s^t))+h[11]-1990404162)<<22|r>>>10)+e<<0,r=((r+=((t=((t+=(s^r&(e^s))+h[12]+1804603682)<<7|t>>>25)+r<<0)^(e=((e+=(r^(s=((s+=(e^t&(r^e))+h[13]-40341101)<<12|s>>>20)+t<<0)&(t^r))+h[14]-1502002290)<<17|e>>>15)+s<<0)&(s^t))+h[15]+1236535329)<<22|r>>>10)+e<<0,r=((r+=((s=((s+=(r^e&((t=((t+=(e^s&(r^e))+h[1]-165796510)<<5|t>>>27)+r<<0)^r))+h[6]-1069501632)<<9|s>>>23)+t<<0)^t&((e=((e+=(t^r&(s^t))+h[11]+643717713)<<14|e>>>18)+s<<0)^s))+h[0]-373897302)<<20|r>>>12)+e<<0,r=((r+=((s=((s+=(r^e&((t=((t+=(e^s&(r^e))+h[5]-701558691)<<5|t>>>27)+r<<0)^r))+h[10]+38016083)<<9|s>>>23)+t<<0)^t&((e=((e+=(t^r&(s^t))+h[15]-660478335)<<14|e>>>18)+s<<0)^s))+h[4]-405537848)<<20|r>>>12)+e<<0,r=((r+=((s=((s+=(r^e&((t=((t+=(e^s&(r^e))+h[9]+568446438)<<5|t>>>27)+r<<0)^r))+h[14]-1019803690)<<9|s>>>23)+t<<0)^t&((e=((e+=(t^r&(s^t))+h[3]-187363961)<<14|e>>>18)+s<<0)^s))+h[8]+1163531501)<<20|r>>>12)+e<<0,r=((r+=((s=((s+=(r^e&((t=((t+=(e^s&(r^e))+h[13]-1444681467)<<5|t>>>27)+r<<0)^r))+h[2]-51403784)<<9|s>>>23)+t<<0)^t&((e=((e+=(t^r&(s^t))+h[7]+1735328473)<<14|e>>>18)+s<<0)^s))+h[12]-1926607734)<<20|r>>>12)+e<<0,r=((r+=((o=(s=((s+=((i=r^e)^(t=((t+=(i^s)+h[5]-378558)<<4|t>>>28)+r<<0))+h[8]-2022574463)<<11|s>>>21)+t<<0)^t)^(e=((e+=(o^r)+h[11]+1839030562)<<16|e>>>16)+s<<0))+h[14]-35309556)<<23|r>>>9)+e<<0,r=((r+=((o=(s=((s+=((i=r^e)^(t=((t+=(i^s)+h[1]-1530992060)<<4|t>>>28)+r<<0))+h[4]+1272893353)<<11|s>>>21)+t<<0)^t)^(e=((e+=(o^r)+h[7]-155497632)<<16|e>>>16)+s<<0))+h[10]-1094730640)<<23|r>>>9)+e<<0,r=((r+=((o=(s=((s+=((i=r^e)^(t=((t+=(i^s)+h[13]+681279174)<<4|t>>>28)+r<<0))+h[0]-358537222)<<11|s>>>21)+t<<0)^t)^(e=((e+=(o^r)+h[3]-722521979)<<16|e>>>16)+s<<0))+h[6]+76029189)<<23|r>>>9)+e<<0,r=((r+=((o=(s=((s+=((i=r^e)^(t=((t+=(i^s)+h[9]-640364487)<<4|t>>>28)+r<<0))+h[12]-421815835)<<11|s>>>21)+t<<0)^t)^(e=((e+=(o^r)+h[15]+530742520)<<16|e>>>16)+s<<0))+h[2]-995338651)<<23|r>>>9)+e<<0,r=((r+=((s=((s+=(r^((t=((t+=(e^(r|~s))+h[0]-198630844)<<6|t>>>26)+r<<0)|~e))+h[7]+1126891415)<<10|s>>>22)+t<<0)^((e=((e+=(t^(s|~r))+h[14]-1416354905)<<15|e>>>17)+s<<0)|~t))+h[5]-57434055)<<21|r>>>11)+e<<0,r=((r+=((s=((s+=(r^((t=((t+=(e^(r|~s))+h[12]+1700485571)<<6|t>>>26)+r<<0)|~e))+h[3]-1894986606)<<10|s>>>22)+t<<0)^((e=((e+=(t^(s|~r))+h[10]-1051523)<<15|e>>>17)+s<<0)|~t))+h[1]-2054922799)<<21|r>>>11)+e<<0,r=((r+=((s=((s+=(r^((t=((t+=(e^(r|~s))+h[8]+1873313359)<<6|t>>>26)+r<<0)|~e))+h[15]-30611744)<<10|s>>>22)+t<<0)^((e=((e+=(t^(s|~r))+h[6]-1560198380)<<15|e>>>17)+s<<0)|~t))+h[13]+1309151649)<<21|r>>>11)+e<<0,r=((r+=((s=((s+=(r^((t=((t+=(e^(r|~s))+h[4]-145523070)<<6|t>>>26)+r<<0)|~e))+h[11]-1120210379)<<10|s>>>22)+t<<0)^((e=((e+=(t^(s|~r))+h[2]+718787259)<<15|e>>>17)+s<<0)|~t))+h[9]-343485551)<<21|r>>>11)+e<<0,this.first?(this.h0=t+1732584193<<0,this.h1=r-271733879<<0,this.h2=e-1732584194<<0,this.h3=s+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+r<<0,this.h2=this.h2+e<<0,this.h3=this.h3+s<<0)},Md5.prototype.hex=function(){this.finalize();var t=this.h0,r=this.h1,e=this.h2,s=this.h3;return HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var t=this.h0,r=this.h1,e=this.h2,s=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&s,s>>8&255,s>>16&255,s>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),r=new Uint32Array(t);return r[0]=this.h0,r[1]=this.h1,r[2]=this.h2,r[3]=this.h3,t},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var t,r,e,s="",i=this.array(),o=0;o<15;)t=i[o++],r=i[o++],e=i[o++],s+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[63&(t<<4|r>>>4)]+BASE64_ENCODE_CHAR[63&(r<<2|e>>>6)]+BASE64_ENCODE_CHAR[63&e];return t=i[o],s+(BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[t<<4&63]+"==")};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&define(function(){return exports}))}(),function(){var $,cardFromNumber,cardFromType,cards,defaultFormat,formatBackCardNumber,formatBackExpiry,formatCardNumber,formatExpiry,formatForwardExpiry,formatForwardSlashAndSpace,hasTextSelected,luhnCheck,reFormatCVC,reFormatCardNumber,reFormatExpiry,reFormatNumeric,replaceFullWidthChars,restrictCVC,restrictCardNumber,restrictExpiry,restrictNumeric,safeVal,setCardType,__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};($=window.jQuery||window.Zepto||window.$).payment={},$.payment.fn={},$.fn.payment=function(){var args,method;return method=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],$.payment.fn[method].apply(this,args)},defaultFormat=/(\d{1,4})/g,$.payment.cards=cards=[{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:defaultFormat,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"visa",patterns:[4],format:defaultFormat,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:defaultFormat,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:defaultFormat,length:[16],cvcLength:[3],luhn:!0}],cardFromNumber=function(num){var card,p,_i,_j,_len,_len1,_ref;for(num=(num+"").replace(/\D/g,""),_i=0,_len=cards.length;_i<_len;_i++)for(_j=0,_len1=(_ref=(card=cards[_i]).patterns).length;_j<_len1;_j++)if(p=_ref[_j]+"",num.substr(0,p.length)===p)return card},cardFromType=function(type){var card,_i,_len;for(_i=0,_len=cards.length;_i<_len;_i++)if((card=cards[_i]).type===type)return card},luhnCheck=function(num){var digit,digits,odd,sum,_i,_len;for(odd=!0,_i=sum=0,_len=(digits=(num+"").split("").reverse()).length;_i<_len;_i++)digit=digits[_i],digit=parseInt(digit,10),(odd=!odd)&&(digit*=2),9<digit&&(digit-=9),sum+=digit;return sum%10==0},hasTextSelected=function($target){var _ref;return null!=$target.prop("selectionStart")&&$target.prop("selectionStart")!==$target.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(_ref=document.selection)?_ref.createRange:void 0)||!document.selection.createRange().text)},safeVal=function(value,$target){var currPair,cursor,digit,last,prevPair;try{cursor=$target.prop("selectionStart")}catch(_error){_error,cursor=null}if(last=$target.val(),$target.val(value),null!==cursor&&$target.is(":focus"))return cursor===last.length&&(cursor=value.length),last!==value&&(prevPair=last.slice(cursor-1,+cursor+1||9e9),currPair=value.slice(cursor-1,+cursor+1||9e9),digit=value[cursor],/\d/.test(digit)&&prevPair===digit+" "&&currPair===" "+digit&&(cursor+=1)),$target.prop("selectionStart",cursor),$target.prop("selectionEnd",cursor)},replaceFullWidthChars=function(str){var chars,chr,idx,value,_i,_len;for(null==str&&(str=""),"","0123456789",value="",_i=0,_len=(chars=str.split("")).length;_i<_len;_i++)chr=chars[_i],-1<(idx="".indexOf(chr))&&(chr="0123456789"[idx]),value+=chr;return value},reFormatNumeric=function(e){var $target;return $target=$(e.currentTarget),setTimeout(function(){var value;return value=$target.val(),value=(value=replaceFullWidthChars(value)).replace(/\D/g,""),safeVal(value,$target)})},reFormatCardNumber=function(e){var $target;return $target=$(e.currentTarget),setTimeout(function(){var value;return value=$target.val(),value=replaceFullWidthChars(value),value=$.payment.formatCardNumber(value),safeVal(value,$target)})},formatCardNumber=function(e){var $target,card,digit,length,re,upperLength,value;if(digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&($target=$(e.currentTarget),value=$target.val(),card=cardFromNumber(value+digit),length=(value.replace(/\D/g,"")+digit).length,upperLength=16,card&&(upperLength=card.length[card.length.length-1]),!(upperLength<=length||null!=$target.prop("selectionStart")&&$target.prop("selectionStart")!==value.length)))return(re=card&&"amex"===card.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(value)?(e.preventDefault(),setTimeout(function(){return $target.val(value+" "+digit)})):re.test(value+digit)?(e.preventDefault(),setTimeout(function(){return $target.val(value+digit+" ")})):void 0},formatBackCardNumber=function(e){var $target,value;if($target=$(e.currentTarget),value=$target.val(),8===e.which&&(null==$target.prop("selectionStart")||$target.prop("selectionStart")===value.length))return/\d\s$/.test(value)?(e.preventDefault(),setTimeout(function(){return $target.val(value.replace(/\d\s$/,""))})):/\s\d?$/.test(value)?(e.preventDefault(),setTimeout(function(){return $target.val(value.replace(/\d$/,""))})):void 0},reFormatExpiry=function(e){var $target;return $target=$(e.currentTarget),setTimeout(function(){var value;return value=$target.val(),value=replaceFullWidthChars(value),value=$.payment.formatExpiry(value),safeVal(value,$target)})},formatExpiry=function(e){var $target,digit,val;if(digit=String.fromCharCode(e.which),/^\d+$/.test(digit))return $target=$(e.currentTarget),val=$target.val()+digit,/^\d$/.test(val)&&"0"!==val&&"1"!==val?(e.preventDefault(),setTimeout(function(){return $target.val("0"+val+" / ")})):/^\d\d$/.test(val)?(e.preventDefault(),setTimeout(function(){var m1,m2;return m1=parseInt(val[0],10),2<(m2=parseInt(val[1],10))&&0!==m1?$target.val("0"+m1+" / "+m2):$target.val(val+" / ")})):void 0},formatForwardExpiry=function(e){var $target,digit,val;if(digit=String.fromCharCode(e.which),/^\d+$/.test(digit))return val=($target=$(e.currentTarget)).val(),/^\d\d$/.test(val)?$target.val(val+" / "):void 0},formatForwardSlashAndSpace=function(e){var $target,val,which;if("/"===(which=String.fromCharCode(e.which))||" "===which)return val=($target=$(e.currentTarget)).val(),/^\d$/.test(val)&&"0"!==val?$target.val("0"+val+" / "):void 0},formatBackExpiry=function(e){var $target,value;if($target=$(e.currentTarget),value=$target.val(),8===e.which&&(null==$target.prop("selectionStart")||$target.prop("selectionStart")===value.length))return/\d\s\/\s$/.test(value)?(e.preventDefault(),setTimeout(function(){return $target.val(value.replace(/\d\s\/\s$/,""))})):void 0},reFormatCVC=function(e){var $target;return $target=$(e.currentTarget),setTimeout(function(){var value;return value=$target.val(),value=(value=replaceFullWidthChars(value)).replace(/\D/g,"").slice(0,4),safeVal(value,$target)})},restrictNumeric=function(e){var input;return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(input=String.fromCharCode(e.which),!!/[\d\s]/.test(input))))},restrictCardNumber=function(e){var $target,card,digit,value;if($target=$(e.currentTarget),digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&!hasTextSelected($target))return value=($target.val()+digit).replace(/\D/g,""),(card=cardFromNumber(value))?value.length<=card.length[card.length.length-1]:value.length<=16},restrictExpiry=function(e){var $target,digit;if($target=$(e.currentTarget),digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&!hasTextSelected($target))return!(6<($target.val()+digit).replace(/\D/g,"").length)&&void 0},restrictCVC=function(e){var $target,digit;if($target=$(e.currentTarget),digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&!hasTextSelected($target))return($target.val()+digit).length<=4},setCardType=function(e){var $target,allTypes,card,cardType,val;if(val=($target=$(e.currentTarget)).val(),cardType=$.payment.cardType(val)||"unknown",!$target.hasClass(cardType))return allTypes=function(){var _i,_len,_results;for(_results=[],_i=0,_len=cards.length;_i<_len;_i++)card=cards[_i],_results.push(card.type);return _results}(),$target.removeClass("unknown"),$target.removeClass(allTypes.join(" ")),$target.addClass(cardType),$target.toggleClass("identified","unknown"!==cardType),$target.trigger("payment.cardType",cardType)},$.payment.fn.formatCardCVC=function(){return this.on("keypress",restrictNumeric),this.on("keypress",restrictCVC),this.on("paste",reFormatCVC),this.on("change",reFormatCVC),this.on("input",reFormatCVC),this},$.payment.fn.formatCardExpiry=function(){return this.on("keypress",restrictNumeric),this.on("keypress",restrictExpiry),this.on("keypress",formatExpiry),this.on("keypress",formatForwardSlashAndSpace),this.on("keypress",formatForwardExpiry),this.on("keydown",formatBackExpiry),this.on("change",reFormatExpiry),this.on("input",reFormatExpiry),this},$.payment.fn.formatCardNumber=function(){return this.on("keypress",restrictNumeric),this.on("keypress",restrictCardNumber),this.on("keypress",formatCardNumber),this.on("keydown",formatBackCardNumber),this.on("keyup",setCardType),this.on("paste",reFormatCardNumber),this.on("change",reFormatCardNumber),this.on("input",reFormatCardNumber),this.on("input",setCardType),this},$.payment.fn.restrictNumeric=function(){return this.on("keypress",restrictNumeric),this.on("paste",reFormatNumeric),this.on("change",reFormatNumeric),this.on("input",reFormatNumeric),this},$.payment.fn.cardExpiryVal=function(){return $.payment.cardExpiryVal($(this).val())},$.payment.cardExpiryVal=function(value){var month,year,_ref;return month=(_ref=value.split(/[\s\/]+/,2))[0],2===(null!=(year=_ref[1])?year.length:void 0)&&/^\d+$/.test(year)&&(year=(new Date).getFullYear().toString().slice(0,2)+year),{month:month=parseInt(month,10),year:year=parseInt(year,10)}},$.payment.validateCardNumber=function(num){var card,_ref;return num=(num+"").replace(/\s+|-/g,""),!!/^\d+$/.test(num)&&(!!(card=cardFromNumber(num))&&(_ref=num.length,0<=__indexOf.call(card.length,_ref)&&(!1===card.luhn||luhnCheck(num))))},$.payment.validateCardExpiry=function(month,year){var currentTime,expiry,_ref;return"object"==typeof month&&"month"in month&&(month=(_ref=month).month,year=_ref.year),!(!month||!year)&&(month=$.trim(month),year=$.trim(year),!!/^\d+$/.test(month)&&(!!/^\d+$/.test(year)&&(1<=month&&month<=12&&(2===year.length&&(year=year<70?"20"+year:"19"+year),4===year.length&&(expiry=new Date(year,month),currentTime=new Date,expiry.setMonth(expiry.getMonth()-1),expiry.setMonth(expiry.getMonth()+1,1),currentTime<expiry)))))},$.payment.validateCardCVC=function(cvc,type){var card,_ref;return cvc=$.trim(cvc),!!/^\d+$/.test(cvc)&&(null!=(card=cardFromType(type))?(_ref=cvc.length,0<=__indexOf.call(card.cvcLength,_ref)):3<=cvc.length&&cvc.length<=4)},$.payment.cardType=function(num){var _ref;return num&&(null!=(_ref=cardFromNumber(num))?_ref.type:void 0)||null},$.payment.formatCardNumber=function(num){var card,groups,upperLength,_ref;return num=num.replace(/\D/g,""),(card=cardFromNumber(num))?(upperLength=card.length[card.length.length-1],num=num.slice(0,upperLength),card.format.global?null!=(_ref=num.match(card.format))?_ref.join(" "):void 0:null!=(groups=card.format.exec(num))?(groups.shift(),(groups=$.grep(groups,function(n){return n})).join(" ")):void 0):num},$.payment.formatExpiry=function(expiry){var mon,parts,sep,year;return(parts=expiry.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(mon=parts[1]||"",sep=parts[2]||"",0<(year=parts[3]||"").length?sep=" / ":" /"===sep?(mon=mon.substring(0,1),sep=""):2===mon.length||0<sep.length?sep=" / ":1===mon.length&&"0"!==mon&&"1"!==mon&&(mon="0"+mon,sep=" / "),mon+sep+year):""}}.call(this),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.WHATWGFetch={})}(this,function(exports){"use strict";var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(support.arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&-1<viewClasses.indexOf(Object.prototype.toString.call(obj))};function normalizeName(name){if("string"!=typeof name&&(name=String(name)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(name))throw new TypeError("Invalid character in header field name");return name.toLowerCase()}function normalizeValue(value){return"string"!=typeof value&&(value=String(value)),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return support.iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):Array.isArray(headers)?headers.forEach(function(header){this.append(header[0],header[1])},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){if(body.bodyUsed)return Promise.reject(new TypeError("Already read"));body.bodyUsed=!0}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){var obj;(this._bodyInit=body)?"string"==typeof body?this._bodyText=body:support.blob&&Blob.prototype.isPrototypeOf(body)?this._bodyBlob=body:support.formData&&FormData.prototype.isPrototypeOf(body)?this._bodyFormData=body:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)?this._bodyText=body.toString():support.arrayBuffer&&support.blob&&((obj=body)&&DataView.prototype.isPrototypeOf(obj))?(this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))?this._bodyArrayBuffer=bufferClone(body):this._bodyText=body=Object.prototype.toString.call(body):this._bodyText="",this.headers.get("content-type")||("string"==typeof body?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support.blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var blob,reader,promise,rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return blob=this._bodyBlob,reader=new FileReader,promise=fileReaderReady(reader),reader.readAsText(blob),promise;if(this._bodyArrayBuffer)return Promise.resolve(function(buf){for(var view=new Uint8Array(buf),chars=new Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+", "+value:value},Headers.prototype.delete=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){return name=normalizeName(name),this.has(name)?this.map[name]:null},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)},Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map)this.map.hasOwnProperty(name)&&callback.call(thisArg,this.map[name],name,this)},Headers.prototype.keys=function(){var items=[];return this.forEach(function(value,name){items.push(name)}),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach(function(value){items.push(value)}),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach(function(value,name){items.push([name,value])}),iteratorFor(items)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Request(input,options){var method,upcased,body=(options=options||{}).body;if(input instanceof Request){if(input.bodyUsed)throw new TypeError("Already read");this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,this.signal=input.signal,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=String(input);if(this.credentials=options.credentials||this.credentials||"same-origin",!options.headers&&this.headers||(this.headers=new Headers(options.headers)),this.method=(method=options.method||this.method||"GET",upcased=method.toUpperCase(),-1<methods.indexOf(upcased)?upcased:method),this.mode=options.mode||this.mode||null,this.signal=options.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("="),name=split.shift().replace(/\+/g," "),value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function Response(bodyInit,options){options||(options={}),this.type="default",this.status=void 0===options.status?200:options.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in options?options.statusText:"OK",this.headers=new Headers(options.headers),this.url=options.url||"",this._initBody(bodyInit)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:""});return response.type="error",response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError("Invalid status code");return new Response(null,{status:status,headers:{location:url}})},exports.DOMException=self.DOMException;try{new exports.DOMException}catch(err){exports.DOMException=function(message,name){this.message=message,this.name=name;var error=Error(message);this.stack=error.stack},exports.DOMException.prototype=Object.create(Error.prototype),exports.DOMException.prototype.constructor=exports.DOMException}function fetch(input,init){return new Promise(function(resolve,reject){var request=new Request(input,init);if(request.signal&&request.signal.aborted)return reject(new exports.DOMException("Aborted","AbortError"));var xhr=new XMLHttpRequest;function abortXhr(){xhr.abort()}xhr.onload=function(){var rawHeaders,headers,options={status:xhr.status,statusText:xhr.statusText,headers:(rawHeaders=xhr.getAllResponseHeaders()||"",headers=new Headers,rawHeaders.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(line){var parts=line.split(":"),key=parts.shift().trim();if(key){var value=parts.join(":").trim();headers.append(key,value)}}),headers)};options.url="responseURL"in xhr?xhr.responseURL:options.headers.get("X-Request-URL");var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError("Network request failed"))},xhr.ontimeout=function(){reject(new TypeError("Network request failed"))},xhr.onabort=function(){reject(new exports.DOMException("Aborted","AbortError"))},xhr.open(request.method,request.url,!0),"include"===request.credentials?xhr.withCredentials=!0:"omit"===request.credentials&&(xhr.withCredentials=!1),"responseType"in xhr&&support.blob&&(xhr.responseType="blob"),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),request.signal&&(request.signal.addEventListener("abort",abortXhr),xhr.onreadystatechange=function(){4===xhr.readyState&&request.signal.removeEventListener("abort",abortXhr)}),xhr.send(void 0===request._bodyInit?null:request._bodyInit)})}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response),exports.Headers=Headers,exports.Request=Request,exports.Response=Response,exports.fetch=fetch,Object.defineProperty(exports,"__esModule",{value:!0})}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory():"function"==typeof define&&define.amd?define(factory):factory()}(0,function(){"use strict";function finallyConstructor(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})}var setTimeoutFunc=setTimeout;function isArray(x){return Boolean(x&&void 0!==x.length)}function noop(){}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve((fn=then,thisArg=newValue,function(){fn.apply(thisArg,arguments)}),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}var fn,thisArg}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new function(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}(onFulfilled,onRejected,prom)),prom},Promise.prototype.finally=finallyConstructor,Promise.all=function(arr){return new Promise(function(resolve,reject){if(!isArray(arr))return reject(new TypeError("Promise.all accepts an array"));var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(arr){return new Promise(function(resolve,reject){if(!isArray(arr))return reject(new TypeError("Promise.race accepts an array"));for(var i=0,len=arr.length;i<len;i++)Promise.resolve(arr[i]).then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)};var globalNS=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"Promise"in globalNS?globalNS.Promise.prototype.finally||(globalNS.Promise.prototype.finally=finallyConstructor):globalNS.Promise=Promise});var MS_SECOND=1e3,MS_MINUTE=60*MS_SECOND,MS_HOUR=60*MS_MINUTE,MS_DAY=24*MS_HOUR,VectorStock=VectorStock||{};if(VectorStock.js={zclip:"/js/libraries/jquery.zclip.js",addthis:"//s7.addthis.com/js/250/addthis_widget.js#pubid=vectorstock",addthis_new:"//s7.addthis.com/js/300/addthis_widget.js#pubid=vectorstock",analytics:"//google-analytics.com/ga.js",facebook:"//connect.facebook.net/en_US/all.js#xfbml=1&appId=241100862642313",googleplus:"//apis.google.com/js/plusone.js",pinterest:"//assets.pinterest.com/js/pinit.js",twitter:"//platform.twitter.com/widgets.js"},VectorStock.google_id="101753067915-kdnvvq7hnnmrkia4f8ld6vrsuuco80c0.apps.googleusercontent.com",VectorStock.analytics_id="UA-2180430-2",VectorStock.host="//www.vectorstock.com",VectorStock.amazonHost="https://vectorstock-uploads.s3.amazonaws.com",VectorStock.domain="//cdn.vectorstock.com",VectorStock.time=(new Date).getTime(),VectorStock.defaultInputText=["Search any Keyword...","Search for Artist...","Search for Vector ID..."],VectorStock.cache={vectors:{}},window.ga){var GA_LOCAL_STORAGE_KEY="ga:clientId";window.localStorage?(ga("create",VectorStock.analytics_id,{cookieDomain:"none",storage:"none",clientId:localStorage.getItem(GA_LOCAL_STORAGE_KEY)}),ga(function(tracker){localStorage.setItem(GA_LOCAL_STORAGE_KEY,tracker.get("clientId"))})):ga("create",VectorStock.analytics_id,"none"),ga("send","pageview")}var addthis_config={data_ga_property:VectorStock.analytics_id,data_track_clickback:!0,data_ga_social:!0},adroll_adv_id="FGEN3AZRB5FR7IPG3EJY2N",adroll_pix_id="4MPPFIS53BCNTEJONTB5OY",__adroll_loaded=!0;VectorStock.track=function(){window.ga||(window.ga=function(){window.console&&window.console.log});try{ga.apply(this,arguments)}catch(err){}},VectorStock.trackPage=function(page,title){VectorStock.track("send","pageview",{page:page,title:title})},VectorStock.trackSearch=function(search,page,category,title){var search_query=encodeURIComponent(search.toLowerCase());VectorStock.trackPage(page+"?keywords="+search_query+"&category="+category+"&type=internal",title)},VectorStock.log=function(payload,type){type=type||"warning";$.post("/api/log/"+type,payload)},function(){function isFileRemote(file){return 0<=file.search(/https?:/i)&&file.search(/:\/\/[w.]*vectorstock\.com/i)<0}function isBrowserOld(){return!window.JSON}window.onerror=function(message,source,lineno,colno,error){if((!source||!isFileRemote(source))&&message&&message.match&&!message.match(/script error/i)&&!isBrowserOld()){var log={page:window.location.href,source:source,position:lineno?colno?lineno+":"+colno:lineno:"",user:$("#user_id").val()||$('input[name="account_timestamp"]').val()||"Unknown"};if(message.match(/nsresult:/i)){var exception=/\exception[\.]+\s+"(.+?)"/i.exec(message);if(1<exception.length){var location=/location:\s+"(.+?)"/i.exec(message);if(1<location.length){var url=/(https\S+)/i.exec(location[1]);if(url&&1<url.length){if(isFileRemote(url[1]))return;log.source=url[1]}var line=/line (\d+)/i.exec(location[1]);line&&1<line.length&&(log.position=line[1])}message=exception[1]}}if(error&&error.stack){if(isFileRemote(source=/([^@(\s]+?):([:\d]+)/i.exec(error.stack)[1]||""))return;log.stack=error.stack}VectorStock.track("send","event","Error (JS)",message,JSON.stringify(log))}},$(document).ajaxError(function(event,request,settings){if((0!=request.status||"error"!=request.statusText)&&!isBrowserOld()){if(settings.data&&"string"==typeof settings.data)for(var params=settings.data.split("&"),i=0;i<params.length;i++){var param=params[i].split("=");if("login_password"==param[0].toLowerCase()){param[1]=Array(param[1].length+1).join("*"),params[i]=param.join("="),settings.data=params.join("&");break}}var log={page:event.target.URL,request:settings.url,data:settings.data,method:settings.type,code:request.status,user:$("#user_id").val()||$('input[name="account_timestamp"]').val()||"Unknown"};401==request.status&&window.SignupBox?new SignupBox({screen:"login"}):(200==request.status&&(log.response=request.responseText),VectorStock.track("send","event","Error (JS)","AJAXError: "+request.statusText,JSON.stringify(log)))}})}(),$.put=function(url,data,callback,type){return $.isFunction(data)&&(type=type||callback,callback=data,data={}),$.ajax({url:url,type:"PUT",data:data,success:callback,contentType:type})},$.delete=function(url,data,callback,type){return $.isFunction(data)&&(type=type||callback,callback=data,data={}),$.ajax({url:url,type:"DELETE",data:data,success:callback,contentType:type})},$.fn.forceNumericOnly=function(){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",function(){/^\d*$/.test(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")&&(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd))})},$.fn.getCaretPosition=function(){var elem=this[0];if("selectionStart"in elem)return elem.selectionStart;if(document.selection){elem.focus();var sel=document.selection.createRange(),sel_length=document.selection.createRange().text.length;return sel.moveStart("character",-elem.value.length),sel.text.length-sel_length}return null},$.fn.setCaretPosition=function(pos){return this.each(function(index,elem){if(elem.setSelectionRange)elem.setSelectionRange(pos,pos);else if(elem.createTextRange){var range=elem.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}),this},$.fn.isEmpty=function(){var val=this.val();return val==this.attr("placeholder")||""==val},$.fn.typeEvents=function(){this.each(function(){var timeout_typing,input=$(this);input.on("keydown paste",function(){var len=input.val().length;setTimeout(function(){input.val().length!==len&&input.trigger("value_change")},10)}),input.on("value_change",function(){timeout_typing?clearTimeout(timeout_typing):input.trigger("type_start"),timeout_typing=setTimeout(function(){input.trigger("type_stop"),clearTimeout(timeout_typing),timeout_typing=null},300)})})},$(window).each(function(){var timeout,init=!1,scope=$(this);scope.on("resize",function(){init||(scope.trigger("resizeStart"),init=!0),clearInterval(timeout),timeout=setTimeout(function(){scope.trigger("resizeStop"),init=!1},300)})}),Number.prototype.formatCommas=function(shorthand){if(shorthand){if(1e6<=this)return String(Math.floor(this/1e5)/10)+"m";if(1e4<=this)return String(Math.floor(this/1e3))+"k"}return String(this).replace(/(\d)(?=(\d{3})+\b)/g,"$1,")},String.prototype.zeroPad=function(len){var str=String(this);return str.length>=len?str:new Array(len-str.length+1).join("0")+str},Number.prototype.zeroPad=function(len){return String(this).zeroPad(len)},String.prototype.formatCommas=function(){var parts=this.split("."),whole=parseInt(parts.shift());return isNaN(whole)?this:parts.length?whole.formatCommas()+"."+parts.join():whole.formatCommas()},String.prototype.toTitleCase=function(){return this.toLowerCase().replace(/(?:^|\s)\w/g,function(match){return match.toUpperCase()})},String.prototype.toNumber=function(){var adj=this.match(/%\s?$/gi)?.01:1;return parseFloat(this.replace(/[\$,]/g,""))*adj},Array.prototype.filter||(Array.prototype.filter=function(method,scope){if(null==this||"function"!=typeof method)throw new TypeError;for(var arr=Object(this),len=arr.length>>>0,res=[],i=0;i<len;i++)if(i in arr){var val=arr[i];method.call(scope,val,i,arr)&&res.push(val)}return res}),Array.prototype.indexOf||(Array.prototype.indexOf=function(needle,index){index=index||0;for(var len=this.length;index<len;){if(this[index]===needle)return index;++index}return-1}),Array.prototype.remove=function(){for(var needle,index,len=arguments.length;len&&this.length;)for(needle=arguments[--len];-1!==(index=this.indexOf(needle));)this.splice(index,1);return this};var VSModule=function(){var INSTANCE={},events={};return INSTANCE.dispatchEvent=function(eventtype,args){if(events[eventtype]){null==args||null==args?args=[]:args instanceof Array!=!0&&(args=[args]);for(var i=events[eventtype].length;i--;)events[eventtype][i].apply(INSTANCE,args)}return INSTANCE},INSTANCE.on=function(eventtype,method){if("string"==typeof eventtype){var types=eventtype.split(" ");eventtype=1<types.length?types:eventtype}if(eventtype instanceof Array){for(var index in eventtype)INSTANCE.on(eventtype[index],method);return INSTANCE}return events[eventtype]||(events[eventtype]=[]),events[eventtype].push(method),INSTANCE},INSTANCE.off=function(eventtype,method){if("string"==typeof eventtype){var types=eventtype.split(" ");eventtype=1<types.length?types:eventtype}if(eventtype instanceof Array){for(var index in eventtype)INSTANCE.off(eventtype[index],method);return INSTANCE}if(events[eventtype])for(var i=events[eventtype].length;i--;)if(events[eventtype][i]==method){events[eventtype].splice(i,1);break}return INSTANCE},INSTANCE};!function($){var ID_CLASSNAME="vs_loadicon";$.fn.loadingIcon=function(icon_type,icon_shade){var instances,time_cleanup=1e3,svg_code='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 40 40" style="enable-background:new 0 0 40 40;" xml:space="preserve"><g><path d="M12.436,35.229C6.843,32.445,3,26.671,3,20c0-9.39,7.611-17,17-17l-2.532,7.767"/><path d="M27.561,4.769C33.155,7.551,37,13.327,37,20c0,9.389-7.611,17-17,17l2.531-7.768"/></g></svg>';icon_type=icon_type||"medium",icon_shade=icon_shade||"";return this.each(function(){var container,icon,film,int_animation,int_cleanup;function isFinished(){(icon.is(":hidden")||icon.css("opacity")<.1||"hidden"==icon.css("visibility"))&&(icon.remove(),clearInterval(int_animation),clearInterval(int_cleanup))}container=$(this),icon=$("<span></span>").addClass(ID_CLASSNAME).addClass(icon_type).addClass(icon_shade).appendTo(container),film=$("<span></span>").appendTo(icon),$(svg_code).appendTo(film),icon.addClass("animate_css"),int_cleanup=setInterval(isFinished,time_cleanup),instances=instances?instances.add(icon):icon}),instances}}(jQuery),function($){$.fn.dropdown=function(settings_custom){var settings=$.extend({},{classname:"dropdown",width:0},settings_custom);return this.each(function(){var original,module,button,label,options,area,list,icon,is_open,selected_index,scroll_position,open_height;function onMousewheel(event,delta){var top=list.scrollTop();0<delta&&0==top?event.preventDefault():delta<0&&top==list[0].scrollHeight-list.innerHeight()&&event.preventDefault()}function toggleState(){is_open?close():open()}function open(){is_open||($("."+settings.classname).not(module).each(function(){$(this).trigger("close")}),$(document).on("mousedown",mouseDown),$(document).on("keydown",scrollTo),module.addClass("open"),list.scrollTop(scroll_position),is_open=!0)}function close(){if(is_open){$(document).off("mousedown",mouseDown),$(document).off("keydown",scrollTo),module.removeClass("open"),module.addClass("close");var transitionEnd="webkitTransitionEnd oTransitionEnd MSTransitionEnd transitionend",transitionComplete=function(){module.removeClass("close"),module.off(transitionEnd,transitionComplete)};module.on(transitionEnd,transitionComplete),is_open=!1}}function mouseDown(event){0===$(event.target).parents("."+settings.classname).length&&close()}function onListClick(event){"LI"===event.target.tagName&&(selectItem($(event.target)),setTimeout(function(){close()},150))}function selectItem(item){var item_index=$("li",list).index(item);item_index!==selected_index&&($(".selected",list).removeClass("selected"),$(".dd_icon",list).remove(),item.prepend(icon).addClass("selected"),selected_index=item_index,label.html(item.text()),scroll_position=list.scrollTop()+item.position().top-1,original[0].selectedIndex=selected_index,original.change())}function checkDirection(){var _window=$(window),boundary_top=_window.scrollTop(),boundary_bottom=boundary_top+_window.height(),module_top=module.offset().top,module_bottom=module_top+module.height();is_open||module_bottom<=boundary_bottom&&boundary_top<=module_top&&("up"==settings.direction?module_top-open_height<boundary_top?module.removeClass("dd_up"):module.addClass("dd_up"):boundary_bottom<module_bottom+open_height?module.addClass("dd_up"):module.removeClass("dd_up"))}function scrollTo(event){if(0==$(":focus").length&&65<=event.keyCode&&event.keyCode<=90){var limit=list[0].scrollHeight-list.height(),adjust=0,offset=0;$("li",list).each(function(){var code=$(this).text().charCodeAt(0);if(""==$(this).attr("data-val"))adjust=$(this).outerHeight(),offset+=adjust;else{if(code==event.keyCode)return!1;if(code>event.keyCode)return offset-=adjust,!1;adjust=$(this).outerHeight(),offset+=adjust}});offset=Math.min(offset,limit);var change=Math.abs(list.scrollTop()-offset),duration=300+5*Math.round(change/30);scroll_position=offset,list.stop().animate({scrollTop:scroll_position},duration,"easeOutCubic")}}original=$(this),function(){is_open=!1,module=$('<div class="'+settings.classname+' open"><div class="dd_button"><span class="dd_label"></span><span class="dd_icon"></span></div><div class="dd_options"><div class="dd_area"><ul></ul></div></div></div>'),button=$(".dd_button",module),label=$(".dd_label",module),options=$(".dd_options",module),area=$(".dd_area",options),list=$("ul",area),icon=$('<span class="dd_icon"></span>'),original.after(module).hide(),settings.size&&module.addClass("dd_"+settings.size),settings.direction&&module.addClass("dd_"+settings.direction),settings.theme&&module.addClass("dd_"+settings.theme),module.width(0<settings.width?settings.width:original.outerWidth());var scroll_tally=0;$("option",original).each(function(i){var item=$("<li>"+$(this).text()+"</li>").attr("data-val",$(this).val()).appendTo(list);$(this).is(":selected")&&(item.append(icon).addClass("selected"),label.html($(this).text()),scroll_position=scroll_tally,selected_index=i),scroll_tally+=item.outerHeight()}),open_height=options.height(),module.on("open",open).on("close",close),button.on("click",toggleState),list.on("mousewheel",onMousewheel).on("click",onListClick),$(window).on("scroll",checkDirection),original.on("change",function(){var item_index=$("option:selected",this).index();selectItem(list.find("li").eq(item_index))}),module.removeClass("open"),checkDirection()}()}),this}}(jQuery);var UserData=function(){var user_id,INSTANCE={},URL_PROFILE="/auth/user_profile",support_sessionstorage=!1,support_localstorage=!1,synced_cart=[],cart_updated=!1,purchased=[],galleries=[],following=[];function getProfile(){$.get(URL_PROFILE).done(function(response){response?setProfile(response):logIssue()}).fail(logIssue)}function logIssue(){try{$.get("/api/purchases/setup",function(response){VectorStock.track("send","event","Error (JS)","CustomError: JSON Profile","User ID: "+response.user_id)})}catch(e){}}function setProfile(data){data&&data.id&&(user_id=data.id,INSTANCE.checkCart(data.cart_update,data.cart_hash),purchased=data.purchased||[],galleries=formatGalleryContents(data.galleries||[]),following=data.following||[],save())}function save(type){try{support_sessionstorage&&JSON&&JSON.stringify&&(type&&"id"!=type||(sessionStorage.sid=JSON.stringify(user_id)),type&&"purchased"!=type||(sessionStorage.purchased=JSON.stringify(purchased)),type&&"galleries"!=type||(sessionStorage.galleries=JSON.stringify(galleries)),type&&"following"!=type||(sessionStorage.following=JSON.stringify(following)))}catch(e){}try{support_localstorage&&JSON&&JSON.stringify&&(type&&"synced_cart"!=type||(localStorage.synced_cart=JSON.stringify(synced_cart)))}catch(e){}}function getGalleryIndexByID(gallery_id){for(var i=0;i<galleries.length;i++)if(galleries[i].id==gallery_id)return i;return null}function emptyGallery(gallery_id){var gallery_index=getGalleryIndexByID(gallery_id);galleries[gallery_index].contents=[]}function formatGalleryContents(galleries){if(!galleries||!galleries.length)return galleries;for(var i=0;i<galleries.length;i++)if(galleries[i].contents.length){for(var contents=[],j=0;j<galleries[i].contents.length;j++)galleries[i].contents[j]&&(galleries[i].contents[j].id?contents.push(galleries[i].contents[j].id):isNaN(galleries[i].contents[j])||contents.push(galleries[i].contents[j]));galleries[i].contents=contents}return galleries}function purge(){support_sessionstorage&&(sessionStorage.removeItem("sid"),sessionStorage.removeItem("cart"),sessionStorage.removeItem("purchased"),sessionStorage.removeItem("galleries"),sessionStorage.removeItem("following")),support_localstorage&&localStorage.removeItem("synced_cart"),INSTANCE.setSyncedCart([],md5(JSON.stringify([])))}return INSTANCE.destroy=purge,INSTANCE.refresh=getProfile,INSTANCE.setProfile=setProfile,INSTANCE.isInCart=function(vector_id){if(vector_id=parseInt(vector_id),synced_cart.length)for(var i=0;i<synced_cart.length;i++)if(synced_cart[i].id&&synced_cart[i].id===vector_id)return!0;return!1},INSTANCE.addToSyncedCart=function(vector_id,license,replace){replace=void 0===replace||replace;for(var i=0;i<synced_cart.length;i++)if(synced_cart[i].id&&synced_cart[i].id===vector_id)return replace?(synced_cart.splice(i,1),synced_cart.push({id:vector_id,license:license})):synced_cart[i]={id:vector_id,license:license},save("synced_cart"),synced_cart.length;return synced_cart.push({id:vector_id,license:license}),save("synced_cart"),synced_cart.length},INSTANCE.removeFromSyncedCart=function(vector_id){for(var i=0;i<synced_cart.length;i++)if(synced_cart[i].id&&synced_cart[i].id===vector_id){synced_cart.splice(i,1),save("synced_cart");break}return synced_cart.length},INSTANCE.emptySyncedCart=function(){synced_cart=[],save("synced_cart")},INSTANCE.getSyncedCart=function(){return synced_cart},INSTANCE.checkCart=function(cart_update,server_hash){support_localstorage&&(cart_update&&server_hash&&md5(JSON.stringify(synced_cart))!==server_hash&&INSTANCE.setSyncedCart(cart_update,server_hash))},INSTANCE.setSyncedCart=function(cart_update,cart_hash){support_localstorage&&cart_update&&cart_hash&&($("meta[name=cart-hash]").attr("content",cart_hash),synced_cart=cart_update,save("synced_cart"),VectorStock.setCartTally(VectorStock.userData.reloadSyncedCart()))},INSTANCE.isCartSynced=function(){return!support_localstorage||$("meta[name=cart-hash]").attr("content")===md5(JSON.stringify(synced_cart))},INSTANCE.hasCartUpdated=function(){return cart_updated},INSTANCE.markCartUpdated=function(){cart_updated=!0},INSTANCE.reloadSyncedCart=function(){if(support_localstorage&&void 0!==localStorage.synced_cart){if(synced_cart=JSON.parse(localStorage.synced_cart)||synced_cart,synced_cart=$.isArray(synced_cart)?synced_cart:[],VectorStock.search_results&&VectorStock.search_results.syncCartButtons(),VectorStock.cart_page&&(VectorStock.cart_page.header.empty(),VectorStock.cart_page.page.attr("data-payment",""),VectorStock.cart_page.table.empty(),VectorStock.cart_page.footer.empty(),VectorStock.cart_page.table.reloadCartPage(synced_cart.length)),VectorStock.gallery_table&&VectorStock.gallery_table.syncCartButtons(),VectorStock.history_table&&VectorStock.history_table.syncCartButtons(),VectorStock.following_images&&VectorStock.following_images.syncCartButtons(),VectorStock.topic_tabs)for(var tab_id in VectorStock.topic_tabs)VectorStock.topic_tabs[tab_id].syncCartButtons();return VectorStock.syncCartButton&&VectorStock.syncCartButton(),synced_cart.length}return 0},INSTANCE.hasPurchased=function(vector_id){return vector_id=parseInt(vector_id),!!(purchased&&purchased.indexOf&&-1<purchased.indexOf(vector_id))},INSTANCE.addPurchase=function(vector_ids){vector_ids instanceof Array==0&&(vector_ids=[vector_ids]);for(var i=vector_ids.length;i--;){var vector_id=parseInt(vector_ids[i]);INSTANCE.hasPurchased(vector_id)||purchased.push(vector_id)}save("purchased")},INSTANCE.isInGallery=function(vector_id,gallery_id){vector_id=parseInt(vector_id);var gallery_index=getGalleryIndexByID(gallery_id=parseInt(gallery_id));return!!(galleries[gallery_index]&&0<=galleries[gallery_index].contents.indexOf(vector_id))},INSTANCE.createGallery=function(gallery_id,gallery_name){gallery_id=parseInt(gallery_id),galleries.unshift({id:gallery_id,name:gallery_name,contents:[]}),save("galleries")},INSTANCE.renameGallery=function(gallery_id,gallery_name){var gallery_index=getGalleryIndexByID(parseInt(gallery_id));galleries[gallery_index].name=gallery_name,save("galleries")},INSTANCE.addToGallery=function(vector_id,gallery_id){vector_id=parseInt(vector_id),gallery_id=parseInt(gallery_id);var gallery_index=getGalleryIndexByID(parseInt(gallery_id));galleries[gallery_index]?(galleries[gallery_index].contents.push(vector_id),save("galleries")):getProfile()},INSTANCE.removeFromGallery=function(vector_id,gallery_id){vector_id=parseInt(vector_id),gallery_id=parseInt(gallery_id);var gallery_index=getGalleryIndexByID(parseInt(gallery_id));if(galleries[gallery_index]){var vector_index=galleries[gallery_index].contents.indexOf(vector_id);-1<vector_index&&galleries[gallery_index].contents.splice(vector_index,1)}save("galleries")},INSTANCE.emptyGallery=function(gallery_id){emptyGallery(parseInt(gallery_id)),save("galleries")},INSTANCE.deleteGallery=function(gallery_id){emptyGallery(gallery_id=parseInt(gallery_id));var gallery_index=getGalleryIndexByID(gallery_id);gallery_index&&galleries.splice(gallery_index,1),save("galleries")},INSTANCE.isFollowing=function(artist_id){return!!(following&&following.indexOf&&-1<following.indexOf(artist_id))},INSTANCE.followArtist=function(artist_id){-1===following.indexOf(artist_id)&&(following.push(artist_id),save("following"))},INSTANCE.unfollowArtist=function(artist_id){var index=following.indexOf(artist_id);-1<index&&(following.splice(index,1),save("following"))},INSTANCE.isArtist=function(artist_id){return artist_id=parseInt(artist_id),user_id&&artist_id&&user_id===artist_id},function(){try{sessionStorage.setItem("vs_sessionstorage_test","vs_sessionstorage_test"),sessionStorage.removeItem("vs_sessionstorage_test"),support_sessionstorage=!0}catch(e){}try{localStorage.setItem("vs_localstorage_test","vs_localstorage_test"),localStorage.removeItem("vs_localstorage_test"),support_localstorage=!0}catch(e){}support_sessionstorage&&("undefined"==sessionStorage.sid&&sessionStorage.removeItem("sid"),void 0!==sessionStorage.sid&&void 0!==sessionStorage.purchased?(user_id=JSON.parse(sessionStorage.sid),purchased=JSON.parse(sessionStorage.purchased)||purchased,galleries=sessionStorage.galleries&&JSON.parse(sessionStorage.galleries)||galleries,following=sessionStorage.following&&JSON.parse(sessionStorage.following)||following,void 0===(galleries=formatGalleryContents(galleries)).length&&(purge(),getProfile())):VectorStock.isLoggedIn()&&getProfile()),support_localstorage&&void 0!==localStorage.synced_cart&&(synced_cart=JSON.parse(localStorage.synced_cart)||synced_cart,synced_cart=$.isArray(synced_cart)?synced_cart:[])}(),INSTANCE},MenuMobile=function(){var INSTANCE=new VSModule,icon=$("#mobilenav-icon"),menu=$("#mobilenav-menu"),logout=$("li.logout a",menu),is_open=(VectorStock.isMobile(),!1),int_closing=!1;function open(){is_open||(clearInterval(int_closing),menu.removeClass("close"),icon.addClass("open"),menu.addClass("open"),updateHeight(),$(window).on("resize",updateHeight),$(document).on("click",clickOutside),is_open=!0)}function close(){is_open&&(icon.removeClass("open"),menu.addClass("close"),int_closing=setTimeout(function(){menu.removeClass("open close"),menu.css({height:""})},750),$(document).off("click",clickOutside),is_open=!1)}function clickOutside(event){$(event.target).closest(menu).length||close()}function updateHeight(){var offset=$("body > header nav.top").outerHeight(),page=$(document).height();menu.css({height:page-offset})}return INSTANCE.open=open,INSTANCE.close=close,$('li[data-action="login"] a').on("click",function(){if(window.SignupBox)return new SignupBox({screen:"login"}),!1}),icon.on("click",function(event){is_open?close():open(),event.stopPropagation(),event.preventDefault()}),logout.on("click",function(){return VectorStock.userData.destroy(),$("form.logout",menu).submit(),!1}),INSTANCE};!function($){$.fn.filestyle=function(options){var settings={width:250};return options&&$.extend(settings,options),this.each(function(){var self=this,wrapper=$("<div>").css({width:settings.imagewidth+"px",height:settings.imageheight+"px",background:"url("+settings.image+") 0 0 no-repeat","background-position":"right",display:"inline",position:"absolute",overflow:"hidden"}),filename=$('<input class="file">').addClass($(self).attr("class")).css({display:"inline",width:settings.width+"px"});$(self).before(filename),$(self).wrap(wrapper),$(self).css({position:"relative",height:settings.imageheight+"px",width:settings.width+"px",display:"inline",cursor:"pointer",opacity:"0.0"}),$.browser.mozilla?/Win/.test(navigator.platform)?$(self).css("margin-left","-142px"):$(self).css("margin-left","-168px"):$(self).css("margin-left",settings.imagewidth-settings.width+"px"),$(self).bind("change",function(){filename.val($(self).val())})})}}(jQuery),function($){$.fn.popout=function(customSettings){$.fn.popout.defaultSettings={className:"popout",align:"left"};var settings=$.extend({},$.fn.popout.defaultSettings,customSettings);return this.each(function(){var isOpen,instance,button,panel;function open(){isOpen||($("."+settings.className).each(function(){$(this)[0]!==instance[0]&&$(this).trigger("close")}),$(document).on("mousedown",mouseDown),instance.addClass("open"),$(".po_content",panel).hide().slideDown(100,"easeOutExpo"),isOpen=!0)}function mouseDown(event){0===$(event.target).parents("."+settings.className).length&&instance.trigger("close")}function close(){isOpen&&($(document).off("mousedown",mouseDown),instance.removeClass("open"),isOpen=!1)}instance=$(this),isOpen=instance.hasClass("open"),button=$("a:first",instance).wrapInner('<span class="po_icon"></span>'),$("div:first",instance).wrap('<div class="po_panel"><div class="po_content"></div></div>'),panel=$(".po_panel",instance),instance.hasClass(settings.className)||instance.addClass(settings.className),"right"==settings.align?instance.addClass("alignr"):"center"==settings.align&&instance.addClass("alignc"),button.on("click",function(){return isOpen?instance.trigger("close"):instance.trigger("open"),!1}),instance.on("open",open),instance.on("close",close),isOpen&&$(document).on("mousedown",mouseDown),instance.addClass("ready")}),this}}(jQuery),function($){$.fn.mpopout=function(settings_custom){var CLASSNAME="mpopout";$.fn.mpopout.settings_default={align:"left"};var settings=$.extend({},$.fn.popout.settings_default,settings_custom);return this.each(function(){var is_open,instance,link_toggle;function open(){is_open||($("."+CLASSNAME).each(function(){$(this)[0]!==instance[0]&&$(this).trigger("close")}),$(document).on("mousedown",mouseDown),instance.addClass("open"),is_open=!0)}function mouseDown(event){0===$(event.target).parents("."+CLASSNAME).length&&instance.trigger("close")}function close(){is_open&&($(document).off("mousedown",mouseDown),instance.removeClass("open"),is_open=!1)}instance=$(this),function(){is_open=instance.hasClass("open");var display=$(".mpo_display",instance);$("a:eq(0)",display).addClass("instant").wrapInner('<span class="mpo_icon_instant" />'),link_toggle=$("a:eq(1)",display).addClass("toggle").wrapInner('<span class="mpo_icon_toggle" />'),$(".mpo_panel",instance).wrapInner('<div class="mpo_content"></div>'),instance.hasClass(CLASSNAME)||instance.addClass(CLASSNAME),"right"==settings.align?instance.addClass("alignr"):"center"==settings.align&&instance.addClass("alignc"),link_toggle.on("click",function(){return is_open?instance.trigger("close"):instance.trigger("open"),!1}),instance.on("open",open),instance.on("close",close),is_open&&$(document).on("mousedown",mouseDown),instance.addClass("ready")}()}),this}}(jQuery);var PreviewLink=function(element,vector_id,vector_title,is_pending){var src_thumb,src_preview,timeout_hover,pane,stem,area,grid,img,INSTANCE=VSModule(),SIZE_WIDE=237,SIZE_HIGH=250,TIME_HOVER=2e3,axis="horizontal",is_enabled=!0,is_text_only=!1,has_hovered=!1,src_cache={};function showPreviewPane(event){if(is_enabled){if($("#previewpane").remove(),element.attr("title",""),$("img",element).attr("title",""),element.parent().addClass("hover"),pane=$('<div id="previewpane"><span class="pp_title">'+vector_title+"</span></div>"),area=$("<div></div>").addClass("pp_imagearea"),stem=$("<div></div>"),pane.prepend(area).prepend(stem),img=new Image,src_cache[vector_id]||is_text_only)$(img).attr("src",src_preview).addClass("pp_preview").appendTo(area);else{var errors=0,errorCheck=function(event){$(event.target).remove().attr("src")==src_preview&&grid.fadeOut(200,"easeOutSine"),1<++errors&&$('<div class="pp_error"><p>Preview image could not be loaded...</p></div>').appendTo(area).hide().fadeIn(500)};grid=$('<div class="pp_grid"></div>').css("width",SIZE_WIDE),area.append(grid).append($('<img src="'+src_thumb+'" width="'+SIZE_WIDE+'" height="'+SIZE_HIGH+'" />').error(errorCheck)).css("width",SIZE_WIDE),$(img).load(function(){var scope=$(this).addClass("pp_preview").appendTo(area).addClass("hide");setTimeout(function(){scope.addClass("show")},10),src_cache[vector_id]=!0}).error(errorCheck).attr("src",src_preview)}pane.appendTo("body").hide().fadeIn(200,"easeOutSine");var pane_width=SIZE_WIDE+parseFloat(area.css("marginLeft"))+parseFloat(area.css("marginRight")),pane_height=pane.outerHeight();if(pane.css("width",pane_width),"vertical"===axis){event.pageY<$(window).height()/2?(buffer_top=60,stem.addClass("pp_stemtop")):(buffer_top=0-(pane_height+60),stem.addClass("pp_stembottom"));var box_space_left=event.pageX-$(event.target).offset().left,box_space_right=$(event.target).width()-box_space_left,offset_x=Math.ceil(pane_width/2);buffer_left=0-offset_x;var win_space_left=event.pageX-(offset_x+box_space_left+5);win_space_left<0&&(buffer_left=Math.abs(win_space_left)-offset_x);var win_space_right=$(window).width()-(event.pageX+offset_x+box_space_right+5);win_space_right<0&&(buffer_left=0-offset_x-Math.abs(win_space_right));var stem_left=Math.abs(buffer_left)-12;SIZE_WIDE<stem_left&&(stem_left=SIZE_WIDE),stem.css({left:stem_left})}else{event.pageX<$(window).width()/2?(buffer_left=60,stem.addClass("pp_stemleft")):(buffer_left=0-(pane_width+60),stem.addClass("pp_stemright"));var mouse_y=event.pageY-$(window).scrollTop(),perc_y=mouse_y/$(window).height();mouse_y<130?perc_y=0:mouse_y>$(window).height()-130&&(perc_y=1),buffer_top=0-Math.floor(perc_y*(pane.height()-55))-20,stem.css({top:Math.abs(buffer_top)-7})}element.on("mousemove",followMouseCursor),followMouseCursor(event),has_hovered||(timeout_hover=setTimeout(function(){has_hovered=!0,INSTANCE.dispatchEvent("hover"),timeout_hover=null},TIME_HOVER))}}function hidePreviewPane(event){element.attr("title",vector_title),$("img",element).attr("title",vector_title),element.parent().removeClass("hover"),pane&&pane.remove(),element.off("mousemove",followMouseCursor),timeout_hover&&clearTimeout(timeout_hover)}function followMouseCursor(event){pane.css("left",event.pageX+buffer_left).css("top",event.pageY+buffer_top)}return INSTANCE.disable=function(){is_enabled=!1},INSTANCE.enable=function(){is_enabled=!0},vector_title=vector_title||"",is_text_only=!$("img",element).length,src_thumb=VectorStock.imagePath(vector_id,vector_title,"small",is_pending),src_preview=VectorStock.imagePath(vector_id,vector_title,"medium",is_pending),element.on("mouseenter",showPreviewPane).on("mouseleave click",hidePreviewPane),INSTANCE};$(function(){var QUESTIONNAIRE_ANSWERS={A:"A. Adobe Illustrator",B:"B. CorelDRAW",C:"C. Something else"},questionnaire=$("#vs_questionnaire");if(questionnaire.length){try{if(void 0!==localStorage.vs_questionnaire_hide)return void questionnaire.remove()}catch(e){}var has_answered=!1,but_close=$('button[data-action="close"]',questionnaire),radio_options=new VectorStock.FieldRadioboxes($('.body ul[role="radiogroup"] li label',questionnaire)),but_submit=$('button[data-action="submit"]',questionnaire);but_close.on("click",function(){EventTracker.store("vs_questionnaire_hide",1),questionnaire.addClass("closed"),has_answered||VectorStock.track("send","event","Questionnaire Response","Not answered")}),radio_options.on("change",function(value){but_submit.prop("disabled",!1)}),but_submit.on("click",function(){has_answered=!0;var data_packet={answer:radio_options.value};$.post("/api/poll/answer",data_packet,function(){VectorStock.track("send","event","Questionnaire Response",QUESTIONNAIRE_ANSWERS[data_packet.answer]);try{localStorage.vs_questionnaire_hide=1}catch(e){}}),questionnaire.addClass("submitted")}),setTimeout(function(){questionnaire.addClass("revealed")},2e3)}});var EventTrackerLogger=function(tracking_id,tracking_url,settings){var timeout_process,INSTANCE=new VSModule,TIME_DELAY_PROCESSING=1e4,MAX_EVENTS_SEND=800,memory_events=[];function getLocalStorageEvents(){try{return JSON.parse(localStorage[tracking_id])}catch(e){return[]}}function getCookieEvents(){var cookie_value=EventTrackerLogger.getCookie(tracking_id);if(void 0!==cookie_value)try{return JSON.parse(cookie_value)}catch(e){return[]}return[]}function storeEvent(event){if(settings.localstorage||settings.cookies){var stored_events_arr=settings.localstorage?getLocalStorageEvents():settings.cookies?getCookieEvents():memory_events;stored_events_arr.push(event);var stored_events_str=JSON.stringify(stored_events_arr);settings.localstorage?localStorage[tracking_id]=stored_events_str:settings.cookies&&(document.cookie=tracking_id+"="+stored_events_str+"; path=/")}else memory_events.push(event);timeout_process||(timeout_process=setTimeout(processStoredEvents,TIME_DELAY_PROCESSING))}function sendToServer(events){return $.ajax({url:tracking_url,method:"POST",data:{events:events,timestamp:Math.round((new Date).getTime()/1e3)}})}function processStoredEvents(){var stored_events,extra_events,on_success;(settings.localstorage?(stored_events=getLocalStorageEvents()).length>MAX_EVENTS_SEND?(extra_events=stored_events.splice(MAX_EVENTS_SEND),on_success=function(){localStorage[tracking_id]=JSON.stringify(extra_events),timeout_process||(timeout_process=setTimeout(processStoredEvents,TIME_DELAY_PROCESSING))}):on_success=function(){localStorage.removeItem(tracking_id)}:settings.cookies?(stored_events=getCookieEvents()).length>MAX_EVENTS_SEND?(extra_events=stored_events.splice(MAX_EVENTS_SEND),on_success=function(){document.cookie=tracking_id+"="+JSON.stringify(extra_events)+"; path=/",timeout_process||(timeout_process=setTimeout(processStoredEvents,TIME_DELAY_PROCESSING))}):on_success=function(){document.cookie=tracking_id+"=[]; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/"}:(stored_events=memory_events).length>MAX_EVENTS_SEND?(extra_events=stored_events.splice(MAX_EVENTS_SEND),on_success=function(){memory_events=extra_events,timeout_process||(timeout_process=setTimeout(processStoredEvents,TIME_DELAY_PROCESSING))}):on_success=function(){memory_events=[]},stored_events&&stored_events.length)&&sendToServer(stored_events).success(on_success);timeout_process&&(timeout_process=null)}return INSTANCE.track=function(event_data,process_later){process_later?storeEvent(event_data):sendToServer([event_data])},processStoredEvents(),INSTANCE};EventTrackerLogger.ID_SEARCH="vs_events",EventTrackerLogger.ID_LOG="vs_log",EventTrackerLogger.getCookie=function(cookie_id){for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var cookie_parts=cookies[i].split("="),cookie_key=cookie_parts.shift(),cookie_value=cookie_parts.join("=");if(cookie_key===cookie_id)return cookie_value}};var EventTracker=function(){var track_search,track_log,INSTANCE=new VSModule,tracking_enabled=!0,support_localstorage=!1,support_sessionstorage=!1,support_cookies=!1;return INSTANCE.track=function(id_tracker,event_data,process_later){if(tracking_enabled&&("string"!=typeof id_tracker&&(process_later=event_data,event_data=id_tracker,id_tracker=EventTrackerLogger.ID_SEARCH),event_data))if(id_tracker===EventTrackerLogger.ID_SEARCH){if(!event_data.action)return;event_data.timestamp||(event_data.timestamp=Math.round((new Date).getTime()/1e3));for(var event_arr=[event_data.action,event_data.image||"",event_data.search||"",event_data.timestamp,event_data.search_scope||null,event_data.search_artist||null,event_data.search_category||null];null==event_arr[event_arr.length-1];)event_arr.pop();track_search.track(event_arr,process_later)}else id_tracker===EventTrackerLogger.ID_LOG&&track_log.track(event_data,process_later)},INSTANCE.store=function(event_id,event_value,event_is_session){tracking_enabled&&(support_localstorage&&support_sessionstorage?event_is_session?sessionStorage[event_id]=event_value:localStorage[event_id]=event_value:document.cookie=event_id+"="+event_value+"; path=/")},INSTANCE.retrieve=function(event_id,event_is_session){if(tracking_enabled){if(support_localstorage&&support_sessionstorage){if(event_is_session&&void 0!==sessionStorage[event_id]){var event_value=sessionStorage[event_id];return sessionStorage.removeItem(event_id),event_value}if(void 0!==localStorage[event_id]){event_value=localStorage[event_id];return localStorage.removeItem(event_id),event_value}}if(support_cookies)if(void 0!==(event_value=EventTrackerLogger.getCookie(event_id)))return document.cookie=event_id+"=0; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/",event_value}},function(){try{localStorage.setItem("vs_localstorage_test","vs_localstorage_test"),localStorage.removeItem("vs_localstorage_test"),support_localstorage=!0,sessionStorage.setItem("vs_sessionstorage_test","vs_sessionstorage_test"),sessionStorage.removeItem("vs_sessionstorage_test"),support_sessionstorage=!0}catch(e){}if(!(support_cookies=navigator.cookieEnabled))try{document.cookie="vs_cookies_test=1",support_cookies=-1!==document.cookie.indexOf("vs_cookies_test="),document.cookie="vs_cookies_test=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"}catch(e){}if(1==$('head meta[name="dev-env"]').attr("content")&&(tracking_enabled=!1),tracking_enabled=!0){var settings={localstorage:support_localstorage,sessionstorage:support_sessionstorage,cookies:support_cookies};track_search=new EventTrackerLogger(EventTrackerLogger.ID_SEARCH,"/api/tracking",settings),track_log=new EventTrackerLogger(EventTrackerLogger.ID_LOG,"/api/log/events",settings)}}(),INSTANCE}();VectorStock.FieldInput=function(input,format){var mod_fset,err_message,regex_alphanumeric,INSTANCE=new VSModule;function onFocus(){INSTANCE.dispatchEvent("focus")}function onBlur(){INSTANCE.dispatchEvent("blur")}function onUpdate(event){13==event.keyCode&&INSTANCE.dispatchEvent("return",INSTANCE.value),setTimeout(function(){var value=input.val();value!==INSTANCE.value&&(mod_fset.toggleClass("filled",""!==value),INSTANCE.value=value,INSTANCE.dispatchEvent("change",INSTANCE.value))},10)}function onChange(){var value=input.val();INSTANCE.value!==value&&(INSTANCE.value=input.val(),INSTANCE.dispatchEvent("change",INSTANCE.value))}function onAnimationStart(event){event&&event.originalEvent&&event.originalEvent.animationName&&"onAutoFillStart"==event.originalEvent.animationName&&onChange()}return INSTANCE.input=input,INSTANCE.name=input.attr("name"),INSTANCE.value=input.val(),INSTANCE.minlength=input.attr("minlength")?parseInt(input.attr("minlength")):null,INSTANCE.maxlength=input.attr("maxlength")?parseInt(input.attr("maxlength")):null,INSTANCE.disabled=input.prop("disabled"),INSTANCE.disable=function(){return mod_fset.addClass("disabled"),input.prop("disabled",!0),INSTANCE.disabled=!0,INSTANCE},INSTANCE.enable=function(){return mod_fset.removeClass("disabled"),input.prop("disabled",!1),INSTANCE.disabled=!1,INSTANCE},INSTANCE.focus=function(){return input.focus(),INSTANCE},INSTANCE.select=function(){return input.select(),INSTANCE},INSTANCE.blur=function(){return input.blur(),INSTANCE},INSTANCE.showError=function(message){if(err_message)$(".explanation p",err_message).html(message);else{var icon,wrap;function showError(){err_message.addClass("show"),icon.off("touchstart",showError),$("body").on("touchstart",hideError)}function hideError(){err_message.removeClass("show"),icon.on("touchstart",showError),$("body").off("touchstart",hideError)}mod_fset.addClass("error"),err_message=$('<div class="message" />').appendTo(mod_fset),icon=$('<div class="icon" />').appendTo(err_message),wrap=$('<div class="explanation" />').appendTo(err_message),$("<p />").html(message).appendTo(wrap),icon.on("touchstart",showError)}return INSTANCE},INSTANCE.clearError=function(){if(err_message)return mod_fset.removeClass("error"),err_message.remove(),err_message=null,INSTANCE},INSTANCE.hasError=function(){return!!err_message},INSTANCE.setValue=function(value,suppress_event){return(value=value||"")==INSTANCE.value||(mod_fset.toggleClass("filled",""!==value),input.val(value),INSTANCE.value=value,suppress_event||INSTANCE.dispatchEvent("change",INSTANCE.value)),INSTANCE},mod_fset=input.closest("fieldset"),input.on("focus",onFocus),input.on("blur",onBlur),input.on("keydown cut paste",onUpdate),input.on("change input",onChange),input.on("animationstart",onAnimationStart),format&&format==VectorStock.FieldInput.FORMAT_ALPHANUMERIC&&(regex_alphanumeric=/[^a-zA-Z\d\- ]/g,input.on("keypress",function(event){if(event.metaKey||event.ctrlKey)return!0;if(0==event.which)return!0;if(event.which<33)return!0;var character=String.fromCharCode(event.which);return!regex_alphanumeric.test(character)}),input.on("paste change input",function(event){setTimeout(function(){var value_original=input.val(),value_stripped=value_original;(value_stripped=(value_stripped=(value_stripped=value_stripped.replace(regex_alphanumeric,"")).replace(/\-+/g,"-")).replace(/\s+/g," "))!==value_original&&input.val(value_stripped)})})),INSTANCE},VectorStock.FieldInput.FORMAT_ALPHANUMERIC="alphanumeric",VectorStock.FieldCheckbox=function(input){var container,label,err_message,INSTANCE=new VSModule;function onChange(prevent_bubbling){INSTANCE.checked=input.is(":checked"),label.toggleClass("checked",INSTANCE.checked),prevent_bubbling||INSTANCE.dispatchEvent("change",INSTANCE.checked)}return INSTANCE.input=input,INSTANCE.name=input.attr("name"),INSTANCE.checked=input.is(":checked"),INSTANCE.disabled=input.prop("disabled"),INSTANCE.value=input.val(),INSTANCE.toggle=function(checked,prevent_bubbling){checked=null==checked?!INSTANCE.checked:checked,input.prop("checked",checked),onChange(prevent_bubbling)},INSTANCE.disable=function(){label.addClass("disabled"),input.prop("disabled",!0),INSTANCE.disabled=!0},INSTANCE.enable=function(){label.removeClass("disabled"),input.prop("disabled",!1),INSTANCE.disabled=!1},INSTANCE.toggleDisabled=function(is_disabled){is_disabled!==INSTANCE.disabled&&(is_disabled?INSTANCE.disable():INSTANCE.enable())},INSTANCE.showError=function(message){if(!err_message){var wrap;container.addClass("error"),err_message=$('<div class="message" />').appendTo(container),wrap=$('<div class="explanation" />').appendTo(err_message),$("<p />").html(message).appendTo(wrap);var clearError=function(){container.removeClass("error"),err_message.remove(),err_message=null,INSTANCE.off("change",clearError)};INSTANCE.on("change",clearError)}},INSTANCE.hasError=function(){return!!err_message},label=input.closest("label"),container=label.parent(),input.on("change",function(){onChange()}),INSTANCE},VectorStock.FieldRadioboxes=function(items){var container,INSTANCE=new VSModule;function selectItem(item,suppress_bubbling){var input=$('input[type="radio"]',item);input.is(":checked")||input.prop("checked",!0),INSTANCE.value=input.val(),INSTANCE.selected=input,items.removeClass("checked"),item.addClass("checked"),suppress_bubbling||INSTANCE.dispatchEvent("change",INSTANCE.value)}return INSTANCE.value=null,INSTANCE.disabled=$('input[type="radio"]',items).prop("disabled"),INSTANCE.selected=null,INSTANCE.disable=function(){container.addClass("disabled"),$('input[type="radio"]',items).prop("disabled",!0),INSTANCE.disabled=!0},INSTANCE.enable=function(){container.removeClass("disabled"),$('input[type="radio"]',items).prop("disabled",!1),INSTANCE.disabled=!1},INSTANCE.set=function(value,suppress_bubbling){var input=$('input[value="'+value+'"]',items),listitem=input.closest("li"),label=input.closest("label");listitem.length?selectItem(listitem,suppress_bubbling):label.length&&selectItem(label,suppress_bubbling)},INSTANCE.removeItem=function(value){var item=$('input[value="'+value+'"]',items).closest("li"),is_checked=item.hasClass("checked");item.length&&(item.remove(),items=$(items.selector),is_checked&&selectItem(items.first()))},INSTANCE.getItems=function(){return $.makeArray(items)},container=items.parent(),items.each(function(){var item=$(this),input=$('input[type="radio"]',item);input.is(":checked")?(INSTANCE.value=input.val(),INSTANCE.selected=input,item.addClass("checked")):item.removeClass("checked"),item.on("mouseup",function(){$(this).hasClass("checked")&&INSTANCE.dispatchEvent("click")}),input.on("change",function(){selectItem(item)})}),INSTANCE},VectorStock.FieldButton=function(button){var label,icon_area,load_icon,label_default,INSTANCE=new VSModule;function onClick(event){INSTANCE.dispatchEvent("click",event)}return INSTANCE.disabled=button.prop("disabled"),INSTANCE.disable=function(){button.prop("disabled",!0),INSTANCE.disabled=!0},INSTANCE.enable=function(){button.prop("disabled",!1),INSTANCE.disabled=!1},INSTANCE.setLoading=function(message,is_light){var shade=is_light?"light":"";button.addClass("loading").prop("disabled",!0),label.html(message),load_icon=icon_area.loadingIcon("medium",shade),INSTANCE.disabled=!0},INSTANCE.setLabel=function(value){label.html(value)},INSTANCE.revert=function(){button.removeClass("loading").prop("disabled",!1),label.html(label_default),load_icon&&load_icon.remove(),INSTANCE.disabled=!1},label=$(".label",button),icon_area=$(".icon span",button),label_default=label.html(),button.on("click",onClick),INSTANCE};var ScreenSelect=function(container,is_contributor){var but_email,but_google,but_facebook,but_close,link_login,INSTANCE=new VSModule;function switchToSignup(event){INSTANCE.hide(),INSTANCE.dispatchEvent("screen_signup"),event.preventDefault()}function switchToLogin(event){INSTANCE.hide(),INSTANCE.dispatchEvent("screen_login"),event.preventDefault()}function signupWithGoogle(){but_google.setLoading("Connecting",!0),but_close.hide(),INSTANCE.dispatchEvent("processing"),$.get("/api/google/auth",is_contributor?{contributer:1}:null,function(response){but_google.revert(),but_close.show(),INSTANCE.dispatchEvent("response"),1==response.success&&VectorStock.goToURL(response.url)})}function signupWithFacebook(){but_facebook.setLoading("Connecting",!0),but_close.hide(),INSTANCE.dispatchEvent("processing"),$.get("/api/json/fblogin",is_contributor?{contributer:1}:null,function(response){but_facebook.revert(),but_close.show(),INSTANCE.dispatchEvent("response"),1==response.success&&VectorStock.goToURL(response.url)})}function close(){INSTANCE.dispatchEvent("close")}return INSTANCE.show=function(is_instant){container.show(),is_instant?container.addClass("reveal"):setTimeout(function(){container.addClass("reveal")},100)},INSTANCE.hide=function(){container.hide().removeClass("reveal")},but_email=new VectorStock.FieldButton($('button[data-method="email"]',container)),but_google=new VectorStock.FieldButton($('button[data-method="google"]',container)),but_facebook=new VectorStock.FieldButton($('button[data-method="facebook"]',container)),but_close=$("> button",container),link_login=$(".footer p a",container),but_email.on("click",switchToSignup),but_google.on("click",signupWithGoogle),but_facebook.on("click",signupWithFacebook),but_close.on("click",close),link_login.on("click",switchToLogin),INSTANCE},ScreenSignup=function(container,is_contributor){var input_firstname,input_surname,input_email,input_password,radioboxes_account,area_company,input_company,input_billing,checkbox_terms,checkbox_mailinglist,fields_validate,but_submit,but_close,link_login,INSTANCE=new VSModule,REGEX_EMAIL=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,RESPONSE_FIRSTNAME_MISSING="First name is required",RESPONSE_FIRSTNAME_MINCHARS="First name needs at least 2 characters",RESPONSE_FIRSTNAME_INVALID="First name contains invalid characters",RESPONSE_SURNAME_MISSING="Surname is required",RESPONSE_SURNAME_MINCHARS="Surname needs at least 2 characters",RESPONSE_SURNAME_INVALID="Surname contains invalid characters",RESPONSE_EMAIL_INVALID="Enter a valid email",RESPONSE_EMAIL_REGISTERED="Address has already been registered",RESPONSE_PASSWORD_LENGTH="Use between 8 and 72 characters",RESPONSE_PASSWORD_CONSECUTIVE="No more than 4 consecutive characters allowed";RESPONSE_PASSWORD_COMPROMISED="Password must not be a commonly used password",RESPONSE_TERMS_NOT_AGREED="You must agree to our Terms to Signup",RESPONSE_UNKNOWN="Hmm. Unknown error sorry! Please contact our support staff who will help you create an account.";var email_validation_delay,email_responses={},monitor_firstname=!1,monitor_surname=!1,monitor_email=!1,monitor_password=!1;function changeAccountType(type){var is_expanded=type==ScreenSignup.ACCOUNT_TYPE_COMPANY;area_company.toggle(is_expanded),setTimeout(function(){INSTANCE.dispatchEvent("expand",is_expanded)})}function validateFirstname(value){return""==(value=$.trim(value))?(input_firstname.showError(RESPONSE_FIRSTNAME_MISSING),!1):value.length<input_firstname.minlength?(input_firstname.showError(RESPONSE_FIRSTNAME_MINCHARS),!1):(input_firstname.clearError(),!0)}function validateSurname(value){return""==(value=$.trim(value))?(input_surname.showError(RESPONSE_SURNAME_MISSING),!1):value.length<input_surname.minlength?(input_surname.showError(RESPONSE_SURNAME_MINCHARS),!1):(input_surname.clearError(),!0)}function validateEmailAddress(value){var address_id=$.trim(value.toLowerCase());function showError(error){switch(error){case ScreenSignup.ERROR_EMAIL_INVALID:input_email.showError(RESPONSE_EMAIL_INVALID);break;case ScreenSignup.ERROR_EMAIL_REGISTERED:input_email.showError(RESPONSE_EMAIL_REGISTERED);break;default:alert(RESPONSE_UNKNOWN)}}address_id.match(REGEX_EMAIL)?email_responses[address_id]?email_responses[address_id].success?input_email.clearError():showError(email_responses[address_id].error):(clearTimeout(email_validation_delay),email_validation_delay=setTimeout(function(){$.get("/api/signup/email/check",{email:address_id},function(response){var address_id_current=$.trim(input_email.value.toLowerCase());address_id==address_id_current&&(response.success?input_email.clearError():showError(response.error)),email_responses[address_id]=response})},1e3)):input_email.showError(RESPONSE_EMAIL_INVALID)}function validatePassword(value){return value.length<input_password.minlength||value.length>input_password.maxlength?(input_password.showError(RESPONSE_PASSWORD_LENGTH),!1):(input_password.clearError(),!0)}function validateFields(event){event.preventDefault(),validateFirstname(input_firstname.value)||monitor_firstname||(input_firstname.on("change",validateFirstname),monitor_firstname=!0),validateSurname(input_surname.value)||monitor_surname||(input_surname.on("change",validateSurname),monitor_surname=!0),validateEmailAddress(input_email.value)||monitor_email||(input_email.on("change",validateEmailAddress),monitor_email=!0),validatePassword(input_password.value)||monitor_password||(input_password.on("change",validatePassword),monitor_password=!0),checkbox_terms.checked||checkbox_terms.showError(RESPONSE_TERMS_NOT_AGREED);for(var i=0,len=fields_validate.length;i<len;){if(fields_validate[i].hasError()){var field=fields_validate[i].name.toTitleCase();input_email.value;return VectorStock.track("send","event","Error (User)","Signup","Client: "+field),!1}i++}!function(){input_firstname.disable(),input_surname.disable(),input_email.disable(),input_password.disable(),checkbox_terms.disable(),checkbox_mailinglist.disable(),but_submit.setLoading("Processing"),but_close.hide(),INSTANCE.dispatchEvent("processing");var params={firstname:input_firstname.value,surname:input_surname.value,email:input_email.value,password:input_password.value,mailinglist:checkbox_mailinglist.checked,contributor:is_contributor?1:0,json:1};radioboxes_account.value==ScreenSignup.ACCOUNT_TYPE_COMPANY&&(params.company=input_company.value,params.address=input_billing.value);$.post("/api/signup",params,function(response){input_email.value;if(response.success)INSTANCE.dispatchEvent("signup",[response,params]);else{input_firstname.enable(),input_surname.enable(),input_email.enable(),input_password.enable(),checkbox_terms.enable(),checkbox_mailinglist.enable(),but_submit.revert(),but_close.show();var error_label=response.error?response.error.toTitleCase().split("_").join(" "):JSON.stringify(response);switch(INSTANCE.dispatchEvent("response"),response.error){case ScreenSignup.ERROR_FIRSTNAME_MISSING:monitor_firstname||(input_firstname.on("change",validateFirstname),monitor_firstname=!0),params.firstname.length>input_firstname.minlength?input_firstname.showError(RESPONSE_FIRSTNAME_INVALID):input_firstname.showError(RESPONSE_FIRSTNAME_MISSING),error_label+=" ("+params.firstname+")";break;case ScreenSignup.ERROR_SURNAME_MISSING:monitor_surname||(input_surname.on("change",validateSurname),monitor_surname=!0),params.surname.length>input_surname.minlength?input_surname.showError(RESPONSE_SURNAME_INVALID):input_surname.showError(RESPONSE_SURNAME_MISSING),error_label+=" ("+params.surname+")";break;case ScreenSignup.ERROR_EMAIL_INVALID:monitor_email||(input_email.on("change",validateEmailAddress),monitor_email=!0),input_email.showError(RESPONSE_EMAIL_INVALID),error_label+=" ("+params.email+")";break;case ScreenSignup.ERROR_EMAIL_REGISTERED:monitor_email||(input_email.on("change",validateEmailAddress),monitor_email=!0),input_email.showError(RESPONSE_EMAIL_REGISTERED);break;case ScreenSignup.ERROR_PASSWORD_LENGTH:monitor_password||(input_password.on("change",validatePassword),monitor_password=!0),input_password.showError(RESPONSE_PASSWORD_LENGTH);break;case ScreenSignup.ERROR_PASSWORD_CONSECUTIVE:monitor_password||(input_password.on("change",validatePassword),monitor_password=!0),input_password.showError(RESPONSE_PASSWORD_CONSECUTIVE);break;case ScreenSignup.ERROR_PASSWORD_COMPROMISED:monitor_password||(input_password.on("change",validatePassword),monitor_password=!0),input_password.showError(RESPONSE_PASSWORD_COMPROMISED);break;default:alert(RESPONSE_UNKNOWN)}VectorStock.track("send","event","Error (User)","Signup","Server: "+error_label)}})}()}function show(){var is_expanded=radioboxes_account.value==ScreenSignup.ACCOUNT_TYPE_COMPANY;container.addClass("reveal"),INSTANCE.dispatchEvent("expand",is_expanded),""==input_firstname.value?input_firstname.focus():""==input_surname.value?input_surname.focus():""==input_email.value?input_email.focus():""==input_password.value&&input_password.focus()}function close(){INSTANCE.dispatchEvent("close")}function switchToLogin(event){INSTANCE.hide(),INSTANCE.dispatchEvent("screen_login"),event.preventDefault()}return INSTANCE.show=function(is_instant){container.show(),is_instant?show():setTimeout(show,100)},INSTANCE.hide=function(){container.hide().removeClass("reveal")},input_firstname=new VectorStock.FieldInput($('input[name="firstname"]',container)),input_surname=new VectorStock.FieldInput($('input[name="surname"]',container)),input_email=new VectorStock.FieldInput($('input[name="email"]',container)),input_password=new VectorStock.FieldInput($('input[name="password"]',container)),radioboxes_account=new VectorStock.FieldRadioboxes($('fieldset[data-field="type"] li',container)),area_company=$('[data-area="company"]',container),input_company=new VectorStock.FieldInput($('input[name="company"]',area_company)),input_billing=new VectorStock.FieldInput($('textarea[name="billing"]',area_company)),checkbox_terms=new VectorStock.FieldCheckbox($('input[name="terms"]',container)),checkbox_mailinglist=new VectorStock.FieldCheckbox($('input[name="mailinglist"]',container)),but_submit=new VectorStock.FieldButton($('.footer button[type="submit"]',container)),but_close=$("> button",container),link_login=$(".footer p a",container),fields_validate=[input_firstname,input_surname,input_email,input_password,checkbox_terms],radioboxes_account.on("change",changeAccountType),but_submit.on("click",validateFields),but_close.on("click",close),link_login.on("click",switchToLogin),input_email.value&&validateEmailAddress(input_email.value),INSTANCE};ScreenSignup.ACCOUNT_TYPE_INDIVIDUAL="Individual",ScreenSignup.ACCOUNT_TYPE_COMPANY="Company",ScreenSignup.ERROR_FIRSTNAME_MISSING="FIRSTNAME_MISSING",ScreenSignup.ERROR_FIRSTNAME_MINCHARS="FIRSTNAME_MINCHARS",ScreenSignup.ERROR_SURNAME_MISSING="SURNAME_MISSING",ScreenSignup.ERROR_SURNAME_MINCHARS="SURNAME_MINCHARS",ScreenSignup.ERROR_EMAIL_INVALID="EMAIL_INVALID",ScreenSignup.ERROR_EMAIL_REGISTERED="EMAIL_REGISTERED",ScreenSignup.ERROR_PASSWORD_LENGTH="PASSWORD_LENGTH",ScreenSignup.ERROR_PASSWORD_CONSECUTIVE="PASSWORD_CONSECUTIVE",ScreenSignup.ERROR_PASSWORD_COMPROMISED="PASSWORD_COMPROMISED";var ScreenLogin=function(container){var input_username,input_password,but_login,but_google,but_facebook,but_close,link_select,INSTANCE=new VSModule,RESPONSE_USERNAME_INVALID="Enter a valid username or email",RESPONSE_PASSWORD_INVALID="Use between 6 and 72 characters",RESPONSE_UNKNOWN="Hmm. Unknown error sorry! Please contact our support staff who will help you further.",monitor_username=!1,monitor_password=!1,credentials_changed=!0;function onFieldChange(){credentials_changed=!0}function validateUsername(value){return(value=$.trim(value)).length<4?(input_username.showError(RESPONSE_USERNAME_INVALID),!1):(input_username.clearError(),!0)}function validatePassword(value){return value.length<6||72<value.length?(input_password.showError(RESPONSE_PASSWORD_INVALID),!1):(input_password.clearError(),!0)}function validateFields(event){return event.preventDefault(),!!credentials_changed&&(validateUsername(input_username.value)||monitor_username||(input_username.on("change",validateUsername),monitor_username=!0),validatePassword(input_password.value)||monitor_password||(input_password.on("change",validatePassword),monitor_password=!0),input_username.hasError()?(VectorStock.track("send","event","Error (User)","Login","Client: Username"),!1):input_password.hasError()?(VectorStock.track("send","event","Error (User)","Login","Client: Password"),!1):void function(){input_username.disable(),input_password.disable(),but_login.setLoading("Logging in"),but_close.hide(),INSTANCE.dispatchEvent("processing");var params={login_user:input_username.value,login_password:input_password.value,login_remember:1},csrf_name=$('meta[name="csrf-name"]'),csrf_value=$('meta[name="csrf-value"]');csrf_name.length&&csrf_value.length&&(params.csrf_name=csrf_name.attr("content"),params.csrf_value=csrf_value.attr("content"));var retried=credentials_changed=!1,onDone=function(response,textStatus,xhr){if(response.success)response.profile&&VectorStock.userData.setProfile(response.profile),response.redirect?VectorStock.goToURL(response.redirect):window.location.reload(!0);else{switch(response.csrf_token&&(csrf_name.attr("content",response.csrf_token.csrf_name),csrf_value.attr("content",response.csrf_token.csrf_value)),enableAllFields(),but_login.revert(),but_close.show(),INSTANCE.dispatchEvent("response"),response.error){case ScreenLogin.ERROR_FAILED:case ScreenLogin.ERROR_NOTFOUND:input_username.showError(response.message),input_password.showError(response.message);break;case ScreenLogin.ERROR_LOCKED:case ScreenLogin.ERROR_BLOCKED:case ScreenLogin.ERROR_DISABLED:case ScreenLogin.ERROR_FACEBOOK:case ScreenLogin.ERROR_GOOGLE:input_username.showError(response.message)}if(!response.message){var log={username:input_username.value,status:textStatus,code:xhr.status,response:JSON.stringify(response),headers:xhr.getAllResponseHeaders()};VectorStock.track("send","event","Error (JS)","CustomError: Login issue (popup) - Missing server message",JSON.stringify(log))}}},onFail=function(xhr,textStatus,errorThrown){var response=!1;if(400==xhr.status||429==xhr.status){try{if((response=JSON.parse(xhr.responseText)).csrf_token&&(csrf_name.attr("content",response.csrf_token.csrf_name),csrf_value.attr("content",response.csrf_token.csrf_value),!retried))return retried=!0,params.csrf_name=response.csrf_token.csrf_name,params.csrf_value=response.csrf_token.csrf_value,void $.ajax({type:"POST",url:"/api/json/login",data:params}).done(onDone).fail(onFail);enableAllFields(),but_login.revert(),but_close.show(),INSTANCE.dispatchEvent("response"),response.message?input_username.showError(response.message):input_username.showError(RESPONSE_UNKNOWN)}catch(e){input_username.showError(RESPONSE_UNKNOWN)}var log={username:input_username.value,status:textStatus,code:xhr.status,response:xhr.responseText,error:errorThrown,headers:xhr.getAllResponseHeaders()};VectorStock.track("send","event","Error (JS)","CustomError: Login issue (popup) - Blocked by server",JSON.stringify(log))}else if(403==xhr.status){var log={username:input_username.value,status:textStatus,code:xhr.status,error:errorThrown,headers:xhr.getAllResponseHeaders()};VectorStock.track("send","event","Error (JS)","CustomError: Login issue (popup) - Blocked by firewall",JSON.stringify(log)),input_username.showError(RESPONSE_UNKNOWN),window.location.reload(!0)}else{var log={username:input_username.value,status:textStatus,code:xhr.status,error:errorThrown,headers:xhr.getAllResponseHeaders()};VectorStock.track("send","event","Error (JS)","CustomError: Login issue (popup) - Failed for unknown reason",JSON.stringify(log)),input_username.showError(RESPONSE_UNKNOWN)}};$.ajax({type:"POST",url:"/api/json/login",data:params}).done(onDone).fail(onFail)}())}function enableAllFields(){input_username.enable(),input_password.enable()}function googleLogin(){but_google.setLoading("Connecting",!0),$.get("/api/google/auth",function(response){1==response.success&&(but_google.revert(),VectorStock.userData.destroy(),window.location.href=response.url)})}function facebookLogin(){but_facebook.setLoading("Connecting",!0),$.post("/api/json/fblogin",function(response){1==response.success&&(but_facebook.revert(),VectorStock.userData.destroy(),window.location.href=response.url)})}function show(){container.addClass("reveal"),""==input_username.value?input_username.focus():""==input_password.value&&input_password.focus()}function close(){INSTANCE.dispatchEvent("close")}function switchToSelect(event){INSTANCE.hide(),INSTANCE.dispatchEvent("screen_select"),event.preventDefault()}return INSTANCE.show=function(is_instant){container.show(),is_instant?show():setTimeout(show,100)},INSTANCE.hide=function(){container.hide().removeClass("reveal")},input_username=new VectorStock.FieldInput($('form input[name="username"]',container)),input_password=new VectorStock.FieldInput($('form input[name="password"]',container)),but_login=new VectorStock.FieldButton($('form button[type="submit"]',container)),but_google=new VectorStock.FieldButton($('.footer button[data-method="google"]',container)),but_facebook=new VectorStock.FieldButton($('.footer button[data-method="facebook"]',container)),but_close=$("> button",container),link_select=$(".footer p a",container),input_username.on("change",onFieldChange),input_password.on("change",onFieldChange),but_login.on("click",validateFields),but_google.on("click",googleLogin),but_facebook.on("click",facebookLogin),but_close.on("click",close),link_select.on("click",switchToSelect),INSTANCE};ScreenLogin.ERROR_FAILED="FAILED",ScreenLogin.ERROR_LOCKED="LOCKED",ScreenLogin.ERROR_BLOCKED="BLOCKED",ScreenLogin.ERROR_NOTFOUND="NOT_FOUND",ScreenLogin.ERROR_DISABLED="DISABLED",ScreenLogin.ERROR_FACEBOOK="FACEBOOK",ScreenLogin.ERROR_GOOGLE="GOOGLE";var ScreenLicenses=function(container){var header,INSTANCE=new VSModule;function onNextScreen(){INSTANCE.dispatchEvent("screen_next")}return INSTANCE.setName=function(name){var copy=header.text().replace(/{NAME}/i,name.toTitleCase());header.text(copy)},INSTANCE.show=function(){container.show(),setTimeout(function(){container.addClass("reveal")},100)},INSTANCE.hide=function(){container.hide().removeClass("reveal")},header=$("h1",container),$(".footer button",container).on("click",onNextScreen),INSTANCE},ScreenPricing=function(container){var INSTANCE=new VSModule;function onNextScreen(){INSTANCE.dispatchEvent("screen_next")}return INSTANCE.show=function(){container.show(),setTimeout(function(){container.addClass("reveal")},100)},INSTANCE.hide=function(){container.hide().removeClass("reveal")},$(".footer button",container).on("click",onNextScreen),INSTANCE},SignupBox=function(settings){var overlay,container,sidebar,sb_screens,sb_background_2,screens,screen_select,screen_signup,screen_login,screen_licenses,screen_pricing,INSTANCE=new VSModule,HTML_TEMPLATE='<div id="box-signup" class="overlay-box"><div class="sb-sidebar"><div class="sb-screen" data-type="default" style="display:block;"><div class="sb-content"><h1>VectorStock</h1><div class="sb-features" data-type="signup"><div class="promo"><p><strong>Cyber Monday deal extended!</strong><br>Signup now and get double the credits. 2 for 1 deal ends in: <em>2 days, 24 hours, 23 minutes, 23 seconds</em></p></div><h2 data-type="signup">Create your <strong>Free Account</strong> for access to:</h2><h2 data-type="login">Login for access to:</h2><ul><li>350,000 Free Vectors</li><li>Millions of Royalty-Free Images</li><li>20,000+ images added daily</li></ul></div><div class="sb-customers"><h3>Some of our customers </h3><ul><li class="co-disney">Disney</li><li class="co-oracle">Oracle</li><li class="co-nike">Nike</li><li class="co-warner">Warner Brothers</li></ul></div></div><div class="sb-background"><div class="bg" data-pattern="1"></div><div class="bg" data-pattern="2"></div></div></div><div class="sb-screen" data-type="login"><div class="sb-content"><h1>VectorStock</h1><div class="sb-features"><p><strong>Welcome back to VectorStock!</strong></p><p>Login to continue</p></div></div><div class="sb-background"><div class="bg reveal" data-pattern="1"></div></div></div></div><div class="sb-screens"><div class="screen" data-screen="select"><div class="header"><h1>Select Signup Method</h1><button type="button" data-method="email"><span class="label">Email Address</span><span class="icon"><span></span></span></button><button type="button" data-method="google"><span class="label">Google</span><span class="icon"><span></span></span></button><button type="button" data-method="facebook"><span class="label">Facebook</span><span class="icon"><span></span></span></button></div><div class="footer"><p>Already have an account? <a href="/">Log in</a></p></div><button data-action="close" type="button">Close</button></div><div class="screen" data-screen="signup"><form action="/signup" method="POST" novalidate><div class="header"><h1>Enter your details</h1><div class="fields"><div class="fieldgroup"><fieldset data-field="firstname"><input type="text" name="firstname" minlength="2" maxlength="45" placeholder="First name" autocomplete="on" tabindex="1001" /></fieldset><fieldset data-field="surname"><input type="text" name="surname" minlength="2" maxlength="45" placeholder="Surname" autocomplete="on" tabindex="1002" /></fieldset></div><fieldset data-field="email"><input type="email" name="email" maxlength="100" autocomplete="on" autocorrect="off" autocapitalize="off" placeholder="Email address" tabindex="1003" /></fieldset><fieldset data-field="password"><input type="password" name="password" minlength="8" maxlength="72" placeholder="Password" tabindex="1004"></fieldset><fieldset data-field="type"><h6>Account Type</h6><ul><li class="checked"><label for="f_type_individual"><span class="radio"><span></span><input type="radio" id="f_type_individual" name="account_type" value="Individual" checked="checked" tabindex="1005"></span><span class="title">Individual</span></label></li><li><label for="f_type_company"><span class="radio"><span></span><input type="radio" id="f_type_company" name="account_type" value="Company" tabindex="1006"></span><span class="title">Company</span></label></li></ul></fieldset><div data-area="company"><fieldset data-field="company"><input type="text" name="company" autocomplete="on" autocorrect="off" autocapitalize="off" placeholder="Company name" tabindex="1007"></fieldset><fieldset data-field="billing"><textarea name="billing" placeholder="Billing address" tabindex="1008"></textarea></fieldset></div></div><div class="agreements"><ul><li><label for="f_terms" class="checked"><span class="checkbox"><input type="checkbox" id="f_terms" name="terms" value="1" checked="checked" tabindex="1009" /></span><span class="title">Agree to our <a href="/faq/members/membership-agreement" target="_blank">Terms of Use</a> and <a href="/faq/members/privacy-policy" target="_blank">Privacy&nbsp;Policy</a></span></label></li><li><label for="f_mailinglist" class="checked"><span class="checkbox"><input type="checkbox" id="f_mailinglist" name="mailinglist" value="1" checked="checked" tabindex="1010" /></span><span class="title">Signup to the VectorStock mailing&nbsp;list</span></label></li></ul></div></div><div class="footer"><button type="submit" tabindex="1011"><span class="label">Create Account</span><span class="icon"><span></span></span></button><p>Already have an account? <a href="/">Log in</a></p></div></form><button data-action="close" type="button">Close</button></div><div class="screen" data-screen="login"><form action="/login" method="POST" novalidate><h1>Login<span class="full"> to your account</span></h1><div class="fields"><fieldset data-field="username"><input type="text" name="username" autocomplete="on" autocorrect="off" autocapitalize="off" maxlength="100" placeholder="Username or Email" tabindex="1001" /></fieldset><fieldset data-field="password"><input type="password" name="password" maxlength="72" placeholder="Password" tabindex="1002"></fieldset></div><button type="submit" tabindex="1003"><span class="label">Login</span><span class="icon"><span></span></span></button><p><a href="/request/password">Forgot your password?</a></p></form><div class="footer"><h1>Or login with:</h1><div class="options"><button type="button" data-method="google" tabindex="1004"><span class="label">Google</span><span class="icon"><span></span></span></button><button type="button" data-method="facebook" tabindex="1005"><span class="label">Facebook</span><span class="icon"><span></span></span></button></div><p>New to VectorStock? <a href="/signup">Sign up for&nbsp;free!</a></p></div><button data-action="close" type="button">Close</button></div><div class="screen" data-screen="licenses"><h1>Welcome {NAME}!</h1><h2>Our images are available in 3 licenses:</h2><table cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="title">Free</td><td>For personal use</td></tr><tr><td class="title">Standard</td><td>For print, advertising, design etc.</td></tr><tr><td class="title">Expanded</td><td>For resale &amp; distribution</td></tr></tbody></table><div class="footer"><button type="button"><span class="label">Continue</span><span class="icon"><span></span></span></button></div></div><div class="screen" data-screen="pricing"><h1>Image Pricing</h1><h2>You can buy images using:<br><strong>Monthly Subscription</strong> (best price) or<br><strong>Pre-paid Credits</strong> (use anytime).</h2><table cellpadding="0" cellspacing="0" border="0"><thead><tr><th></th><th title="Free License">Free</th><th title="Standard License">Standard</th><th title="Expanded License">Expanded</th></tr></thead><tbody><tr><td class="title">Subscription</td><td><sup>$</sup>0</td><td><small>From</small> 69<sub></sub></td><td class="disabled" title="Not Available">N/A</td></tr><tr><td class="title">Credits</td><td><sup>$</sup>0</td><td><small>From</small> <sup>$</sup>1</td><td><sup>$</sup>25</td></tr></tbody></table><div class="footer"><button type="button"><span class="label">Get Started!</span><span class="icon"><span></span></span></button></div></div></div></div>';VectorStock.isMobile();function onClickOverlay(event){$(event.target)[0]==overlay[0]&&INSTANCE.close()}function build(){sidebar=$(".sb-sidebar",container),sb_screens=$(".sb-screen",sidebar),$('.sb-background [data-pattern="1"]',sidebar),sb_background_2=$('.sb-background [data-pattern="2"]',sidebar),screens=$(".sb-screens",container),screen_select=new ScreenSelect($('[data-screen="select"]',screens),settings.contributor),screen_signup=new ScreenSignup($('[data-screen="signup"]',screens),settings.contributor),screen_login=new ScreenLogin($('[data-screen="login"]',screens)),screen_licenses=new ScreenLicenses($('[data-screen="licenses"]',screens)),screen_pricing=new ScreenPricing($('[data-screen="pricing"]',screens)),settings.sidebar&&$(".sb-content",sb_screens).html(settings.sidebar),function(){var date_starts=new Date(Date.UTC(2017,10,28,11,0,0));date_ends=new Date(Date.UTC(2017,11,1,23,0,0)),time_now=(new Date).getTime(),promo_active=time_now>date_starts.getTime()&&time_now<date_ends.getTime();var area_promo=$(".sb-features .promo",sb_screens),area_countdown=$("p em",area_promo);if(promo_active){function promoCountdown(){var time_remaining=date_ends.getTime()-(new Date).getTime(),days=Math.floor(time_remaining/MS_DAY),hours=Math.floor((time_remaining-days*MS_DAY)/MS_HOUR),minutes=Math.floor((time_remaining-(days*MS_DAY+hours*MS_HOUR))/MS_MINUTE),seconds=Math.floor((time_remaining-(days*MS_DAY+hours*MS_HOUR+minutes*MS_MINUTE))/MS_SECOND),display=[];days&&display.push(days+" day"+(1==days?"":"s")),hours&&display.push(hours+" hour"+(1==hours?"":"s")),minutes&&display.push(minutes+" minute"+(1==minutes?"":"s")),seconds&&display.push(seconds+" second"+(1==seconds?"":"s")),area_countdown.text(display.join(", "))}setInterval(promoCountdown,1e3),promoCountdown()}else area_promo.remove()}(),screen_select.on("processing",disableOverlay).on("response",enableOverlay).on("screen_signup",showSignup).on("close",INSTANCE.close).on("screen_login",showLogin),screen_signup.on("expand",expandBox).on("processing",disableOverlay).on("response",enableOverlay).on("close",INSTANCE.close).on("signup",onSignup).on("screen_login",showLogin),screen_login.on("processing",disableOverlay).on("login",onLogin).on("response",enableOverlay).on("close",INSTANCE.close).on("screen_select",showSelect),screen_licenses.on("screen_next",showPricing),screen_pricing.on("screen_next",goToPurchase),$(document).on("keypress",onKeyPress),"login"==settings.screen?(sb_screens.hide().filter("[data-type=login]").show(),showLogin(!0)):showSelect(!0),setTimeout(function(){container.addClass("reveal")})}function onLogin(){INSTANCE.dispatchEvent("login")}function expandBox(is_expanded){container.toggleClass("expanded",is_expanded)}function disableOverlay(){overlay&&overlay.off("click",onClickOverlay)}function enableOverlay(){overlay&&overlay.on("click",onClickOverlay)}function showSelect(is_instant){sb_screens.hide().filter("[data-type=default]").show(),screen_select.show(is_instant)}function showSignup(is_instant){screen_signup.show(is_instant)}function showLogin(is_instant){expandBox(!1),screen_login.show(is_instant)}function onSignup(response,params){settings.url_signup?VectorStock.goToURL(settings.url_signup):response.redirect?VectorStock.goToURL(response.redirect):settings.contributor?VectorStock.goToURL("/account/sell-vectors"):goToPurchase()}function showPricing(){screen_licenses.hide(),screen_pricing.show(),sb_background_2.addClass("reveal")}function goToPurchase(){var url="/purchase",vector_id=$("#vector_id").val();if(vector_id){var vector_license=$('input[name="license"]:checked').val(),vector_payment=$('input[name="payment_'+vector_license+'"]:checked').val();"credits"!=vector_payment&&"subscription"!=vector_payment||(url+="/"+vector_payment),url+="?id="+vector_id,vector_license&&(url+="&license="+vector_license)}VectorStock.goToURL(url)}function onKeyPress(event){"Escape"===event.key&&(INSTANCE.close(),event.stopPropagation())}return INSTANCE.close=function(){container&&container.remove(),overlay.remove(),$(document).on("keypress",onKeyPress),SignupBox.instance=null,INSTANCE.dispatchEvent("close")},INSTANCE.showLoginScreen=function(){sb_screens.hide().filter("[data-type=login]").show(),$("> .screen",screens).hide(),showLogin(!0)},SignupBox.instance&&SignupBox.instance.close(),settings||(settings={}),settings.container?(container=settings.container,build()):(overlay=$('<div class="overlay" />').css({height:$(document).height()}).appendTo("body").on("click",onClickOverlay),setTimeout(function(){overlay.addClass("reveal")}),container=$(HTML_TEMPLATE).appendTo(overlay),build(),"absolute"==container.css("position")&&VectorStock.scrollTo(0),EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Signup Popup",event:"Initiated"},!0),EventTracker.store("ctr_signup_popup","initiated",!0)),SignupBox.instance=INSTANCE};SignupBox.TIME_FAIL=1e4,SignupBox.TIME_EXPIRE=9e5,SignupBox.instance=null,SignupBox.extendSession=function(){$.getJSON("/api/loggedincheck").done(function(response){if(response.success)setTimeout(SignupBox.extendSession,SignupBox.TIME_EXPIRE);else if(SignupBox.instance)SignupBox.instance.showLoginScreen();else new SignupBox({screen:"login"})}).fail(function(event){setTimeout(SignupBox.extendSession,SignupBox.TIME_FAIL)})},$(function(){function launchSignupBox(url){for(var params=1<(url=url.split("?")).length?url[1].toLowerCase().split("&"):[],is_contributor=!1,i=params.length;i--;){var parts=params[i].split("="),key=parts[0],value=1<parts.length?parts[1]:"";if("contributor"==key&&0!==value){is_contributor=!0;break}}new SignupBox({contributor:is_contributor})}if("/signup"!==window.location.pathname.toLowerCase()&&($('a[href^="/signup"]').on("click",function(event){launchSignupBox($(this).attr("href")),event.preventDefault()}),$(window).on("redirect",function(event,url,path){"/signup"==path&&(launchSignupBox(url),event.preventDefault?event.preventDefault():event.isDefaultPrevented=function(){return!0})})),0<=window.location.search.search(/login=1/i)&&new SignupBox({screen:"login"}),0<=window.location.search.search(/signup=1/i)){var is_contributor=0<=window.location.search.search(/contributor=1/i);new SignupBox({contributor:is_contributor})}});var GalleryBox=function(){var image_list,image_tally,is_cart,is_likes,image_id,image_title,image_artist,overlay,container,screens,imageset,header,hd_browse,hd_create,gl_list,INSTANCE=new VSModule;$.isArray(arguments[0])?(image_list=arguments[0],image_tally=arguments[1]||image_list.length,is_cart=arguments[2]||!1,is_likes=arguments[3]||!1):(image_id=arguments[0],image_title=arguments[1],image_artist=arguments[2]);VectorStock.isMobile();function addImage(image_id,image_title){var figure;figure=$("<figure />").appendTo(imageset),$('<img width="238" height="250">').attr("src",VectorStock.imagePath(image_id,image_title,"medium")).attr("alt",image_title||"").appendTo(figure),$('<span class="inner" />').appendTo(figure)}function populate(galleries){hd_browse.on("filter",filterGalleries),hd_browse.setTotal(galleries.length),gl_list.populate(galleries);var search=hd_browse.getSearch();search&&filterGalleries(search)}function onClickOverlay(event){$(event.target)[0]==overlay[0]&&INSTANCE.close()}function onListUpdate(num_matches){hd_browse.setTotal(num_matches)}function filterGalleries(search){gl_list.filter(search)}function changeHeader(type,search_input){type==GalleryBox.HeaderCreate?(hd_browse.hide(),search_input&&hd_create.setName(search_input),hd_create.show(),gl_list.hide()):type==GalleryBox.HeaderBrowse&&(hd_browse.show(),hd_create.hide(),gl_list.show())}function changeHeaderCreate(gallery_name){gallery_name&&hd_create.setName(gallery_name),changeHeader(GalleryBox.HeaderCreate)}function createGallery(gallery_name,gallery_private){if(image_list){var hd_created=new GalleryBox.HeaderCreated(header,gallery_name,image_list,image_tally);hd_create.hide(),hd_created.show();var onGalleryCreated=function(response){response.success?(VectorStock.setTally("galleries",response.galleries),VectorStock.userData.refresh(),INSTANCE.dispatchEvent("gallery_created",[response.id,gallery_name,gallery_private])):response.message&&("max_galleries_reached"==response.message?(alert("Could not create gallery - total gallery limit reached"),INSTANCE.close()):"gallery_full"==response.message&&(alert("Could not create gallery - image limit reached"),INSTANCE.close())),response.csrf_token&&response.csrf_token.csrf_name&&response.csrf_token.csrf_value&&(GalleryBox.csrf_name=response.csrf_token.csrf_name,GalleryBox.csrf_value=response.csrf_token.csrf_value)};is_cart?$.post("/api/cart/addtogallery",{name:gallery_name,private:gallery_private,csrf_name:GalleryBox.csrf_name,csrf_value:GalleryBox.csrf_value},"json").done(onGalleryCreated):is_likes?$.post("/api/likes/addtogallery",{name:gallery_name,private:gallery_private,csrf_name:GalleryBox.csrf_name,csrf_value:GalleryBox.csrf_value},"json").done(onGalleryCreated):$.post("/api/galleries",{name:gallery_name,private:gallery_private,csrf_name:GalleryBox.csrf_name,csrf_value:GalleryBox.csrf_value},"json").done(onGalleryCreated)}else gl_list.createGallery(gallery_name,gallery_private),changeHeader(GalleryBox.HeaderBrowse)}function cancelCreate(){image_list&&INSTANCE.close()}return INSTANCE.close=function(){container&&container.remove(),overlay.remove(),$("body").removeClass("pagelock"),INSTANCE.dispatchEvent("close")},overlay=$('<div class="overlay" />').css({height:$(document).height()}).appendTo("body").on("click",onClickOverlay).on("mousewheel",function(e){}),setTimeout(function(){overlay.addClass("reveal")}),function(html_template){var sidebar,sb_content,sb_background,screen,gl_pane;if(container=$(html_template).appendTo(overlay),sidebar=$(".gb-sidebar",container),sb_screen=$(".gb-screen",sidebar).show(),sb_content=$(".gb-content",sb_screen),sb_background=$(".gb-background",sb_screen),imageset=$(".imageset",sb_content),screens=$(".gb-screens",container),screen=$(".gb-screen",screens).show(),header=$(".header",screen),hd_browse=new GalleryBox.HeaderBrowse($(".header_browse",header),!image_list),hd_create=new GalleryBox.HeaderCreate($(".header_create",header),!!image_list),gl_pane=$(".panel",screen),gl_list=image_list?new GalleryBox.List($(".pane",gl_pane),image_list):new GalleryBox.List($(".pane",gl_pane),image_id,image_title),but_close=$('button[data-action="close"]',screen),image_list)if(imageset.attr("data-images",image_list.length),0<image_tally){for(var i=Math.min(5,image_list.length);i--;)addImage(image_list[i].id,image_list[i].title);var aside_title="Images";is_cart?aside_title="Cart Images":is_likes&&(aside_title="Liked Images"),$("<h1 />").text(aside_title+" ("+image_tally+")").appendTo(sb_content)}else sb_content.empty(),sb_background.addClass("empty");else imageset.attr("data-images",1),addImage(image_id,image_title),$("<h1 />").text(image_title+" vector image").appendTo(sb_content),image_artist&&$("<h2 />").text("by "+image_artist).appendTo(sb_content),(new Image).src=VectorStock.imagePath(image_id,image_title,"small");hd_browse.on("change_header",changeHeader),hd_create.on("change_header",changeHeader).on("create_gallery",createGallery).on("cancel",cancelCreate),gl_list.on("new_gallery",changeHeaderCreate).on("update",onListUpdate),but_close.on("click",INSTANCE.close),image_list?hd_create.show():(hd_browse.show(),gl_list.show()),setTimeout(function(){container.addClass("reveal")})}(GalleryBox.template),GalleryBox.galleries?populate(GalleryBox.galleries):$.get("/api/galleries/byname").done(function(response){response.csrf_token&&response.csrf_token.csrf_name&&response.csrf_token.csrf_value&&(GalleryBox.csrf_name=response.csrf_token.csrf_name,GalleryBox.csrf_value=response.csrf_token.csrf_value),GalleryBox.galleries=response.galleries,populate(GalleryBox.galleries)}).fail(function(event){401==event.status&&INSTANCE.close()}),INSTANCE};GalleryBox.template='<div id="box-gallery" class="overlay-box"><div class="gb-sidebar"><div class="gb-screen" data-screen="image"><div class="gb-content"><div class="imageset" data-images="1"></div></div><div class="gb-background"></div></div></div><div class="gb-screens"><div class="gb-screen" data-screen="list"><div class="header"><div class="header_browse"><h1><span class="short">Galleries</span><span class="long">Add to Gallery</span> <data>(0)</data></h1><div class="fieldgroup"><fieldset data-field="filter"><span class="icon"></span><input type="text" name="gallery_search" placeholder="Search gallery names" autocomplete="off" tabindex="1"></fieldset><button type="button" data-action="create" tabindex="2"><span class="icon"></span><span class="label">New</span></button></div></div><div class="header_create"><h1>New Gallery</h1><div class="fieldgroup"><fieldset data-field="gallery_name"><input type="text" name="gallery_name" placeholder="Enter name" autocomplete="off" tabindex="1"></fieldset><label for="gallery_new_private"><span class="checkbox"><input type="checkbox" id="gallery_new_private" name="gallery_new_private"></span><span class="title">Private</span></label></div><button type="button" data-action="cancel" tabindex="2"><span class="label">Cancel</span></button><button type="button" data-action="create" tabindex="3"><span class="label">Create</span></button></div></div><div class="panel"><div class="pane"><div class="state"></div><ul></ul></div></div><button data-action="close" type="button">Close</button></div></div></div>',GalleryBox.galleries=null,GalleryBox.csrf_name=null,GalleryBox.csrf_value=null,GalleryBox.HeaderBrowse=function(container,is_showing){var header,header_tally,input_search,but_create,INSTANCE=new VSModule;function filterGalleries(){console.log("filter");var value=$.trim(input_search.value);INSTANCE.dispatchEvent("filter",[value])}function createNewGallery(){INSTANCE.dispatchEvent("change_header",[GalleryBox.HeaderCreate,input_search.value])}return INSTANCE.show=function(){return container.show(),header.css({height:container.outerHeight()}),setTimeout(function(){container.addClass("reveal"),input_search.focus()}),INSTANCE},INSTANCE.hide=function(){return container.hide().removeClass("reveal"),input_search.setValue(),INSTANCE},INSTANCE.setTotal=function(total){return header_tally.show().text("("+total+")"),INSTANCE},INSTANCE.getSearch=function(){return $.trim(input_search.value)},header=container.parent(),header_tally=$("h1 data",container),input_search=new VectorStock.FieldInput($('input[name="gallery_search"]',container),VectorStock.FieldInput.FORMAT_ALPHANUMERIC),but_create=new VectorStock.FieldButton($('button[data-action="create"]',container)),input_search.on("change",filterGalleries),but_create.on("click",createNewGallery),is_showing&&container.show().addClass("reveal"),INSTANCE},GalleryBox.HeaderCreate=function(container,is_showing){var header,input_name,cbox_private,but_cancel,but_create,INSTANCE=new VSModule;function onNameChange(value){value?but_create.enable():but_create.disable()}function onCancel(){INSTANCE.dispatchEvent("cancel"),INSTANCE.dispatchEvent("change_header",[GalleryBox.HeaderBrowse])}function onNewGallery(){var gallery_name=$.trim(input_name.value);gallery_name?(input_name.setValue("",!0),INSTANCE.dispatchEvent("create_gallery",[gallery_name,cbox_private.checked])):(but_create.disable(),input_name.focus())}return INSTANCE.show=function(){return container.show(),header.css({height:container.outerHeight()}),setTimeout(function(){container.addClass("reveal"),input_name.focus()}),INSTANCE},INSTANCE.hide=function(){return container.hide().removeClass("reveal"),INSTANCE},INSTANCE.setName=function(gallery_name){input_name.setValue(gallery_name)},header=container.parent(),input_name=new VectorStock.FieldInput($('input[name="gallery_name"]',container),VectorStock.FieldInput.FORMAT_ALPHANUMERIC),cbox_private=new VectorStock.FieldCheckbox($('input[name="gallery_new_private"]',container)),but_cancel=new VectorStock.FieldButton($('button[data-action="cancel"]',container)),but_create=new VectorStock.FieldButton($('button[data-action="create"]',container)),input_name.on("change",onNameChange).on("return",onNewGallery),but_cancel.on("click",onCancel),but_create.on("click",onNewGallery),is_showing&&container.show().addClass("reveal"),INSTANCE},GalleryBox.HeaderCreated=function(header,gallery_name,gallery_images,gallery_tally){var container,gallery_imageset,INSTANCE=new VSModule;return INSTANCE.show=function(){return container.show(),header.css({height:""}),setTimeout(function(){container.addClass("reveal")}),INSTANCE},INSTANCE.hide=function(){return container.hide().removeClass("reveal"),INSTANCE},function(){var gallery_entry,gallery_imagewrap,image_index,image_id,image_title,src,figure;container=$('<div class="header_created" />').appendTo(header),$("<h1>Gallery created!</h1>").appendTo(container),gallery_entry=$('<div class="gallery" />').appendTo(container),$('<span class="title">'+gallery_name+"</span>").appendTo(gallery_entry),$('<span class="subtitle">'+gallery_tally+" Image"+(1==gallery_tally?"":"s")+"</span>").appendTo(gallery_entry),gallery_imagewrap=$('<span class="images">').appendTo(gallery_entry),gallery_imageset=$('<span class="set">').appendTo(gallery_imagewrap);for(var i=0;i<gallery_images.length;i++)image_id=gallery_images[image_index=i].id,image_title=gallery_images[i].title,figure=void 0,src="url("+VectorStock.imagePath(image_id,image_title,"small")+")",figure=$('<figure data-index="'+image_index+'" data-image="'+image_id+'" />'),$("<span />").css({backgroundImage:src}).appendTo(figure),figure.appendTo(gallery_imageset)}(),INSTANCE},GalleryBox.List=function(){var image_list,image_id,image_title,INSTANCE=new VSModule,container=arguments[0];$.isArray(arguments[1])?image_list=arguments[1]:(image_id=arguments[1],image_title=arguments[2]);var state,list,state_load,state_empty,state_none,temp_id=1e9,gallery_items=[];function updateGalleryLastModified(gallery_id){for(var i=0;i<GalleryBox.galleries.length;i++)if(GalleryBox.galleries[i].id===gallery_id){var gallery_entry=GalleryBox.galleries.splice(i,1);GalleryBox.galleries.unshift(gallery_entry[0]);break}}function createGalleryItem(gallery_id,gallery_name,gallery_private,gallery_images,gallery_checked){var item=new GalleryBox.ListItem(gallery_id,gallery_name,gallery_private,gallery_images,gallery_checked);item.getElement();return item.on("check",function(){image_list?item.addImages(image_list):item.addImage(image_id,image_title),function(gallery_id){image_id&&(VectorStock.userData.addToGallery(image_id,gallery_id),$.put("/api/galleries/"+gallery_id+"/"+image_id,function(response){response.success||(VectorStock.userData.removeFromGallery(image_id,gallery_id),setTimeout(function(){var gallery=function(gallery_id){for(var i=0;i<gallery_items.length;i++)if(gallery_items[i].id==gallery_id)return gallery_items[i];return null}(gallery_id);gallery.removeImage(image_id)},10),response.message&&"gallery_full"==response.message&&alert("Could not add image #"+image_id+" to gallery - limit reached"+(response.gallery_total?" ("+response.gallery_total+")":"")))},"json"),VectorStock.track("send","event","Add To Gallery","Image",JSON.stringify({image:image_id,gallery:gallery_id})));updateGalleryLastModified(gallery_id)}(gallery_id),INSTANCE.dispatchEvent("image_added",[gallery_id])}).on("uncheck",function(){image_list?item.removeImages(image_list):item.removeImage(image_id),function(gallery_id){image_id&&($.delete("/api/galleries/"+gallery_id+"/"+image_id,"json"),VectorStock.userData.removeFromGallery(image_id,gallery_id));updateGalleryLastModified(gallery_id)}(gallery_id),INSTANCE.dispatchEvent("image_removed",[gallery_id])}),item}function toggleScrolling(){var is_scrolling=list.outerHeight()>container.outerHeight();container.toggleClass("scrolling",is_scrolling)}return INSTANCE.populate=function(galleries){for(var i=0,len=galleries.length;i<len;i++){for(var is_checked=!1,j=galleries[i].contents.length;j--;)if(galleries[i].contents[j].id==image_id){is_checked=!0;break}var item=createGalleryItem(galleries[i].id,galleries[i].name,galleries[i].private,galleries[i].contents,is_checked);item.getElement().appendTo(list),gallery_items.push(item)}state.attr("data-state",0==len?"empty":""),toggleScrolling()},INSTANCE.filter=function(term){term;for(var i=gallery_items.length,count=0;i--;)count+=gallery_items[i].match(term);state.attr("data-state",0==count?"none":""),toggleScrolling(),INSTANCE.dispatchEvent("update",[count])},INSTANCE.createGallery=function(gallery_name,gallery_private){var gallery_id=temp_id++,gallery_ids=(gallery_private=Number(gallery_private),[]),gallery_images=[];if(image_list)for(var i=0;i<image_list.length;i++)gallery_ids.push(image_list[i].id),gallery_images.push({id:image_list[i].id,title:image_list[i].title});else gallery_ids.push({id:image_id,title:image_title}),gallery_images.push({id:image_id,title:image_title});var gallery_entry={id:gallery_id,public:!gallery_private,name:gallery_name,contents:gallery_images},item=createGalleryItem(gallery_id,gallery_name,gallery_private,gallery_images,!0),item_element=item.getElement().addClass("faded");GalleryBox.galleries.unshift(gallery_entry),item_element.prependTo(list),gallery_items.unshift(item),toggleScrolling(),setTimeout(function(){container.scrollTop(item_element[0].offsetTop),item_element.removeClass("faded")},10),$.post("/api/galleries",{name:gallery_name,private:gallery_private,images:gallery_ids,csrf_name:GalleryBox.csrf_name,csrf_value:GalleryBox.csrf_value},"json").done(function(response){response.success?(gallery_entry.id=response.id,item.updateId(response.id),VectorStock.setTally("galleries",response.galleries),VectorStock.userData.createGallery(response.id,gallery_name),VectorStock.userData.addToGallery(image_id,response.id)):(GalleryBox.galleries.shift(),item_element.remove(),gallery_items.shift(),response.message&&"max_galleries_reached"==response.message&&alert("Could not create gallery - max limit reached")),response.csrf_token&&response.csrf_token.csrf_name&&response.csrf_token.csrf_value&&(GalleryBox.csrf_name=response.csrf_token.csrf_name,GalleryBox.csrf_value=response.csrf_token.csrf_value)}),INSTANCE.dispatchEvent("update",[GalleryBox.galleries.length])},INSTANCE.show=function(){return container.show(),setTimeout(function(){container.addClass("reveal")}),INSTANCE},INSTANCE.hide=function(){return container.hide().removeClass("reveal"),INSTANCE},state=$(".state",container).attr("data-state","load"),(state_load=$('<div class="state_load" />').appendTo(state)).loadingIcon("small"),$("<p>Loading galleries</p>").appendTo(state_load),state_empty=$('<div class="state_empty" />').appendTo(state),$("<p>No galleries exist yet</p>").appendTo(state_empty),state_none=$('<div class="state_none" />').appendTo(state),$("<p>No matches</p>").appendTo(state_none),list=$("ul",container),INSTANCE},GalleryBox.ListItem=function(gallery_id,gallery_name,gallery_private,gallery_images,gallery_checked){var item,label,cbox_wrap,cbox_input,cbox_field,item_title,item_subtitle,item_images,INSTANCE=new VSModule;function updateTitle(title){item_title.html(title)}function updateSubtitle(){item_subtitle.html(INSTANCE.images.length+" Image"+(1==INSTANCE.images?"":"s"))}function onChecked(checked){var event_type=checked?"check":"uncheck";INSTANCE.dispatchEvent(event_type,[INSTANCE.id])}return INSTANCE.id=gallery_id,INSTANCE.name=gallery_name,INSTANCE.private=gallery_private,INSTANCE.images=gallery_images,INSTANCE.checked=gallery_checked,INSTANCE.getElement=function(){return item},INSTANCE.updateId=function(gallery_id){INSTANCE.id=gallery_id,label.attr("for","in_gallery_"+INSTANCE.id),cbox_input.attr("id","in_gallery_"+INSTANCE.id)},INSTANCE.match=function(term){if(term){var regex=new RegExp("("+term+")","gi");if(INSTANCE.name.search(regex)<0)return item.hide(),!1;updateTitle(INSTANCE.name.replace(regex,"<em>$1</em>"))}else updateTitle(INSTANCE.name);return item.show(),!0},INSTANCE.addImage=function(image_id,image_title){item_images.addImage(image_id,image_title),updateSubtitle()},INSTANCE.addImages=function(image_list){for(var i=0;i<image_list.length;i++)item_images.addImage(image_list[i].id,image_list[i].title);updateSubtitle()},INSTANCE.removeImage=function(image_id){item_images.removeImage(image_id),cbox_field.toggle(!1,!0),updateSubtitle()},INSTANCE.removeImages=function(image_list){for(var i=0;i<image_list.length;i++)item_images.removeImage(image_list[i].id);cbox_field.toggle(!1,!0),updateSubtitle()},item=$('<li data-status="'+(INSTANCE.private?"private":"")+'" />'),label=$('<label for="in_gallery_'+INSTANCE.id+'">').appendTo(item),cbox_wrap=$('<span class="checkbox" />').appendTo(label),cbox_input=$('<input type="checkbox" id="in_gallery_'+INSTANCE.id+'">').appendTo(cbox_wrap),cbox_field=new VectorStock.FieldCheckbox(cbox_input),item_title=$('<span class="title" />').appendTo(label),item_subtitle=$('<span class="subtitle" />').appendTo(label),item_images=new GalleryBox.ListItemImages(label,INSTANCE.images),updateTitle(INSTANCE.name),updateSubtitle(),cbox_field.toggle(INSTANCE.checked),cbox_field.on("change",onChecked),INSTANCE},GalleryBox.ListItemImages=function(scope,images){var container,imageset,INSTANCE=new VSModule,MAX_IMAGES=3,image_lookup={};function createImage(image_id,image_title,image_index){image_index=image_index||0;var src="url("+VectorStock.imagePath(image_id,image_title,"small")+")",figure=$('<figure data-index="'+image_index+'" data-image="'+image_id+'" />'),num_images=($("<span />").css({backgroundImage:src}).appendTo(figure),imageset.children().length);return null==image_index||0==num_images||num_images<=image_index?figure.appendTo(imageset):imageset.children().eq(image_index).before(figure),image_lookup[image_id]=figure}return INSTANCE.addImage=function(image_id,image_title){images.push({id:image_id,title:image_title}),function(image_id,image_title,image_index,is_instant){var figure=createImage(image_id,image_title,image_index);is_instant||(figure.addClass("conceal"),setTimeout(function(){$("figure",imageset).each(function(index){$(this).attr("data-index",index)}),figure.removeClass("conceal")},10))}(image_id,image_title)},INSTANCE.removeImage=function(image_id){for(var index,i=images.length;i--;)if(images[i].id==image_id){index=i;break}void 0!==index&&(images.splice(index,1),function(image_id){var figure=image_lookup[image_id];figure&&(figure.addClass("conceal"),delete image_lookup[image_id],setTimeout(function(){$("figure",imageset).not(".conceal").each(function(index){$(this).attr("data-index",index)})}),setTimeout(function(){figure.remove()},550))}(image_id))},function(){container=$('<span class="images" />').appendTo(scope),imageset=$('<span class="set" />').appendTo(container);for(var range=images.length<=MAX_IMAGES?images.length:MAX_IMAGES,group=images.slice(images.length-range),i=range;i--;){var index=range-i-1;createImage(group[i].id,group[i].title,index)}}(),INSTANCE};var PaymentScreenPay=function(container,settings_purchase){var pane,pane_content,page,footer,area_method,area_select,area_card,area_contact,radioboxes_method,radioboxes_payment,message_error,input_card_number,icon_card,input_card_expiry,input_card_cvv,cbox_remember,field_recaptcha,input_email,cbox_billing,field_billing,input_billing,but_submit,but_submit_label,but_submit_icon,but_paypal,but_gpay,icon_loading,total_cost_decimal,total_cost_formatted,logged_in,payment,bt_token,bt_version,bt_client,timeout_animation,header_title,but_close,screen_title,INSTANCE=new VSModule,CARD_FORMATS={_default:/(.{1,4})/g,amex:/(.{1,4})(.{1,6})?(.{1,5})?/,dinersclub:/(.{1,4})(.{1,6})?(.{1,4})?/},CARD_ICONS=["amex","dinersclub","discover","jcb","mastercard","visa"],REGEX_EMAIL=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,RESPONSE_CARD_ATTEMPTS="Declined after too many failed attempts",RESPONSE_CARD_DECLINED="Card declined",RESPONSE_CARD_FLAGGED="Card flagged as suspicious, please try another card",RESPONSE_CARD_NORESULT="Card failed to process, please try another card",RESPONSE_SAVED_CARD_BAD="Stored card invalid, please use another card",RESPONSE_EMAIL_INVALID="Enter a valid email",RESPONSE_NUMBER_INVALID="Invalid card number",RESPONSE_EXPIRY_INVALID="Invalid expiry date",RESPONSE_EXPIRY_EXPIRED="Card has expired",RESPONSE_CVV_INVALID="Invalid CVV number",RESPONSE_RECAPTCHA_FAILED="Recaptcha check failed",RESPONSE_PRIOR_PURCHASE="Please check your email history, this image appears to have already been purchased",ERROR_DETAILS={2044:{message:"Bank Declined Purchase: Call Issuer",description:"The card-issuing bank has declined this transaction. Contact your bank for more information."},2015:{message:"Bank Declined Purchase: Transaction Not Allowed",description:"Your bank is declining the transaction for unspecified reasons, possibly due to an issue with the card itself. Contact your bank for more information."},2019:{message:"Bank Declined Purchase: Invalid Transaction",description:"Your bank declined the transaction, typically because the card does not support this type of transaction. Contact your bank for more information."},91567:{message:"Card type is not accepted",description:"Our payment processor does not support this type of credit card. Please try another card or payment type (eg. PayPal)."}},GOOGLE_MERCHANT_ID="03244693700224937031",GOOGLE_SITE_KEY="6Lfn4kMUAAAAAHUi20XSelxWN5uirLGwYHEMWKWw",URL_PAYPAL="https://www.paypal.com/sdk/js?client-id="+(VectorStock.isProduction()?"ARH1aa5Q51rCj-dqN63uczoqdCCMJRCUCaA4rvZ1Aw0IJjvRyCuntoAC9p1Q2tGkSz7czFf5yDJvZZl-":"AVg2i2yKuVMcRBeHn23PVmd2Tutw4sIxoj18wULkCjkTFl1s88s-cGlLerCw-17SCvJYvcXdxf0MWpVJ")+"&currency=USD",URL_GOOGLE_PAY="https://pay.google.com/gp/p/js/pay.js",URL_GOOGLE_RECAPTCHA="https://www.google.com/recaptcha/api.js",loaded_setup=null,loaded_setup_attempts=0,loaded_paypal=null,loaded_paypal_attempts=0,loaded_google_pay=null,loaded_google_pay_attempts=0,loaded_google_recaptcha=null,loaded_google_recaptcha_attempts=0,bt_device_data=null,form_input_fields=[],monitor_number=!1,monitor_expiry=!1,monitor_cvv=!1,monitor_email=!1,recaptcha_required=!1,recaptcha_id=null,recaptcha_value=null,payment_attempts={};function isSetupReady(){1==loaded_setup&&null!==loaded_paypal&&null!==loaded_google_pay&&(recaptcha_required?1==loaded_google_recaptcha&&setup():setup())}function setup(){var input_number,input_expiry,input_cvv,but_close;radioboxes_method=new VectorStock.FieldRadioboxes($("ul.radiobuttons li",area_method)),radioboxes_payment=new VectorStock.FieldRadioboxes($("ul.radiobuttons li",area_select)),message_error=$(".message",area_card),input_number=$('input[name="card_number"]',area_card).payment("formatCardNumber"),input_card_number=new VectorStock.FieldInput(input_number),icon_card=$('fieldset[data-field="card_number"] .card',area_card),input_expiry=$('input[name="card_expiry"]',area_card).payment("formatCardExpiry"),input_card_expiry=new VectorStock.FieldInput(input_expiry),input_cvv=$('input[name="card_cvv"]',area_card).payment("formatCardCVC"),input_card_cvv=new VectorStock.FieldInput(input_cvv),field_recaptcha=$('.fieldgroup[data-id="recaptcha"]',area_card),cbox_remember=new VectorStock.FieldCheckbox($('input[name="remember_card"]',area_card)),input_email=new VectorStock.FieldInput($('input[name="email"]',area_contact)),cbox_billing=new VectorStock.FieldCheckbox($('input[name="inc_billing_address"]',area_contact)),field_billing=$('.fieldgroup[data-id="address"]',area_contact),input_billing=new VectorStock.FieldInput($('textarea[name="billing_address"]',field_billing)),form_input_fields=[input_card_number,input_card_expiry,input_card_cvv,input_email],but_submit=$("#pbox-creditcard",footer),but_submit_label=$(".label",but_submit),but_paypal=$("#paypal-button",footer),but_gpay=$("#gpay-button",footer),but_close=$('button[data-action="close"]',container),icon_loading&&icon_loading.remove(),function(){if(window.braintree&&bt_token)if(2==(bt_version=window.braintree.client?3:2)){bt_client=new window.braintree.api.Client({clientToken:bt_token});var data_collector=braintree.data.setup({kount:{environment:VectorStock.isProduction()?"production":"sandbox"}});bt_device_data=data_collector.deviceData}else 3==bt_version&&window.braintree.client.create({authorization:bt_token}).then(function(clientInstance){return bt_client=clientInstance,braintree.dataCollector.create({client:clientInstance,kount:!0}).then(function(dataCollectorInstance){bt_device_data=dataCollectorInstance.deviceData})}).catch(function(err){var err_string=err.toString?err.toString():JSON.stringify(err),log_detail={error:err_string,token:bt_token};VectorStock.log({source:"PaymentBox",issue:"Braintree token failed to authenticate",detail:log_detail})});else{var log_detail={braintree:window.braintree?"loaded":"unavailable",token:bt_token};VectorStock.log({source:"PaymentBox",issue:"Braintree object (or token) unavailable",detail:log_detail})}}(),function(){if(window.paypal){function showPayPalUnavailable(){var message=$('<div class="err_missing">PayPal not available at this time</div>');but_paypal.empty().append(message)}function formatResponse(response){return response.json()}function returnPaymentID(response){return response.id}but_paypal&&but_paypal.length&&paypal.Buttons({style:{label:"pay",layout:"horizontal",color:"gold",height:42,shape:"rect",tagline:!1},createOrder:function(data,actions){var url=generateAPIEndpoint("create","paypal"),params={email:input_email.value||null,address:cbox_billing.checked?input_billing.value:null};settings_purchase.image&&(params.license=settings_purchase.image.license);settings_purchase.customization&&(params.asset_method=settings_purchase.image.payment);return fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(params)}).then(formatResponse).then(returnPaymentID)},onApprove:function(data,actions){disableForm();var url=generateAPIEndpoint("validate","paypal",data.orderID);return fetch(url,{method:"POST"}).then(formatResponse).then(function(response){enableForm(),1==response.success?onPurchaseSuccess(response):response.message&&"DECLINED"===response.message?alert("PayPal has declined this transaction"):alert("Error: There was a problem connecting to your PayPal account")})},onError:function(err){if(err&&err.message&&"Window navigated away"==err.message)return;showPayPalUnavailable();var log_detail=err.toString?err.toString():JSON.stringify(err);VectorStock.log({source:"PaymentBox",issue:"PayPal threw an error during payment",detail:log_detail})}}).render(but_paypal[0])}else{showPayPalUnavailable();var log_detail={paypal:window.paypal?"loaded":"unavailable"};VectorStock.log({source:"PaymentBox",issue:"PayPal object unavailable",detail:log_detail})}}(),function(){if(window.google&&bt_token){var gp_environment=VectorStock.isProduction()?"PRODUCTION":"TEST";window.braintree.client.create({authorization:bt_token}).then(function(clientInstance){return braintree.googlePayment.create({client:clientInstance,googlePayVersion:2,googleMerchantId:GOOGLE_MERCHANT_ID})}).then(function(googlePaymentInstance){var gp_client=new window.google.payments.api.PaymentsClient({environment:gp_environment,paymentDataCallbacks:{onPaymentAuthorized:function(paymentData){return new Promise(function(resolve,reject){googlePaymentInstance.parseResponse(paymentData,function(err,result){if(err){resolve({transactionState:"ERROR",error:{intent:"PAYMENT_AUTHORIZATION",message:"Payment failed - please check your card details.",reason:"PAYMENT_DATA_INVALID"}});var log_detail={error:err,result:result};VectorStock.log({source:"PaymentBox",issue:"Google Pay payment failed within popup",detail:log_detail})}else{disableForm();var url=generateAPIEndpoint("create","braintree"),email_address=paymentData.email||null,billing_address=null;try{billing_address=paymentData.paymentMethodData.info.billingAddress}catch(err){}var params={email:email_address,address:null,nonce:result.nonce,card:null,set_token:0,use_token:0,device_data:bt_device_data,billing_address:billing_address};settings_purchase.image&&(params.license=settings_purchase.image.license),settings_purchase.customization&&(params.asset_method=settings_purchase.image.payment),$.post(url,params).done(function(response){if(enableForm(),1==response.success)resolve({transactionState:"SUCCESS"}),onPurchaseSuccess(response);else{resolve({transactionState:"ERROR",error:{intent:"PAYMENT_AUTHORIZATION",message:response.error_message,reason:"PAYMENT_DATA_INVALID"}});var log_detail={response:response,result:result};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed to validate on VectorStock server",detail:log_detail})}}).fail(function(event){enableForm();var log_detail={event:event,result:result};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed to connect to VectorStock server",detail:log_detail}),alert("Error: There was a problem validating this payment")})}})})}}});gp_client.isReadyToPay({apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:googlePaymentInstance.createPaymentDataRequest().allowedPaymentMethods,existingPaymentMethodRequired:!0}).then(function(response){if(response.result){var button=gp_client.createButton({buttonColor:"black",buttonType:"long",onClick:function(event){var paymentDataRequest=googlePaymentInstance.createPaymentDataRequest({transactionInfo:{countryCode:"US",currencyCode:"USD",totalPriceStatus:"FINAL",totalPrice:total_cost_formatted,totalPriceLabel:"Total"},merchantInfo:{merchantId:GOOGLE_MERCHANT_ID,merchantName:"VectorStock"},emailRequired:!0});paymentDataRequest.callbackIntents=["PAYMENT_AUTHORIZATION"];var cardPaymentMethod=paymentDataRequest.allowedPaymentMethods[0];return cardPaymentMethod.parameters.billingAddressRequired=!0,cardPaymentMethod.parameters.billingAddressParameters={format:"FULL",phoneNumberRequired:!0},gp_client.loadPaymentData(paymentDataRequest).then(function(paymentData){googlePaymentInstance.parseResponse(paymentData,function(err,result){})}).catch(function(err){var log_detail={response:response,err:err};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to load payment data",detail:log_detail})})}});but_gpay[0].appendChild(button)}else{showGooglePayUnavailable();var log_detail={google:window.google?"loaded":"unavailable",response:response,token:bt_token?"exists":"unavailable"};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to setup payment",detail:log_detail})}}).catch(function(err){showGooglePayUnavailable();var log_detail={google:window.google?"loaded":"unavailable",error:err};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to check if ready",detail:log_detail})})}).catch(function(err){showGooglePayUnavailable();var log_detail={google:window.google?"loaded":"unavailable",token:bt_token?"exists":"unavailable",error:err};VectorStock.log({source:"PaymentBox",issue:"Google Pay failed trying to complete payment process",detail:log_detail})})}else{radioboxes_method.removeItem("gpay");var log_detail={google:window.google?"loaded":"unavailable",token:bt_token?"exists":"unavailable"};VectorStock.log({source:"PaymentBox",issue:"Google Pay object (or Braintree token) unavailable",detail:log_detail})}}(),recaptcha_required&&(page.attr("data-recaptcha","show"),grecaptcha.ready(function(){recaptcha_id=grecaptcha.render($("#cc-recaptcha",field_recaptcha)[0],{sitekey:GOOGLE_SITE_KEY,callback:function(response){hideErrorCard()},expired:function(){},error:function(){}}),refreshHeight()})),radioboxes_method.on("change",onMethodSelect),radioboxes_payment.on("change",onPaymentSelect),input_card_number.on("change",onNumberUpdate),cbox_billing.on("change",toggleFieldAddress),but_submit.on("click",onSubmit),but_close.on("click",function(){INSTANCE.dispatchEvent("close")}),INSTANCE.show(),setTimeout(function(){input_card_number.focus()},200)}function showGooglePayUnavailable(){var message=$('<div class="err_missing">Google Pay not available at this time</div>');but_gpay.empty().append(message)}function refreshHeight(){pane_content.outerHeight()>pane.outerHeight()?pane.addClass("scrolling"):pane.removeClass("scrolling")}function generateAPIEndpoint(type,provider,order_id){return"create"==type?settings_purchase.image?settings_purchase.customization?"/api/invoice/"+provider+"/customization/"+settings_purchase.image.id:"/api/invoice/"+provider+"/single-image/"+settings_purchase.image.id:"/api/invoice/"+provider+"/cart":"reprocess"==type?"/api/invoice/dps/purchase":"validate"==type?"/api/invoice/validate/"+order_id:""}function onMethodSelect(method){page.attr("data-method",method),footer.attr("data-method",method)}function onPaymentSelect(type){page.attr("data-payment",type),refreshHeight(),type==PaymentScreenPay.CARD_ADDITIONAL&&(pane.scrollTop(pane_content.height()-pane.height()),input_card_number.focus())}function toggleFieldAddress(){if(cbox_billing.checked?(field_billing.show(),input_billing.focus()):field_billing.hide(),refreshHeight(),cbox_billing.checked){var scroll_pos=field_billing.position().top+field_billing.height();pane.scrollTop(scroll_pos)}}function onNumberUpdate(number){function hideCardIcon(){input_card_cvv.input.attr("placeholder","CVV"),icon_card.removeClass("reveal"),setTimeout(function(){icon_card.attr("class","card")},200)}var type=$.payment.cardType(number);type?0<=CARD_ICONS.indexOf(type)?function(type){"amex"==type?input_card_cvv.input.attr("placeholder","CID"):input_card_cvv.input.attr("placeholder","CVV"),icon_card.attr("class","card reveal "+type)}(type):hideCardIcon():icon_card.hasClass("reveal")&&hideCardIcon()}function validateCardNumber(value){return $.payment.validateCardNumber(value)?(input_card_number.clearError(),!0):(showErrorCardNumber(RESPONSE_NUMBER_INVALID),!1)}function validateCardExpiry(value){var expiry=$.payment.cardExpiryVal(value);return $.payment.validateCardExpiry(expiry.month,expiry.year)?(input_card_expiry.clearError(),!0):(showErrorCardExpiry(RESPONSE_EXPIRY_INVALID),!1)}function validateCardCVV(value){var card_type=$.payment.cardType(input_card_number.value);return $.payment.validateCardCVC(value,card_type)?(input_card_cvv.clearError(),!0):(showErrorCardCVV(RESPONSE_CVV_INVALID),!1)}function validateEmail(value){return value.match(REGEX_EMAIL)?(input_email.clearError(),!0):(showErrorEmail(RESPONSE_EMAIL_INVALID),!1)}function showErrorCard(error_message,error_description){"card"==area_card.attr("data-error")?(message_error.removeClass("bounce"),timeout_animation&&clearTimeout(timeout_animation),setTimeout(function(){message_error.addClass("bounce"),timeout_animation=setTimeout(function(){message_error.removeClass("bounce")},1200)},20)):(area_card.attr("data-error","card"),message_error.empty(),message_error.append("<h6>"+error_message+"</h6>"),error_description&&message_error.append("<p>"+error_description+"</p>"),refreshHeight())}function hideErrorCard(){area_card.attr("data-error",""),message_error.empty(),refreshHeight()}function showErrorCardNumber(error){input_card_number.showError(error),monitor_number||(input_card_number.on("change",validateCardNumber),monitor_number=!0)}function showErrorCardExpiry(error){input_card_expiry.showError(error),monitor_expiry||(input_card_expiry.on("change",validateCardExpiry),monitor_expiry=!0)}function showErrorCardCVV(error){input_card_cvv.showError(error),monitor_cvv||(input_card_cvv.on("change",validateCardCVV),monitor_cvv=!0)}function showErrorEmail(error){input_email.showError(error),monitor_email||(input_email.on("change",validateEmail),monitor_email=!0)}function highlightFieldError(){for(var i=0;i<form_input_fields.length;i++)if(form_input_fields[i].hasError())return pane.scrollTop(form_input_fields[i].input.offset().top-pane_content.offset().top),form_input_fields[i].focus(),!0;return"card"==area_card.attr("data-error")}function generateRequestID(){var request={number:input_card_number.value,expiry_full:input_card_expiry.value,expiry:$.payment.cardExpiryVal(input_card_expiry.value),cvv:input_card_cvv.value,email:input_email.value};return recaptcha_required&&(request.recaptcha=grecaptcha.getResponse()),JSON.stringify(request).toLowerCase()}function maskCreditCardNumber(card_number){card_number=(card_number+"").replace(/\s+/g,"");var matches=/(\d{4})(\d+)(\d{4})/g.exec(card_number);if(!matches)return card_number;if((card_number=matches[1]+"".padStart(matches[2].length,"*")+matches[3]).length<14)return card_number;var match,card_type=$.payment.cardType(card_number);CARD_FORMATS[card_type]?CARD_FORMATS[card_type]:CARD_FORMATS._default;CARD_FORMATS[card_type]?(match=card_number.match(CARD_FORMATS[card_type])).length&&(match.shift(),card_number=match.join(" ")):(match=card_number.match(CARD_FORMATS._default)).length&&(card_number=match.join(" "));return card_number}function onSubmit(event){if((radioboxes_payment.value||null)!==PaymentScreenPay.CARD_SAVED){var card={number:input_card_number.value,expiry_full:input_card_expiry.value,expiry:$.payment.cardExpiryVal(input_card_expiry.value),cvv:input_card_cvv.value},request_id=generateRequestID();if(payment_attempts[request_id]){showPurchaseError(payment_attempts[request_id].type,payment_attempts[request_id].message),highlightFieldError();var log_detail={card:maskCreditCardNumber(card.number)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form retry fail (client)",detail:log_detail})}else hideErrorCard(),validateCardNumber(card.number),validateCardExpiry(input_card_expiry.value),validateCardCVV(card.cvv,card.number),recaptcha_required&&(0!==(recaptcha_value=grecaptcha.getResponse()).length||showErrorCard("Please tick the reCAPTCHA...")),logged_in||validateEmail(input_email.value)}if(highlightFieldError()){log_detail={};for(var i=0;i<form_input_fields.length;i++)if(form_input_fields[i].hasError()){var name=form_input_fields[i].input.attr("name"),value=form_input_fields[i].value;"card"==name&&(value=maskCreditCardNumber(value)),log_detail[name]=value}VectorStock.log({source:"PaymentBox",issue:"Credit Card form invalid (client)",detail:log_detail})}else if(disableForm(),radioboxes_payment.value==PaymentScreenPay.CARD_SAVED)submitToBraintree();else if(bt_client){if(2==bt_version)bt_client.tokenizeCard({number:card.number,expirationMonth:card.expiry.month,expirationYear:card.expiry.year,cvv:card.cvv},function(err,nonce){if(err){var log_detail={error:err};VectorStock.log({source:"PaymentBox",issue:"Braintree nonce could not be created (v2)",detail:log_detail})}else submitToBraintree(nonce,card,input_email.value)});else if(3==bt_version){var payment_data={creditCard:{number:card.number,cvv:card.cvv,expirationDate:card.expiry_full,options:{validate:!1}}};bt_client.request({endpoint:"payment_methods/credit_cards",method:"post",data:payment_data},function(err,response){if(err){var log_detail={error:err};VectorStock.log({source:"PaymentBox",issue:"Braintree nonce could not be created (v3)",detail:log_detail})}else submitToBraintree(response.creditCards[0].nonce,card,input_email.value)})}}else!function(card,email_address){var url=generateAPIEndpoint("create","dps"),params={card_number:card.number,card_month:card.expiry.month,card_year:card.expiry.year,card_cvv:card.cvv,email:email_address};submitToDPS(url,params)}(card,input_email.value);event.preventDefault()}function submitToBraintree(nonce,card,email_address){var url=generateAPIEndpoint("create","braintree"),params={email:email_address||null,address:cbox_billing.checked?input_billing.value:null,nonce:nonce||null,card:null,set_token:logged_in?Number(1==cbox_remember.checked):0,use_token:nonce?0:1,device_data:bt_device_data};null!==recaptcha_value&&(params.captcha=recaptcha_value),settings_purchase.image&&(params.license=settings_purchase.image.license),settings_purchase.customization&&(params.asset_method=settings_purchase.image.payment),$.post(url,params).done(function(response){if(1==response.success)onPurchaseSuccess(response);else if(0==response.attempts)showPurchaseError("attempts");else if(params.use_token)area_select.remove(),page.attr("data-payment",PaymentScreenPay.CARD_ADDITIONAL),showPurchaseError("stored_card"),input_card_number.focus();else if("processor"==response.error)!function(card,transaction_id,failover_token){var url=generateAPIEndpoint("reprocess","dps"),params={id:transaction_id,card_number:card.number,card_month:card.expiry.month,card_year:card.expiry.year,card_cvv:card.cvv,failover_token:failover_token};submitToDPS(url,params)}(card,response.id,response.failover_token);else if(response.code&&ERROR_DETAILS[response.code]){var error_details=ERROR_DETAILS[response.code];showPurchaseError(response.error,error_details.message,error_details.description)}else showPurchaseError(response.error,response.message)}).fail(function(event){showPurchaseError()})}function submitToDPS(url,params){$.post(url,params,function(response){if(VectorStock.log({source:"PaymentBox",action:"DPS Process Outcome",detail:response}),1==response.success)onPurchaseSuccess(response);else{var error_details=ERROR_DETAILS[response.code];error_details?showPurchaseError(response.error,error_details.message,error_details.description):showPurchaseError(response.error)}})}function showPurchaseError(error_type,error_message,error_description){error_type=String(error_type).toLowerCase();var request_id=generateRequestID();switch(payment_attempts[request_id]||(payment_attempts[request_id]={type:error_type,message:error_message}),error_type){case"expiry":case"expire_month":case"expire_year":showErrorCardExpiry(RESPONSE_EXPIRY_INVALID);var log_detail={reason:"Expiry date invalid",card_expiry:input_card_expiry.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"expired":showErrorCardExpiry(RESPONSE_EXPIRY_EXPIRED);log_detail={reason:"Card has expired",card_expiry:input_card_expiry.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"cvv":showErrorCardCVV(RESPONSE_CVV_INVALID);log_detail={reason:"CVV invalid",card_cvv:input_card_cvv.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"email":showErrorEmail(RESPONSE_EMAIL_INVALID);log_detail={reason:"Email invalid",email:input_email.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"empty_cart":alert("Cart is Empty - Please contact support for more information");log_detail={reason:"Empty cart"};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"found_purchase":showErrorCard("Already Purchased",RESPONSE_PRIOR_PURCHASE);log_detail={reason:"Already purchased"};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"no result":showErrorCard(RESPONSE_CARD_NORESULT);log_detail={reason:"No result",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"retry_token":showErrorCard(RESPONSE_CARD_NORESULT);log_detail={reason:"Retry Token Invalid",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"recaptcha":showErrorCard(RESPONSE_RECAPTCHA_FAILED),null!==recaptcha_id&&grecaptcha.reset(recaptcha_id);log_detail={reason:"Recaptcha check failed",captcha:recaptcha_value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"invalid":case"number":showErrorCardNumber(RESPONSE_NUMBER_INVALID);log_detail={reason:"Card number invalid",card_number:input_card_number.value};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"attempts":case"card_attempts":case"process_attempts":showErrorCard(RESPONSE_CARD_ATTEMPTS);log_detail={reason:"Too many card attempts",type:error_type};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"declined":showErrorCard(error_message||RESPONSE_CARD_DECLINED,error_description);log_detail={reason:"Card declined at server"};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"gateway_rejected":showErrorCard(RESPONSE_CARD_FLAGGED);log_detail={reason:"Card declined due to Braintree fraud protection",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;case"stored_card":showErrorCard(RESPONSE_SAVED_CARD_BAD);log_detail={reason:"Card already stored",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail});break;default:showErrorCard(RESPONSE_CARD_DECLINED);log_detail={reason:"Untracked server error",type:error_type||"(Not set)",card_number:maskCreditCardNumber(input_card_number.value)};VectorStock.log({source:"PaymentBox",issue:"Credit Card form failed",detail:log_detail})}enableForm()}function onPurchaseSuccess(response){VectorStock.trackPurchase(response.transaction.type,response.transaction.id,response.transaction.value,response.transaction.email,response.transaction.country,response.transaction.provider,response.transaction.txn_id),VectorStock.trackConversion({google_conversion_label:"IxeuCM-1m28QiJXH9wM",google_conversion_value:parseInt(response.transaction.value),google_conversion_currency:"USD"});var params=[response];settings_purchase.image&&params.push(settings_purchase.image.license),INSTANCE.dispatchEvent("purchase",params)}function disableForm(){container.addClass("disabled"),radioboxes_method.disable(),radioboxes_payment.disable(),input_email.disable().blur(),cbox_billing.disable(),input_billing.disable().blur(),input_card_number.disable().blur(),input_card_expiry.disable().blur(),input_card_cvv.disable().blur(),cbox_remember.disable(),field_recaptcha.addClass("disabled"),but_submit.prop("disabled",!0),but_submit_label.text("Processing"),but_submit_icon=$(".icon",but_submit).loadingIcon()}function enableForm(){container.removeClass("disabled"),radioboxes_method.enable(),radioboxes_payment.enable(),input_email.enable(),cbox_billing.enable(),input_billing.enable(),input_card_number.enable(),input_card_expiry.enable(),input_card_cvv.enable(),cbox_remember.enable(),field_recaptcha.removeClass("disabled"),but_submit.prop("disabled",!1),but_submit_label.text("Pay Now"),but_submit_icon.remove()}function close(){INSTANCE.dispatchEvent("close")}return INSTANCE.show=function(){container.addClass("show")},INSTANCE.hide=function(){container.removeClass("show")},pane=$("> .panel .pane",container),pane_content=$("> div",pane),page=$("#pbox_details_card",container),header_title=$(".header h1",container),area_method=$("#pbox_payment_method_select",container),area_select=$("#pbox_payment_card_select",container),area_card=$("#pbox_payment_details",container),area_contact=$("#pbox_payment_new_contact",container),footer=$(".footer",container),but_close=$('button[data-action="close"]',container),total_cost_decimal=settings_purchase.total_cost===parseInt(settings_purchase.total_cost,10)?settings_purchase.total_cost:settings_purchase.total_cost.toFixed(2),total_cost_formatted=total_cost_decimal.formatCommas(),screen_title=settings_purchase.image?settings_purchase.customization?settings_purchase.image.payment===VectorOptions.PAYMENT_SINGLEIMAGE?"Image &amp; Customization":"Pay for Customization":settings_purchase.upgrade?"License Upgrade":"Image Purchase":"Cart Purchase",header_title.html(screen_title+" (<small>$</small><em>"+total_cost_formatted+"</em>)"),but_close.on("click",close),icon_loading=container.parent().loadingIcon("large"),function loadUserPaymentData(){$.ajax({url:"/api/purchases/setup"}).done(function(response){void 0===response.credits&&void 0===response.downloads?(logged_in=response.logged_in,response.user_id||null,payment=response.payment||null,bt_token=response.bt_token,recaptcha_required=response.recaptcha||!1,loaded_setup=!0,page.attr("data-account",1==logged_in?"member":"guest"),page.attr("data-payment",payment?"saved":"new"),response.payment&&function(card_number,card_expiry){var card_type=$.payment.cardType(card_number);if(CARD_FORMATS[card_type]?CARD_FORMATS[card_type]:CARD_FORMATS._default,CARD_FORMATS[card_type]){var match=card_number.match(CARD_FORMATS[card_type]);match.length&&(match.shift(),card_number=match.join(" "))}else{var match=card_number.match(CARD_FORMATS._default);match.length&&(card_number=match.join(" "))}card_number=(card_number=card_number.replace(/(\.+[\.\s]+\.+)/,"<em>$1</em>")).replace(/\./g,"");var item=$('<li class="checked" />'),label=$('<label for="pbox_payment_saved" />').appendTo(item);$('<input type="radio" id="pbox_payment_saved" name="pbox_payment" value="saved" checked="checked">').appendTo(label),$('<span class="title">Card: '+card_number+' <span class="expiry">Exp. '+card_expiry+"</span></span>").appendTo(label),item.prependTo($("ul.radiobuttons",area_select))}(payment.card,payment.expiry),recaptcha_required&&function loadGoogleRecaptchaLibrary(){window.grecaptcha?(loaded_google_recaptcha=!0,isSetupReady()):$.ajax({url:URL_GOOGLE_RECAPTCHA,dataType:"script",cache:!0}).done(function(){loaded_google_recaptcha=!0,isSetupReady()}).fail(function(){loaded_google_recaptcha_attempts++<2?loadGoogleRecaptchaLibrary():(loaded_google_recaptcha=!1,VectorStock.log({source:"PaymentBox",issue:"Failed to load Google Recaptcha JS library",detail:"URL: "+URL_GOOGLE_RECAPTCHA}))})}(),isSetupReady()):window.location.reload(!0)}).fail(function(){loaded_setup_attempts++<2?loadUserPaymentData():(VectorStock.log({source:"PaymentBox",issue:"Failed to load payments setup",detail:"URL: /api/purchases/setup"}),INSTANCE.dispatchEvent("close"),setTimeout(function(){alert("Server unavailable - please contact customer support")},5))})}(),function loadPayPalLibrary(){window.paypal&&paypal.Button?(loaded_paypal=!0,isSetupReady()):$.ajax({url:URL_PAYPAL,dataType:"script",cache:!0}).done(function(){loaded_paypal=!0,isSetupReady()}).fail(function(){loaded_paypal_attempts++<2?loadPayPalLibrary():(loaded_paypal=!1,VectorStock.log({source:"PaymentBox",issue:"Failed to load PayPal JS library",detail:"URL: "+URL_PAYPAL}))})}(),function loadGooglePayLibrary(){window.google&&window.google.payments.api?(loaded_google_pay=!0,isSetupReady()):$.ajax({url:URL_GOOGLE_PAY,dataType:"script",cache:!0}).done(function(){loaded_google_pay=!0,isSetupReady()}).fail(function(){loaded_google_pay_attempts++<2?loadGooglePayLibrary():(loaded_google_pay=!1,VectorStock.log({source:"PaymentBox",issue:"Failed to load Google Pay JS library",detail:"URL: "+URL_GOOGLE_PAY}))})}(),INSTANCE};PaymentScreenPay.CARD_NEW="new",PaymentScreenPay.CARD_SAVED="saved",PaymentScreenPay.CARD_ADDITIONAL="additional";var PaymentScreenSuccess=function(screen,url_download,url_customization,next_step){var but_download,but_download_label,timeout_button,INSTANCE=new VSModule,HTML_SCREEN_IMAGE='<div class="header"><h1>Payment Success!</h1></div><div class="panel"><div class="pane reveal"><div class="feature"><div class="notice"><p><span class="icon"></span>We have emailed you the invoice and download link</p></div><figure></figure><div class="base"><button type="button" data-action="download"><span class="icon"><span class="icon_download"></span></span><span class="label">Download again</span></button><button type="button" data-action="return"><span class="label">Return to page...</span></button></div></div></div></div>',HTML_SCREEN_CUSTOMIZATION='<div class="header"><h1>Payment Success!</h1></div><div class="panel"><div class="pane reveal"><div class="feature"><div class="notice"><p><span class="icon"></span>We have emailed you the invoice and download link</p></div><figure></figure><div class="base"><p>Your designer is waiting to begin!</p><button type="button" data-action="next"><span class="label">Next Step - Create a design brief...</span></button></div></div></div></div>',TIME_DISABLE_BUTTON=5*MS_MINUTE;function triggerDownload(){VectorStock.goToURL(url_download)}function disableDownloadLink(){but_download&&(but_download.prop("disabled",!0).addClass("expired"),but_download_label.html("Link has now expired..."),but_download.off("click",triggerDownload))}return INSTANCE.show=function(){screen.addClass("show")},INSTANCE.hide=function(){timeout_button&&clearTimeout(timeout_button),screen.removeClass("show")},function(){var pane_content,but_next,but_next_label,but_return;null==url_customization?screen.attr("data-type","image").append(HTML_SCREEN_IMAGE):screen.attr("data-type","customization").append(HTML_SCREEN_CUSTOMIZATION),pane_content=$("> .panel .pane",screen),but_download=$('.feature button[data-action="download"]',pane_content),but_download_label=$("> .label",but_download),$("> .icon",but_download),but_next=$('.feature button[data-action="next"]',pane_content),but_next_label=$("> .label",but_next),but_return=$('.feature button[data-action="return"]',pane_content),$("> .label",but_download),but_close=$('button[data-action="close"]',screen),but_download.on("click",function(){VectorStock.isMobile()?INSTANCE.dispatchEvent("view_options"):triggerDownload()}),but_next.on("click",function(){VectorStock.goToURL(url_customization)}),but_return.on("click",function(event){event.preventDefault(),INSTANCE.dispatchEvent("close")}),but_close.on("click",function(event){INSTANCE.dispatchEvent("close")}),void 0!==url_customization?"signup"==next_step?but_next_label.html("Next Step - Create an account..."):"login"==next_step&&but_next_label.html("Next Step - Login to your account..."):url_download?VectorStock.isMobile()&&but_download_label.html("View download options..."):(but_download.remove(),VectorStock.isLoggedIn()&&$('<button type="button" data-action="download"><span class="label">View files for download...</span></button>').prependTo(".feature .base",pane_content).on("click",function(){VectorStock.goToURL("/transactions")}));but_download.length&&(timeout_button=setTimeout(disableDownloadLink,TIME_DISABLE_BUTTON)),INSTANCE.show(),url_download&&!VectorStock.isMobile()&&triggerDownload()}(),INSTANCE},PaymentBox=function(settings_image,settings_purchase,settings_customization){var image,images,INSTANCE=new VSModule;$.isArray(settings_image)?images=settings_image:image=settings_image;var overlay,screen_pay,screen_success,imageset,timeout_session_expiry,HTML_TEMPLATE='<div id="box-payment"><div class="pb-wrap"><div class="pb-sidebar"><div class="pb-screen"><div class="pb-content"><div class="imageset" data-images="1"></div><ul></ul></div><div class="pb-background"></div></div></div><div class="pb-screens"><div class="pb-screen" data-screen="pay"><div class="header"><h1></h1></div><div class="panel"><div class="pane reveal"><div id="pbox_details_card" data-account="" data-method="creditcard" data-payment=""><div id="pbox_payment_method_select" class="step"><h2><span class="point"></span><span class="title">Payment Method</span></h2><ul class="radiobuttons"><li class="checked"><label for="pbox_payment_method_creditcard"><input type="radio" id="pbox_payment_method_creditcard" name="pbox_payment_method" value="creditcard" checked="checked"><span class="title">Credit Card</span></label></li><li><label for="pbox_payment_method_paypal"><input type="radio" id="pbox_payment_method_paypal" name="pbox_payment_method" value="paypal"><span class="title">PayPal</span></label></li><li><label for="pbox_payment_method_gpay"><input type="radio" id="pbox_payment_method_gpay" name="pbox_payment_method" value="gpay"><span class="title">Google Pay</span></label></li></ul></div><div id="pbox_payment_card_select" class="step"><h2><span class="point"></span><span class="title">Select Card</span></h2><ul class="radiobuttons"><li><label for="pbox_payment_new"><input type="radio" id="pbox_payment_new" name="pbox_payment" value="additional"><span class="title">New credit card</span></label></li></ul></div><div id="pbox_payment_details" class="step"><h2><span class="point"></span><span class="title">Payment Details</span></h2><div class="message"></div><div class="fieldgroup" data-id="card"><fieldset data-field="card_number"><span class="icon"></span><input type="tel" id="pbox_card_number" name="card_number" class="number" placeholder="Card Number" maxlength="19" autocomplete="cc-number"><span class="card"></span></fieldset></div><div class="fieldgroup" data-id="meta"><fieldset data-field="card_expiry"><span class="icon"></span><input type="tel" id="pbox_card_expiry" name="card_expiry" class="expiry" placeholder="MM / YY" maxlength="9" autocomplete="cc-exp"></fieldset><fieldset data-field="card_cvv"><span class="icon"></span><input type="tel" id="pbox_card_cvv" name="card_cvv" placeholder="CVV" maxlength="4" autocomplete="off"></fieldset><label for="pbox_remember_card" class="checkbox checked"><span class="box"><input type="checkbox" id="pbox_remember_card" name="remember_card" checked="checked" value="1"></span><span class="title">Remember</span></label></div><div class="fieldgroup" data-id="recaptcha"><div id="cc-recaptcha"></div></div></div><div id="pbox_payment_new_contact" class="step"><h2><span class="point"></span><span class="title">Contact</span></h2><div class="fieldgroup" data-id="email"><fieldset data-field="email"><span class="icon"></span><input type="email" name="email" maxlength="100" autocomplete="email" autocorrect="off" autocapitalize="off" placeholder="Email address"></fieldset></div><label for="pbox_inc_billing_address" class="checkbox"><span class="box"><input type="checkbox" id="pbox_inc_billing_address" name="inc_billing_address" value="1"></span><span class="title">Add Billing address to invoice</span></label><div class="fieldgroup" data-id="address"><fieldset data-field="address"><textarea id="pbox_billing_address" name="billing_address" placeholder="Billing address"></textarea></fieldset></div></div></div></div></div><div class="footer" data-method="creditcard"><button type="submit" id="pbox-creditcard"><span class="label">Buy &amp; Download</span><span class="icon"><span></button><div id="paypal-button"></div><div id="gpay-button"></div></div><button data-action="close" type="button">Close</button></div><div class="pb-screen" data-screen="success"><button data-action="close" type="button">Close</button></div></div></div></div>',HTML_BANNER='<div class="pb-banner"><button type="button"><span class="label">You can also <strong>buy with Credits</strong> for <strong>$1 per image...</strong></span><span class="icon"></span></button></div>';function addImage(image_id,image_title){var figure;figure=$("<figure />").appendTo(imageset),$('<img width="238" height="250">').attr("src",VectorStock.imagePath(image_id,image_title,"medium")).attr("alt",image_title||"").appendTo(figure),$('<span class="inner" />').appendTo(figure)}function onClickOverlay(event){$(event.target)[0]==overlay[0]&&INSTANCE.close()}function onPurchase(transaction_response,image_license){screen_pay.hide();var url_customization,next_step,url_download=transaction_response.url;"zip"!==settings_purchase.filetype&&transaction_response.file_urls&&transaction_response.file_urls[settings_purchase.filetype]&&(url_download=transaction_response.file_urls[settings_purchase.filetype]),settings_customization&&(url_customization=transaction_response.job_url,next_step=transaction_response.next_step),(screen_success=new PaymentScreenSuccess($('.pb-screen[data-screen="success"]',screens),url_download,url_customization,next_step)).on("view_options",function(){INSTANCE.dispatchEvent("view_options"),INSTANCE.close()}),screen_success.on("close",function(){INSTANCE.close()}),images?EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Cart Popup",event:"Purchased"}):EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Purchase Popup",event:"Purchased"}),INSTANCE.dispatchEvent("purchase",[transaction_response,image_license,settings_purchase.total_cost])}return INSTANCE.close=function(){container&&container.remove(),overlay.remove(),clearTimeout(timeout_session_expiry),INSTANCE.dispatchEvent("close")},function(){if(overlay=$('<div class="overlay" />').css({height:$(document).height()}).appendTo("body").on("click",onClickOverlay),setTimeout(function(){overlay.addClass("reveal")}),function(){var sidebar,pb_screen,pb_content,sidebar_points,banner,total_cost_formatted=settings_purchase.total_cost;if("string"!=typeof total_cost_formatted&&(total_cost_formatted=(total_cost_formatted=total_cost_formatted.toFixed(2)).formatCommas()),container=$(HTML_TEMPLATE).appendTo(overlay),sidebar=$(".pb-sidebar",container),pb_screen=$(".pb-screen",sidebar).show(),pb_content=$(".pb-content",pb_screen),sidebar_points=$("ul",pb_content),screens=$(".pb-screens",container),images){var total_previews=Math.min(5,images.length);imageset=$(".imageset",pb_content).attr("data-images",total_previews);for(var i=total_previews;i--;)addImage(images[i]);var sb_html='<li><span class="dt">Total Cost</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>';sidebar_points.html(sb_html)}else{if(imageset=$(".imageset",pb_content).attr("data-images",1),addImage(image.id,image.title),settings_customization)if(image.license){var customization_cost_formatted=settings_customization.cost.toFixed(2);if(customization_cost_formatted=customization_cost_formatted.formatCommas(),image.payment===VectorOptions.PAYMENT_CREDITS)sb_html='<li><span class="dt">'+image.license.toTitleCase()+' License</span><span class="dm"></span><span class="dd"><em>'+image.cost+'</em> <abbr title="VectorStock Credits">CR</abbr></span></li>',sb_html+='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+customization_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>';else if(image.payment===VectorOptions.PAYMENT_SUBSCRIPTION)sb_html='<li><span class="dt">'+image.license.toTitleCase()+' License</span><span class="dm"></span><span class="dd"><em>'+image.cost+'</em> <abbr title="Subscription Download">DL</abbr></span></li>',sb_html+='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+customization_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>';else{var license_cost_formatted=image.cost.toFixed(2);license_cost_formatted=license_cost_formatted.formatCommas(),sb_html='<li><span class="dt">'+image.license.toTitleCase()+' License</span><span class="dm"></span><span class="dd"><small>$</small><em>'+license_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>',sb_html+='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+customization_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>',sb_html+='<li class="total"><span class="dt">Total Cost</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>'}}else sb_html='<li><span class="dt">Image Customization</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>';else sb_html='<li><span class="dt">License</span><span class="dm"></span><span class="dd">'+image.license+"</span></li>",sb_html+='<li><span class="dt">Cost</span><span class="dm"></span><span class="dd"><small>$</small><em>'+total_cost_formatted+'</em> <abbr title="United States Dollars">USD</abbr></span></li>';sidebar_points.html(sb_html)}screen_pay=new PaymentScreenPay($('.pb-screen[data-screen="pay"]',screens),images?{total_cost:settings_purchase.total_cost}:{image:image,customization:settings_customization,total_cost:settings_purchase.total_cost,upgrade:settings_purchase.upgrade}),settings_customization||(container.addClass("upsell").append(HTML_BANNER),banner=$(".pb-banner button",container)),screen_pay.on("purchase",onPurchase),screen_pay.on("close",INSTANCE.close),settings_purchase.upgrade?banner.parent().remove():banner&&banner.on("click",function(event){if(VectorStock.isLoggedIn()){var min_cost=Math.max(30,5*Math.ceil(Math.round(settings_purchase.total_cost)/5));images?VectorStock.goToURL("/purchase/credits/"+min_cost):VectorStock.goToURL("/purchase/credits/"+min_cost+"?id="+image.id)}else INSTANCE.close(),VectorStock.goToURL("/signup")}),$(window).height()<container.height()&&$(window).scrollTop(container.position().top),setTimeout(function(){container.addClass("reveal")})}(),VectorStock.isLoggedIn()&&(timeout_session_expiry=setTimeout(SignupBox.extendSession,SignupBox.TIME_EXPIRE)),images){var cart_snapshot={cart_tally:settings_purchase.total_images,cart_value:settings_purchase.total_cost};EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Cart Popup",event:"Initiated",cart:cart_snapshot})}else{var image_snapshot={id:image.id,value:settings_purchase.total_cost};EventTracker.track(EventTrackerLogger.ID_LOG,{source:"Purchase Popup",event:"Initiated",image:image_snapshot},!0)}}(),INSTANCE},CyberAnimationLine=function(xpos,thickness,length,color,frames,frame){var width,height,ymove,xmove,target_ypos,target_xpos,INSTANCE=new VSModule;return INSTANCE.x=null,INSTANCE.y=null,INSTANCE.complete=!1,INSTANCE.draw=function(context){INSTANCE.x+=xmove*CyberAnimationLine.speed,INSTANCE.y+=ymove*CyberAnimationLine.speed;var top_right=INSTANCE.x+width;context.beginPath(),context.moveTo(INSTANCE.x,INSTANCE.y),context.lineTo(INSTANCE.x,INSTANCE.y-thickness),context.lineTo(INSTANCE.x+width,INSTANCE.y-height),context.lineTo(INSTANCE.x+width,INSTANCE.y-height+thickness),context.lineTo(INSTANCE.x,INSTANCE.y),context.fillStyle="#"+color,context.fill(),frame+=CyberAnimationLine.speed,(frames<=frame||top_right<0)&&(INSTANCE.complete=!0)},height=(width=length)/CyberAnimationLine.settings.angle,target_xpos=xpos-(target_ypos=80+height+thickness)*CyberAnimationLine.settings.angle,ymove=target_ypos/frames,xmove=(target_xpos-xpos)/frames,INSTANCE.x=xpos+frame*xmove,INSTANCE.y=frame*ymove,INSTANCE};CyberAnimationLine.settings={angle:3.75,density:1e3,colors:["ed1c24","faa21b","fff200","ffffff"],thicknessMin:3,thicknessMax:7,lengthMin:50,lengthMax:150,framesMin:150,framesMax:300},CyberAnimationLine.speed=1;var CyberAnimation=function(canvas){var fps,context,INSTANCE=new VSModule,FPS_CUTOFF=50,FPS_INTERVAL=600,banner_width=$(window).width(),banner_height=80,max_lines=999,max_lines_perc=1,is_playing=!0,is_closed=!1,frame_count=0,lines=[],fps_times=[];function createLine(start_random){var line_xpos=Math.round(Math.random()*(banner_width+banner_height*CyberAnimationLine.settings.angle)),line_thickness=CyberAnimationLine.settings.thicknessMin+Math.floor(Math.random()*(CyberAnimationLine.settings.thicknessMax-CyberAnimationLine.settings.thicknessMin)),line_length=CyberAnimationLine.settings.lengthMin+Math.floor(Math.random()*(CyberAnimationLine.settings.lengthMax-CyberAnimationLine.settings.lengthMin)),line_color=CyberAnimationLine.settings.colors[Math.floor(Math.random()*CyberAnimationLine.settings.colors.length)],line_frames=CyberAnimationLine.settings.framesMin+Math.floor(Math.random()*(CyberAnimationLine.settings.framesMax-CyberAnimationLine.settings.framesMin)),line_frame=start_random?Math.floor(Math.random()*line_frames):0,line=new CyberAnimationLine(line_xpos,line_thickness,line_length,line_color,line_frames,line_frame);return lines.push(line),line}function updateMaxLines(){max_lines=Math.round(banner_width*banner_height/CyberAnimationLine.settings.density*max_lines_perc*max_lines_perc)}function onFrameAnimation(timestamp){if(!is_closed&&is_playing){context.clearRect(0,0,canvas[0].width,canvas[0].height),lines.length<max_lines&&createLine();for(var now=performance.now();0<fps_times.length&&fps_times[0]<=now-1e3;)fps_times.shift();fps_times.push(now),fps=fps_times.length;for(var i=lines.length;i--;)lines[i].draw(context),lines[i].complete&&lines.splice(i,1)}++frame_count%FPS_INTERVAL==0&&fps<FPS_CUTOFF&&(max_lines_perc*=.9,updateMaxLines()),is_closed?INSTANCE.dispatchEvent("closed"):window.requestAnimationFrame(onFrameAnimation)}return INSTANCE.pause=function(){is_playing=!1},INSTANCE.play=function(){is_playing=!0},INSTANCE.close=function(){is_closed=!0},function(){context=canvas[0].getContext("2d",{alpha:!0}),canvas[0].width=2*banner_width,canvas[0].height=2*banner_height,canvas[0].style.width=banner_width+"px",canvas[0].style.height=banner_height+"px",context.scale(2,2);var link=canvas.closest("a");for(link.on("mouseover",function(){CyberAnimationLine.speed=.25}),link.on("mouseout",function(){CyberAnimationLine.speed=1}),$(window).on("resize",function(){banner_width=$(window).width(),updateMaxLines(),canvas[0].width=2*banner_width,canvas[0].style.width=banner_width+"px",context.scale(2,2)}),updateMaxLines();lines.length<max_lines;)createLine(!0);window.requestAnimationFrame(onFrameAnimation)}(),INSTANCE},CyberTicker=function(container,timestamp_end){var int_update,digit_hours_1,digit_hours_2,digit_minutes_1,digit_minutes_2,digit_seconds_1,digit_seconds_2,INSTANCE=new VSModule,is_playing=!0;function update(){if(is_playing){var hours,minutes,seconds,timestamp_now=(new Date).getTime(),difference=timestamp_end-timestamp_now;difference<0?seconds=minutes=hours=0:difference<36e7?(hours=Math.floor(difference/36e5),minutes=Math.floor(difference%36e5/6e4),seconds=Math.floor(difference%6e4/1e3)):seconds=minutes=hours=99;var str_hours=hours.zeroPad(2),str_minutes=minutes.zeroPad(2),str_seconds=seconds.zeroPad(2);digit_hours_1.attr("data-value",str_hours.charAt(0)).text(str_hours.charAt(0)),digit_hours_2.attr("data-value",str_hours.charAt(1)).text(str_hours.charAt(1)),digit_minutes_1.attr("data-value",str_minutes.charAt(0)).text(str_minutes.charAt(0)),digit_minutes_2.attr("data-value",str_minutes.charAt(1)).text(str_minutes.charAt(1)),digit_seconds_1.attr("data-value",str_seconds.charAt(0)).text(str_seconds.charAt(0)),digit_seconds_2.attr("data-value",str_seconds.charAt(1)).text(str_seconds.charAt(1))}}return INSTANCE.pause=function(){is_playing=!1},INSTANCE.play=function(){is_playing||(is_playing=!0,update())},INSTANCE.close=function(){int_update&&clearInterval(int_update)},digit_hours_1=$("<span>0</span>").appendTo(container),digit_hours_2=$("<span>0</span>").appendTo(container),$('<span data-value=":">:</span>').appendTo(container),digit_minutes_1=$("<span>0</span>").appendTo(container),digit_minutes_2=$("<span>0</span>").appendTo(container),$('<span data-value=":">:</span>').appendTo(container),digit_seconds_1=$("<span>0</span>").appendTo(container),digit_seconds_2=$("<span>0</span>").appendTo(container),update(),int_update=setInterval(update,1e3),INSTANCE};$(function(){var banner=$("#banner-cyber-monday");if(banner.length){var animation=new CyberAnimation($("#banner-bg-animation",banner)),ticker=new CyberTicker($(".side_right .ticker",banner),new Date(banner.data("expires")).getTime());if($('button[name="but-close"]',banner).on("click",function(){animation.on("closed",function(){banner.remove()}),ticker.close(),animation.close(),document.cookie="promo_cyber_2020=1"}),animationCyclePart1(),window.IntersectionObserver)new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){entry.isIntersecting?(animation.play(),ticker.play()):(animation.pause(),ticker.pause())})},{root:null,rootMargin:"100px",threshold:0}).observe(banner[0])}function animationCyclePart1(){var part_1=$("#banner-message-part1");part_1.removeClass("state_a"),setTimeout(function(){part_1.addClass("state_b"),setTimeout(animationCyclePart2,500),setTimeout(function(){part_1.removeClass("state_b").addClass("state_a")},1e3)},4e3)}function animationCyclePart2(){var part_2=$("#banner-message-part2");part_2.removeClass("state_a"),setTimeout(function(){part_2.addClass("state_b"),setTimeout(animationCyclePart1,500),setTimeout(function(){part_2.removeClass("state_b").addClass("state_a")},1e3)},3e3)}});var SearchResultData=function(params,spelling){var TYPES={};TYPES[SearchResultData.TYPE_BROWSE]={title:"Royalty-Free Vector Images",header:"Royalty Free Vectors",path:"royalty-free-vectors"},TYPES[SearchResultData.TYPE_FREE]={title:"Free Vector Images",header:"Free Vector Art & Graphics",path:"free-vectors"},TYPES[SearchResultData.TYPE_PURCHASED]={title:"Your Purchases",header:"My Purchased Vectors",path:"purchased"},TYPES.pending_manage={title:"Manage Pending",header:"Pending",path:"manage-pending"},TYPES.pending_self={title:"Pending",header:"Pending",path:"pending"},TYPES.pending_artist={title:"Pending",header:"Pending",path:"manage-pending/vectors-by_"};var type=TYPES[params.type]||TYPES[SearchResultData.TYPE_BROWSE];params.type==SearchResultData.TYPE_PENDING&&(params.pending?params.pending==SearchResultData.TYPE_PENDING_SELF?type=TYPES.pending_self:(type=TYPES.pending_artist).path+=params.pending:type=TYPES.pending_manage);var path_url=[type.path],path_crumbs=[],title_window=type.title,title_header="",title_subheader=null,title_keywords=type.header,keywords=params.keywords||"",category=params.categories||null,custom_srp=params.custom_srp||null,artist=params.artists||null,similar=params.similar||null,page=(keywords.length,params.page||1),order=params.order;if(order||(order=0<keywords.length?SearchResults.ORDER_BESTMATCH:SearchResults.ORDER_TRENDING),keywords?(spelling&&(keywords=spelling.updated),title_window=(title_keywords=SearchBox.dictionary.formatKeywords(keywords))+" Vector Art",path_url[1]=keywords.replace(/\s+/g,"-").toLowerCase()+"-vectors",path_crumbs.push("<li><span>"+title_keywords+" vectors</span></li>"),params.type==SearchResultData.TYPE_FREE&&(title_window="Free "+title_window,title_keywords="Free "+title_keywords),title_keywords+=" vectors"):title_keywords=type.header,title_header+="<strong>"+title_keywords+"</strong>",category){var category_id=SearchBoxTag.termToURL(category),category_url=category_id+"-vectors",category_title=SearchBox.dictionary.getCategory(category_id)||category;title_window+=" within "+category_title,title_header+=" within <strong>"+category_title+"</strong>",path_url[0]=category_url,path_crumbs.unshift('<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemtype="http://schema.org/Thing" itemprop="item" href="/'+category_url+'"><span itemprop="name">'+category_title+"</span></a></li>")}if(custom_srp){var custom_srp_id=SearchBoxTag.termToURL(custom_srp),custom_srp_url=custom_srp_id,custom_srp_title=SearchBox.dictionary.getCustomSRP(custom_srp_id)||custom_srp;title_window+=" within "+custom_srp_title,title_header+=" within <strong>"+custom_srp_title+"</strong>",path_url[0]=custom_srp_url,path_crumbs.unshift('<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemtype="http://schema.org/Thing" itemprop="item" href="/'+custom_srp_url+'"><span itemprop="name">'+custom_srp_title+"</span></a></li>")}if(path_crumbs.unshift('<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemtype="http://schema.org/Thing" itemprop="item" href="/'+type.path+'"><span itemprop="name">'+type.header+" Vectors</span></a></li>"),artist){var artist_id=SearchBoxTag.termToURL(artist),artist_url="by_"+artist_id,artist_title=SearchBox.dictionary.getArtist(artist_id)||artist;is_following=VectorStock.userData.isFollowing(artist_id),button_label=is_following?"Following":"Follow",button_selected=is_following?"selected":"",logged_in=!!(VectorStock&&VectorStock.isLoggedIn&&VectorStock.isLoggedIn()),title_window+=" by "+artist_title,title_header+=' by <strong class="artist">'+artist_title+"</strong>",logged_in&&(title_header+='<button type="button" data-action="follow" data-artist="'+artist_title+'" class="'+button_selected+'" title="Follow Artists that you like to create a newsfeed of their recent images."><span class="label">'+button_label+"</span></button>"),path_url[1]=(path_url[1]||"vectors")+"-"+artist_url}if(similar&&(title_window+=" similar to #"+similar,title_header+=" similar to <strong>#"+similar+"</strong>",path_url[1]||(path_url[1]="vectors"),path_url[1]+="-similar-to_"+similar),params.type==SearchResultData.TYPE_PURCHASED||params.type==SearchResultData.TYPE_PENDING||0==keywords.length&&order==SearchResults.ORDER_TRENDING||0<keywords.length&&order==SearchResults.ORDER_BESTMATCH||custom_srp&&order==SearchResults.ORDER_BESTMATCH||0==keywords.length&&!category&&artist&&order==SearchResults.ORDER_BESTMATCH||path_url.push(path_url.pop()+"-order_"+order),1<page&&(title_window+=" - Page "+page,path_url.push(path_url.pop()+"-page_"+page)),spelling){title_header="Showing "+title_header,title_subheader="";var replacements=[],variations=1;for(var term in spelling.suggestions){for(var term_suggestions={term:term,suggestions:[]},i=0;i<spelling.suggestions[term].length;i++)term_suggestions.suggestions.push(spelling.suggestions[term][i]);replacements.push(term_suggestions),variations*=term_suggestions.suggestions.length}var suggestions=[];for(i=0;i<variations;i++){for(var query=spelling.original,j=0;j<replacements.length;j++){var regex=new RegExp("\\b"+replacements[j].term+"\\b","gi"),index=i%replacements[j].suggestions.length,replacement=replacements[j].suggestions[index];query=query.replace(regex,replacement)}if(query!==spelling.updated){var suggestion_url="/"+type.path+"/"+query.replace(/\s+/g,"-").toLowerCase()+"-vectors";suggestions.push('<a href="'+suggestion_url+'" class="alt">'+query+"</a>")}}0<(suggestions=suggestions.slice(0,2)).length&&(title_subheader+="Did you mean "+suggestions.join(" or ")+"? "),title_subheader+='Or show results for <a href="'+("/"+type.path+"/"+spelling.original.replace(/\s+/g,"-").toLowerCase()+"-vectors?noredirect=1")+'" class="original" rel="nofollow">'+spelling.original+"</a> instead..."}if(1===params.noredirect){var url_last_node=path_url[path_url.length-1],index_querystr=url_last_node.indexOf("?");if(0<=index_querystr){var query_str=url_last_node.substr(index_querystr+1),query_params=VectorStock.queryStringToParams(query_str);query_params.noredirect=1,url_last_node=url_last_node.substr(0,index_querystr+1)+$.param(query_params)}else url_last_node+="?noredirect=1";path_url[path_url.length-1]=url_last_node}return{url:VectorStock.formatURL("/"+path_url.join("/")),crumbs:path_crumbs.join(""),header:title_header,subheader:title_subheader,title:title_window}};SearchResultData.TYPE_BROWSE="browse",SearchResultData.TYPE_FREE="free",SearchResultData.TYPE_PURCHASED="purchased",SearchResultData.TYPE_PENDING="pending",SearchResultData.TYPE_PENDING_SELF="_self",SearchResultData.replaceKeywords=function(keywords,corrections){for(var mistake in corrections){var regex=new RegExp("\\b"+mistake+"\\b","gi");keywords=keywords.replace(regex,corrections[mistake])}return keywords};var SearchBoxDictionary=function(){var INSTANCE=VSModule(),KEYWORDS_FORMAT_HYPHENS=["x ray","t shirt"],KEYWORDS_FORMAT_UPPERCASE=["usa","wtf","omg","lol","nz","ny"],KEYWORDS_FORMAT_LOWERCASE=["a","an","and","are","as","at","be","but","by","do","for","if","in","into","is","it","no","nor","not","of","on","or","so","such","that","the","their","then","there","these","they","this","to","was","will","with","yet"];function addTerms(type,terms){for(var i=terms.length;i--;){var term_display=terms[i],term_id=SearchBoxTag.termToURL(term_display);INSTANCE[type][term_id]=term_display}}return INSTANCE.keywords={},INSTANCE.artists={},INSTANCE.categories={abstract:"Abstract","animals-wildlife":"Animals & Wildlife","artistic-experimental":"Artistic & Experimental","backgrounds-textures":"Backgrounds & Textures","beauty-fashion":"Beauty & Fashion","borders-frames":"Borders & Frames","buildings-landmarks":"Buildings & Landmarks","business-finance":"Business & Finance",cartoons:"Cartoons","celebration-party":"Celebration & Party","children-family":"Children & Family",christmas:"Christmas",cityscapes:"Cityscapes",communication:"Communication",computers:"Computers","copy-space":"Copy-Space",dancing:"Dancing","design-elements":"Design Elements","digital-media":"Digital Media","dj-dance-music":"DJ-Dance Music","document-template":"Document Template",easter:"Easter",education:"Education",entertainment:"Entertainment","flags-ribbons":"Flags & Ribbons","floral-decorative":"Floral & Decorative","fonts-type":"Fonts & Type","food-drink":"Food & Drink","game-assets":"Game Assets","geographical-maps":"Geographical & Maps",graffiti:"Graffiti","graphs-charts":"Graphs & Charts",grunge:"Grunge",halloween:"Halloween","healthcare-medical":"Healthcare & Medical",heraldry:"Heraldry",housing:"Housing","icon-emblem-(single)":"Icon & Emblem (single)","icons-emblems-(sets)":"Icon & Emblem (sets)",industrial:"Industrial",infographics:"Infographics",interiors:"Interiors","landscapes-nature":"Landscapes & Nature","marriage-engagement":"Marriage & Engagement",military:"Military",miscellaneous:"Miscellaneous",music:"Music","objects-still-life":"Objects & Still Life",packaging:"Packaging",patterns:"Patterns","patterns-(seamless)":"Patterns (seamless)",people:"People","photo-real":"Photo-Real",religion:"Religion",science:"Science",seasons:"Seasons","shopping-retail":"Shopping & Retail","signs-symbols":"Signs & Symbols",silhouettes:"Silhouettes","sports-recreation":"Sports & Recreation","t-shirt-graphics":"T-Shirt Graphics",technology:"Technology",telecommunications:"Telecommunications",transportation:"Transportation","urban-scenes":"Urban Scenes","user-interface":"User Interface","vacation-travel":"Vacation & Travel","valentines-day":"Valentines Day",vintage:"Vintage"},INSTANCE.custom_srps={icon:"Icon",icons:"Icons",logo:"Logo",logos:"Logos",background:"Background",backgrounds:"Backgrounds","t-shirt-graphic":"T-Shirt Graphic","t-shirt-graphics":"T-Shirt Graphics",christmas:"Christmas",halloween:"Halloween","day-of-the-dead":"Day of the Dead",wedding:"Wedding",weddings:"Weddings",thanksgiving:"Thanksgiving",infographic:"Infographic",infographics:"Infographics",tree:"Tree",trees:"Trees",floral:"Floral",flower:"Flower",flowers:"Flowers",summer:"Summer",easter:"Easter",coronavirus:"Coronavirus","coronavirus-icons":"Coronavirus Icons","coronavirus-backgrounds":"Coronavirus Backgrounds and Patterns","coronavirus-infographics":"Coronavirus Infographics and Stats"},INSTANCE.update=function(terms){terms&&(terms.keywords&&addTerms("keywords",terms.keywords),terms.artists&&addTerms("artists",terms.artists))},INSTANCE.getKeyword=function(keyword){return!!INSTANCE.keywords.hasOwnProperty(keyword)&&INSTANCE.keywords[keyword]},INSTANCE.getArtist=function(artist){return!!INSTANCE.artists.hasOwnProperty(artist)&&INSTANCE.artists[artist]},INSTANCE.getCategory=function(category){return!!INSTANCE.categories.hasOwnProperty(category)&&INSTANCE.categories[category]},INSTANCE.getCustomSRP=function(custom_srp){return!!INSTANCE.custom_srps.hasOwnProperty(custom_srp)&&INSTANCE.custom_srps[custom_srp]},INSTANCE.formatKeywords=function(keywords){return keywords=(keywords=keywords.replace(/[^\w\d\s-]/g," ").replace(/[\s-_]+/g," ").trim()).toTitleCase(),function(){for(var i=0;i<KEYWORDS_FORMAT_HYPHENS.length;i++)for(var search_all=new RegExp("\\b"+KEYWORDS_FORMAT_HYPHENS[i]+"\\b","gi"),matches_all=keywords.match(search_all)||[],j=0;j<matches_all.length;j++){var search_instance=new RegExp("\\b"+matches_all[j]+"\\b"),replacement_instance=matches_all[j].replace(" ","-");keywords=keywords.replace(search_instance,replacement_instance)}}(),function(){for(var i=0;i<KEYWORDS_FORMAT_UPPERCASE.length;i++){var search=new RegExp("\\b"+KEYWORDS_FORMAT_UPPERCASE[i]+"\\b","gi");keywords=keywords.replace(search,KEYWORDS_FORMAT_UPPERCASE[i].toUpperCase())}}(),function(){for(var i=0;i<KEYWORDS_FORMAT_LOWERCASE.length;i++){var search=new RegExp(" "+KEYWORDS_FORMAT_LOWERCASE[i]+"\\b","gi");keywords=keywords.replace(search," "+KEYWORDS_FORMAT_LOWERCASE[i].toLowerCase())}}(),keywords},INSTANCE};SearchBoxDictionary.WORDS_SKIP=["an?d?","are","art","as","at","artworks?","be","by","clip-?art","do","for","from","got","graphics?","it'?s?","into","images?","illustrat(ions?|ed|ive)","my","on","of","or","so","to","the","vectors?","with","where","were","your"];var SearchBoxRelated=function(nav){var no_results,is_open,container,INSTANCE=VSModule();function onClick(event){var item=$(this).parent(),list=item.parent().parent(),term=item.attr("data-term");"categories"==item.parents("div").attr("class")?VectorStock.search_box.setCategory(term):VectorStock.search_box.addSearchTerm(term),0==item.siblings().length&&list.hide(),item.remove(),event.preventDefault()}function populateList(type,list,terms,existing,max){if(terms&&0!=terms.length){for(var table={},i=existing?existing.length:0;i--;)table[existing[i]]=!0;for(var index=added=0;index<terms.length&&added<max;){var term_display=terms[index],term_url=SearchBoxTag.termToURL(term_display);if("categories"==type&&(term_display=term_display.replace("+"," &amp; ")),!table[term_url]){var url="/"+("keywords"==type?"royalty-free-vectors/":"")+term_url+"-vectors";"coronavirus"==term_url&&(url="/"+term_url);var item=$('<li data-term="'+term_display+'" />').appendTo(list);$('<a href="'+url+'" title="'+term_display+' vectors">'+term_display+"</a>").appendTo(item);added++}index++}return list.toggle(0<added),0<added}}return INSTANCE.open=function(){nav.addClass("expanded"),is_open=!0},INSTANCE.close=function(){nav.removeClass("expanded"),is_open=!1},INSTANCE.update=function(keywords,categories,is_all){if(kw_list.empty(),cg_list.empty(),is_all)INSTANCE.close();else{is_open||INSTANCE.open();var existing=VectorStock.search_box.getValue();populateList("keywords",kw_list,keywords,existing.keywords.split(/\s+/g),5),populateList("categories",cg_list,categories,[existing.categories],2);var total_categories=categories&&categories.length?categories.length:0;kw_area.toggle(""!==keywords),cg_area.toggle(0<total_categories),no_results.toggle(!(keywords||total_categories))}},is_open=nav.hasClass("expanded"),0==nav.children().length?($("<h4>Related</h4>").appendTo(nav),container=$("<div />").appendTo(nav),kw_area=$('<div class="keywords" />').appendTo(container),kw_list=$("<ul />").appendTo(kw_area),cg_area=$('<div class="categories" />').appendTo(container),cg_list=$("<ul />").appendTo(cg_area),$('<span class="icon" />').prependTo($("> div",container))):(container=$("> div",nav),kw_area=$(".keywords",container),kw_list=$("ul",kw_area),cg_area=$(".categories",container),cg_list=$("ul",cg_area)),(no_results=$("p",container)).length||(no_results=$("<p>No related terms found</p>").hide().appendTo(container)),nav.on("click","a",onClick),INSTANCE},SearchBoxSuggestions=function(box){var fieldset_sbs,suggestions,input,INSTANCE=VSModule(),URL_AUTOCOMPLETE="/api/search/autocomplete",MIN_CHARS=1,MAX_SUGGESTIONS_GROUP=6,MAX_SUGGESTIONS_ALL=10;INSTANCE.visible=null;var timeout_load,mem_suggestions=INSTANCE.loading=null,current_term=null;function onMouseOver(){$("li.highlight",suggestions).removeClass("highlight"),$(this).addClass("highlight")}function onMouseOut(){$(this).removeClass("highlight")}function onSelect(event){var term_id=$(this).attr("data-term"),context=$(this).parents(".group").attr("data-context");INSTANCE.toggle(),INSTANCE.dispatchEvent("selectItem",[term_id,context])}function setListeners(){suggestions.on("mouseover","li",onMouseOver).on("mouseout","li",onMouseOut).on("click","li",onSelect)}function onClickOutside(event){$(event.target).parents().is(suggestions)?event.preventDefault():INSTANCE.toggle(!1)}function populateSuggestions(term_id,results){var is_results=!1;if(term_id.length>=MIN_CHARS){var list=$("div",suggestions).empty(),items_all=0,populateGroup=function(context){for(var group=$('<div class="group" data-context="'+context+'" />'),terms=($("<h6>"+context+"</h6>").appendTo(group),$("<ul />").appendTo(group)),items=0,i=0;i<results[context].length&&i<MAX_SUGGESTIONS_GROUP&&(items_all<MAX_SUGGESTIONS_ALL||0==i);){var rterm=results[context][i],search=(SearchBoxTag.termToURL(rterm),new RegExp("("+term_id.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")","i"));$('<li data-term="'+rterm+'">'+rterm.replace(search,"<em>$1</em>")+"</li>").appendTo(terms);items++,items_all++,is_results=!0,i++}items&&group.appendTo(list)};for(var context in results)populateGroup(context);INSTANCE.toggle(is_results),INSTANCE.loading=!1}else INSTANCE.toggle(!1)}return INSTANCE.toggle=function(show){show!==INSTANCE.visible&&(show=null==show?!INSTANCE.visible:show,box.toggleClass("open",show),suggestions.toggle(show),show?$(document).one("mousemove",setListeners).on("mousedown",onClickOutside):($(document).off("mousemove",setListeners).off("mousedown",onClickOutside),suggestions.off("mouseover","li",onMouseOver).off("mouseout","li",onMouseOut).off("click","li",onSelect),$("li.highlight",suggestions).removeClass("highlight")),INSTANCE.visible=show)},INSTANCE.update=function(term){clearTimeout(timeout_load),term=(term=VectorStock.sanitizeInput(term)).toLowerCase(),mem_suggestions[term]?populateSuggestions(term,mem_suggestions[term]):timeout_load=setTimeout(function(){var term_id;current_term=term_id=term,$.ajax({url:URL_AUTOCOMPLETE,data:{prefix:encodeURIComponent(term_id)},dataType:"json",type:"GET"}).done(function(response){if(VectorStock.browserSupport("sessionStorage")&&JSON&&JSON.stringify)try{sessionStorage.autocomplete=JSON.stringify(mem_suggestions)}catch(e){}input.is(":focus")&&current_term===term_id&&populateSuggestions(term_id,response.results)}).fail(function(response){populateSuggestions(term_id,{keywords:null,artists:null,categories:null})}),term_id.length<MIN_CHARS?INSTANCE.toggle(!1):INSTANCE.loading||(INSTANCE.toggle(!1),INSTANCE.loading=!0)},350)},INSTANCE.selectedTerm=function(){var suggestion=$("li.highlight",suggestions);if(suggestion.length){var group=suggestion.closest(".group");return{term:suggestion.attr("data-term"),context:group.attr("data-context")}}return null},INSTANCE.moveHighlight=function(direction){var items=$("li",suggestions),length=items.length;if(0<length){var incumbent=items.filter(".highlight"),index=items.index(incumbent)+direction;index=index<0?index<-1?length-1:length:index;var successor=$(items[index]);incumbent.removeClass("highlight"),0<successor.length&&successor.addClass("highlight")}},INSTANCE.cancelSearch=function(){current_term=null,clearTimeout(timeout_load),INSTANCE.toggle(!1)},fieldset_sbs=$("fieldset",box),suggestions=$('<div class="suggestions" />').append("<div />").appendTo(fieldset_sbs),input=$("input[type=text]",fieldset_sbs),INSTANCE.visible=!1,INSTANCE.loading=!1,mem_suggestions=VectorStock.browserSupport("sessionStorage")&&sessionStorage.autocomplete?JSON.parse(sessionStorage.autocomplete):{},INSTANCE},SearchBoxTag=function(list_or_item,context,label){var tag_list,tag_item,tag_button,INSTANCE=VSModule();return INSTANCE.context=null,INSTANCE.label=null,INSTANCE.value=null,INSTANCE.remove=function(suppress_bubbling){return tag_item.remove(),suppress_bubbling||INSTANCE.dispatchEvent("remove"),null},INSTANCE.update=function(label){INSTANCE.label=label,INSTANCE.value=SearchBoxTag.termToURL(label),tag_label.html(INSTANCE.label),tag_item.attr("data-value",INSTANCE.value)},list_or_item.is("ul")?(INSTANCE.context=context,INSTANCE.label=label,INSTANCE.value=SearchBoxTag.termToURL(label),tag_list=list_or_item,tag_item=$('<li data-context="'+INSTANCE.context+'" data-value="'+INSTANCE.value+'" />').appendTo(tag_list),tag_label=$('<span class="label">'+INSTANCE.label+"</span>").appendTo(tag_item),tag_button=$('<button type="button"></button>').appendTo(tag_item)):(tag_list=list_or_item.parent(),tag_item=list_or_item,tag_label=$(".label",tag_item),tag_button=$("button",tag_item),INSTANCE.context=tag_item.data("context"),INSTANCE.label=tag_label.html(),INSTANCE.value=tag_item.data("value")),tag_button.on("click",function(){INSTANCE.remove()}),INSTANCE};SearchBoxTag.termToURL=function(term){return term=(term=(term=term+""||"").replace(/\s*&\s*|\s*\+\s*|\s+/g,"-")).toLowerCase()},SearchBoxTag.termToDisplay=function(term){return term.replace(/\+/g," & ")};var SearchBox=function(box){var fieldset,taglist,tag_artist,tag_category,tag_custom_srp,tag_similar,input,but_clear,submit,suggestions,is_empty,is_loading,last_search,INSTANCE=VSModule();function onInputFocus(){box.addClass("focused")}function onInputBlur(){box.removeClass("focused")}function onInputKeyPress(event){switch(event.keyCode=event.metaKey?224:event.keyCode,event.keyCode){case 16:case 17:case 18:case 224:break;case 13:var selected=suggestions.selectedTerm();selected?onSelectSuggestion(selected.term,selected.context):search(),event.preventDefault();break;case 38:case 40:if(suggestions.visible){var direction=event.keyCode<39?-1:1;suggestions.moveHighlight(direction),event.preventDefault()}break;default:onChange()}}function onChange(){setTimeout(function(){var term=$.trim(input.val());""!==term?suggestions.update(term):suggestions.cancelSearch(),updateEmptyStatus()},10)}function onSelectSuggestion(term,context){"keywords"==context?INSTANCE.setSearch(term,!0):"artists"==context?(input.val(""),INSTANCE.setArtist(term,!0)):"categories"==context&&INSTANCE.setCategory(term,!0),search()}function onSearchButtonClick(event){search(),event.preventDefault()}function onTagArtistRemove(){tag_artist=null,search()}function onTagCategoryRemove(){tag_category=null,search()}function onTagCustomSRPRemove(){tag_custom_srp=null,search()}function onTagSimilarRemove(){tag_similar=null,search()}function updateEmptyStatus(){is_empty=0==$("li",taglist).length&&""==input.val(),box.toggleClass("empty",is_empty)}function search(ignore_spelling){updateEmptyStatus(),last_search=INSTANCE.getValue(),ignore_spelling&&!0===ignore_spelling&&(last_search.noredirect=1),suggestions.cancelSearch(),INSTANCE.dispatchEvent("change",last_search)}return INSTANCE.box=box,INSTANCE.mode=SearchBox.MODE_DYNAMIC,INSTANCE.focus=function(){input.focus()},INSTANCE.empty=function(prevent_search){tag_artist&&(tag_artist=tag_artist.remove(!0)),tag_category&&(tag_category=tag_category.remove(!0)),tag_custom_srp&&(tag_custom_srp=tag_custom_srp.remove(!0)),tag_similar&&(tag_similar=tag_similar.remove(!0)),taglist.empty(),input.val(""),is_empty||prevent_search||search(),box.addClass("empty"),is_empty=!0,INSTANCE.dispatchEvent("empty")},INSTANCE.getValue=function(){var scope=$("#search_type").val();""!=scope&&"browse"!=scope||(scope=SearchResults.SCOPE_ALL);var keywords=input.val();return keywords=(keywords=(keywords=(keywords=keywords.replace(/<\/?\w+.*?>/g,"")).replace(/[^\w\s-_]/g,"")).replace(/\s+/g," ")).replace(/\b[_]+\b/g,""),{scope:scope,keywords:keywords=$.trim(keywords),artists:tag_artist?tag_artist.value:null,categories:tag_category?tag_category.value:null,custom_srp:tag_custom_srp?tag_custom_srp.value:null,similar:tag_similar?tag_similar.value:null}},INSTANCE.getSearchTerms=function(){return last_search&&last_search.keywords||""},INSTANCE.getSearch=function(){return input.val()},INSTANCE.setSearch=function(search_term,prevent_search,ignore_spelling){input.val(search_term),prevent_search?updateEmptyStatus():search(ignore_spelling)},INSTANCE.addSearchTerm=function(search_term){var search_terms=input.val().split(" ");search_terms.push(search_term),INSTANCE.setSearch(search_terms.join(" "))},INSTANCE.setArtist=function(label_artist,prevent_search){tag_category&&(tag_category=tag_category.remove(!0)),tag_custom_srp&&(tag_custom_srp=tag_custom_srp.remove(!0)),tag_custom_srp&&(tag_custom_srp=tag_custom_srp.remove(!0)),tag_similar&&(tag_similar=tag_similar.remove(!0)),tag_artist?tag_artist.update(label_artist):(tag_artist=SearchBoxTag(taglist,"artist",label_artist)).on("remove",onTagArtistRemove),prevent_search?updateEmptyStatus():search()},INSTANCE.setCategory=function(label_category,prevent_search){tag_custom_srp&&(tag_custom_srp=tag_custom_srp.remove(!0)),tag_artist&&(tag_artist=tag_artist.remove(!0)),tag_similar&&(tag_similar=tag_similar.remove(!0)),tag_category?tag_category.update(label_category):(tag_category=SearchBoxTag(taglist,"category",label_category)).on("remove",onTagCategoryRemove),prevent_search?updateEmptyStatus():search()},INSTANCE.setCustomSRP=function(label_custom_srp,prevent_search){tag_category&&(tag_category=tag_category.remove(!0)),tag_artist&&(tag_artist=tag_artist.remove(!0)),tag_similar&&(tag_similar=tag_similar.remove(!0)),tag_custom_srp?tag_custom_srp.update(label_custom_srp):(tag_custom_srp=SearchBoxTag(taglist,"custom_srp",label_custom_srp)).on("remove",onTagCustomSRPRemove),prevent_search?updateEmptyStatus():search()},INSTANCE.setSimilar=function(label_similar,prevent_search){tag_artist&&(tag_artist=tag_artist.remove(!0)),tag_category&&(tag_category=tag_category.remove(!0)),tag_custom_srp&&(tag_custom_srp=tag_custom_srp.remove(!0)),input.val(""),tag_similar?tag_similar.update(label_similar):(tag_similar=SearchBoxTag(taglist,"similar",label_similar)).on("remove",onTagSimilarRemove),prevent_search?updateEmptyStatus():search()},INSTANCE.setValue=function(search_state,prevent_search){INSTANCE.empty(!0),search_state.keywords&&INSTANCE.setSearch(search_state.keywords,!0),search_state.artists&&INSTANCE.setArtist(search_state.artists,!0),search_state.categories&&INSTANCE.setCategory(search_state.categories,!0),search_state.custom_srp&&INSTANCE.setCustomSRP(search_state.custom_srp,!0),search_state.similar&&INSTANCE.setSimilar(search_state.similar,!0),prevent_search?updateEmptyStatus():search()},INSTANCE.setStatus=function(status){status==SearchBox.STATUS_LOADING?is_loading||(submit.prop("disabled",!0),submit.loadingIcon(),is_loading=!0):is_loading&&(submit.prop("disabled",!1),$(".vs_loadicon",submit).remove(),is_loading=!1)},INSTANCE.setMode=function(mode){INSTANCE.mode=mode},INSTANCE.reload=function(){INSTANCE.dispatchEvent("change",INSTANCE.getValue())},function(){fieldset=$("fieldset",box),taglist=$(".tags ul",fieldset),input=$(".input input[type=text]",fieldset),but_clear=$('.input button[data-action="clear"]',fieldset),submit=$("button[type=submit]",box),suggestions=SearchBoxSuggestions(box);var item_artist=$('li[data-context="artist"]',taglist);item_artist.length&&(tag_artist=SearchBoxTag(item_artist)).on("remove",onTagArtistRemove);var item_category=$('li[data-context="category"]',taglist);item_category.length&&(tag_category=SearchBoxTag(item_category)).on("remove",onTagCategoryRemove);var item_custom_srp=$('li[data-context="custom_srp"]',taglist);item_custom_srp.length&&(tag_custom_srp=SearchBoxTag(item_custom_srp)).on("remove",onTagCustomSRPRemove);var item_similar=$('li[data-context="similar"]',taglist);item_similar.length&&(tag_similar=SearchBoxTag(item_similar)).on("remove",onTagSimilarRemove),is_loading=!(is_empty=!0),is_empty=0==$("li",taglist).length&&""==input.val(),last_search=null,box.toggleClass("empty",is_empty),fieldset.on("click",INSTANCE.focus),input.on("focus",onInputFocus).on("blur",onInputBlur).on("keydown",onInputKeyPress).on("paste",onChange),but_clear.on("click",function(){INSTANCE.empty()}),submit.on("click",onSearchButtonClick),suggestions.on("selectItem",onSelectSuggestion),input.setCaretPosition(input.val().length)}(),INSTANCE};SearchBox.STATUS_LOADING="loading",SearchBox.STATUS_READY="ready",SearchBox.MODE_DYNAMIC="dynamic",SearchBox.MODE_STATIC="static",SearchBox.dictionary=SearchBoxDictionary();var SearchLoadBar=function(){var container,bar,INSTANCE=VSModule(),ID_NAMESPACE="bar_loading",DURATION_LATENCY=1e3,DURATION_WAITING=5e3,LOAD_POINTS=[0,40,60,100];return INSTANCE.update=function(percent){var wide=LOAD_POINTS[2]+Math.round(percent*(100-LOAD_POINTS[2]))+"%";bar.stop().animate({width:wide},300,"easeOutQuad")},INSTANCE.complete=function(){bar.stop().animate({width:"100%"},500,"easeOutCubic"),setTimeout(function(){container.animate({opacity:0},750,"easeOutCubic",function(){container.remove()})},2e3)},$("#"+ID_NAMESPACE).remove(),container=$('<div id="'+ID_NAMESPACE+'" />').appendTo("body"),(bar=$("<div />").appendTo(container)).animate({width:LOAD_POINTS[1]+"%"},DURATION_LATENCY,"easeInCubic",function(){bar.animate({width:LOAD_POINTS[2]+"%"},DURATION_WAITING)}),INSTANCE},SearchBubble=function(header){var container,inner,contents,link,but_close,INSTANCE=VSModule(),is_open=!1;function open(){is_open||(container.appendTo(header),container.stop().hide().slideDown(300,"easeOutCubic"),inner.stop().hide().fadeIn(300),is_open=!0)}function close(){is_open&&(container.stop().slideUp(300,"easeOutCubic",function(){container.detach()}),inner.stop().fadeOut(300),INSTANCE.term=null,INSTANCE.type=null,INSTANCE.name=null,INSTANCE.url=null,is_open=!1)}function saveAndClose(){INSTANCE.type!==SearchBubble.TYPE_FREE&&(SearchBubble.closed[INSTANCE.term]=!0),close()}function onLinkClick(){if(INSTANCE.type==SearchBubble.TYPE_FREE)VectorStock.search_results.setScope(SearchResults.SCOPE_ALL),VectorStock.search_box.dispatchEvent("change",VectorStock.search_box.getValue());else{if(INSTANCE.type==SearchBubble.TYPE_VECTOR)return!0;VectorStock.search_box.addTag(INSTANCE.name,INSTANCE.type,!0)}return close(),!1}return INSTANCE.term=null,INSTANCE.type=null,INSTANCE.name=null,INSTANCE.url=null,INSTANCE.hits=null,INSTANCE.set=function(params,response){if(params.type==SearchResults.SCOPE_FREE){var is_keywords=params.keywords&&params.keywords.length,is_artists=params.artists&&params.artists.length;if(is_keywords||is_artists){(params=$.extend({},params)).type=SearchResults.SCOPE_ALL;var data=new SearchResultData(params);INSTANCE.type=SearchBubble.TYPE_FREE,INSTANCE.name=$(data.header).text().replace(/^All /i,""),INSTANCE.term=INSTANCE.name,INSTANCE.hits=response.altresults&&response.altresults.hit_count||0,INSTANCE.url=data.url,contents.html("This was a Free vector search. <a></a>");var counter=0<INSTANCE.hits?"("+INSTANCE.hits.formatCommas()+")":"our";(link=$("a",contents).text("View "+counter+" Royalty-Free "+INSTANCE.name).attr("href",INSTANCE.url)).on("click",onLinkClick),open()}}else if(response.altresults&&1==params.page){var term,type,name,url,copy;if(term=response.altresults.term,type=response.altresults.type,name=response.altresults.name,url=response.altresults.url,INSTANCE.name!==name&&!SearchBubble.closed[name]){switch(type){case SearchBubble.TYPE_ARTIST:copy="We also have an Artist named <a></a>";break;case SearchBubble.TYPE_CATEGORY:copy="We also have a Category for <a></a>";break;case SearchBubble.TYPE_VECTOR:copy="We also have a Vector with the ID <a></a>"}contents.html(copy),link=$("a",contents).text(name).attr("href",url).attr("data-context",type),INSTANCE.term=term,INSTANCE.type=type,INSTANCE.name=name,INSTANCE.url=url,link.on("click",onLinkClick),open()}}},INSTANCE.update=function(params){if(is_open){var match_term=!1;if(params.keywords.length||params.artists.length)if(params.type==SearchResults.SCOPE_FREE&&INSTANCE.type==SearchBubble.TYPE_FREE)match_term=!0;else if(INSTANCE.term&&INSTANCE.term.toLowerCase)for(var i=params.keywords.length;i--;)if(params.keywords[i]==INSTANCE.term.toLowerCase()){match_term=!0;break}if(!match_term){for(var terms_by_id={},j=params.keywords.length;j--;)terms_by_id[params.keywords[i]]=!0;for(var term in SearchBubble.closed)terms_by_id[term]||delete SearchBubble.closed[term];close()}}},(container=$(".alternatives",header)).length?(inner=$("> div",container),$(".icon",inner),contents=$("p",inner),link=$("a",contents),but_close=$("button",inner),INSTANCE.term=link.text(),INSTANCE.type=link.data("context"),INSTANCE.name=link.text(),INSTANCE.url=link.attr("href"),link.on("click",onLinkClick),is_open=!0):(container=$('<div class="alternatives" />'),inner=$("<div />").appendTo(container),$('<span class="icon" />').appendTo(inner),contents=$("<p />").appendTo(inner),but_close=$("<button>Close</button>").appendTo(inner)),but_close.on("click",saveAndClose),INSTANCE};SearchBubble.TYPE_FREE="free",SearchBubble.TYPE_ARTIST="artists",SearchBubble.TYPE_VECTOR="vectors",SearchBubble.TYPE_CATEGORY="categories",SearchBubble.closed={};var SearchSimilar=function(sidebar){var container,search_list,tooltip,timeout_hoveritem,container_height,document_height,footer_height,INSTANCE=new VSModule,OFFSET_PADDING=19,offset_top=0,is_fixed=!1,is_over_link=!1,list_searches=[];function setSearchTermEvents(){container_height=container.outerHeight()+OFFSET_PADDING;var terms_list=$("li",search_list);terms_list.each(function(){for(var item=$(this),link=$("a",item),search_term=link.text(),image_ids=item.attr("data-ids").split(","),image_titles=item.attr("data-titles").split(","),images_list=[],i=0;i<image_ids.length;i++)images_list.push({id:image_ids[i],title:image_titles[i]});link.on("mouseover",function(){terms_list.removeClass("highlighted"),item.addClass("highlighted"),is_over_link=!0,tooltip?tooltip.update(item.position().top,images_list):(tooltip=new SearchSimilarTooltip(container,images_list,item.position().top)).on("mouseout",function(){tooltip&&!is_over_link&&(tooltip.remove(),tooltip=null,terms_list.removeClass("highlighted"))}),clearTimeout(timeout_hoveritem)}),link.on("mouseout",function(){is_over_link=!1,timeout_hoveritem=setTimeout(function(){tooltip&&!tooltip.mouseover&&(tooltip.remove(),tooltip=null,item.removeClass("highlighted")),timeout_hoveritem=null},10)}),link.on("click",function(event){var is_free_search=1==$("header nav.top li.selected").index(),event_label={position:item.index()+1,link:link.text(),search:VectorStock.search_box.getSearch(),scope:is_free_search?"free":"all",list:list_searches};VectorStock.track("send","event",{eventCategory:"Search: Similar Link",eventAction:"Click",eventLabel:JSON.stringify(event_label),transport:is_free_search?"beacon":null}),link.attr("href").match(/^\/royalty-free-vectors\//i)&&(item.addClass("selected"),VectorStock.search_box.empty(!0),VectorStock.search_box.setSearch(search_term),VectorStock.search_results.scrollToTop(),event.preventDefault())})})}function onResize(){container&&(offset_top=container.prev().offset().top+container.prev().outerHeight()-OFFSET_PADDING,document_height=$(document).height(),footer_height=$("body > footer").outerHeight(),onScroll())}function onScroll(){if(container){var pos_scroll=$(window).scrollTop(),remaining_space=document_height-pos_scroll-footer_height-OFFSET_PADDING,container_offset=0;remaining_space<container_height&&(container_offset=remaining_space-container_height),container.css({top:container_offset}),offset_top<=pos_scroll?is_fixed||(container.addClass("fixed"),is_fixed=!0):is_fixed&&(container.removeClass("fixed"),is_fixed=!1)}}return INSTANCE.set=function(searches){if(searches&&searches.length&&sidebar.length){container?search_list.empty():(container=$('<div id="related-searches"><p>Similar Premium Searches</p><ul></ul></div>').appendTo(sidebar),search_list=$("ul",container),onResize());for(var total_searches=Math.min(15,searches.length),i=0;i<total_searches;i++){for(var search_term=searches[i].search,search_url=searches[i].url,search_ids=[],search_titles=[],j=0;j<searches[i].results.length;j++)search_ids.push(searches[i].results[j].id),search_titles.push(searches[i].results[j].title);$('<li data-ids="'+search_ids.join(",")+'" data-titles="'+search_titles.join(",")+'"><a href="'+search_url+'">'+search_term+"</a></li>").appendTo(search_list)}setSearchTermEvents(),list_searches=[];for(j=0;j<searches.length;j++)list_searches.push(searches[j].search)}else INSTANCE.clear()},INSTANCE.clear=function(){container&&container.remove(),container=null},(container=$("#related-searches",sidebar)).length?(search_list=$("ul",container),setSearchTermEvents(),onResize()):container=null,$(window).on("resize",onResize).on("scroll",onScroll),INSTANCE},SearchSimilarTooltip=function(container,images,offset_y){var preview,image_list,timeout_leave,INSTANCE=new VSModule;function loadImage(link,image_src){var icon=link.loadingIcon("small"),image=new Image;image.onload=function(){icon.remove();var image=$('<span class="image" />').appendTo(link);image.css("background-image","url("+image_src+")"),setTimeout(function(){image.addClass("reveal")},10)},image.onerror=function(){icon.remove()},image.src=image_src}function populate(images){for(var images_str="",i=images.length;i--;)images_str+=images[i].id;if(images_str!=INSTANCE.images_str){image_list.empty();for(i=0;i<images.length;i++){var item=$("<li />").appendTo(image_list);loadImage($('<a href="'+VectorStock.vectorURL(images[i].id,images[i].title)+'" />').appendTo(item),VectorStock.imagePath(images[i].id,images[i].title))}INSTANCE.images_str=images_str}}return INSTANCE.images_str=null,INSTANCE.mouseover=!1,INSTANCE.update=function(new_offset_y,images){preview.css("top",new_offset_y),offset_y=new_offset_y,populate(images)},INSTANCE.remove=function(){preview.addClass("conceal"),setTimeout(function(){preview.remove()},500)},preview=$('<div class="preview" />').css("top",offset_y).appendTo(container),image_list=$("<ul />").appendTo(preview),populate(images),preview.on("mouseover",function(){clearTimeout(timeout_leave),INSTANCE.mouseover=!0}).on("mouseout",function(){INSTANCE.mouseover=!1,timeout_leave=setTimeout(function(){INSTANCE.dispatchEvent("mouseout")},100)}),setTimeout(function(){preview.addClass("reveal")},10),INSTANCE},SearchAlternative=function(header,init_container){var thumbs_list,search_obj,INSTANCE=VSModule(),container=init_container.length?init_container:null;function addImageThumb(image_id,image_url,image_src,image_title){var item=$("<li />").appendTo(thumbs_list),link=$('<a href="'+image_url+'" />').appendTo(item),image=new Image;image.onload=function(){$(image).attr({title:image_title+" vector",alt:image_title}).appendTo(link),setTimeout(function(){item.addClass("reveal")},10)},image.onerror=function(){item.remove()},image.src=image_src,link.on("click",function(){EventTracker.store("vs_search_referer",JSON.stringify(search_obj))})}return INSTANCE.parameters=null,INSTANCE.set=function(parameters){INSTANCE.parameters&&parameters.type==INSTANCE.parameters.type&&parameters.name==INSTANCE.parameters.name||"free"!==parameters.type&&"vectors"!==parameters.type||function(parameters){var title,thumbs,link_all,link_label;if(INSTANCE.parameters=parameters,container?container.empty():container=$('<div class="altresults" />').insertAfter(header),title=$("<h4 />").appendTo(container),thumbs=$('<div class="thumbs" />').appendTo(container),thumbs_list=$("<ul />").appendTo(thumbs),link_all=$('<a href="" class="premium" />').appendTo(container),link_label=$('<span class="label" />').appendTo(link_all),$('<span class="icon"></span>').appendTo(link_all),delete(search_obj=VectorStock.search_box.getValue()).similar,"free"==parameters.type)search_obj.scope=SearchResults.SCOPE_ALL,title.html('<strong><a href="'+parameters.url+'">Premium '+parameters.name+"</a></strong> ("+parameters.hit_count.formatCommas()+")"),link_all.attr("href",parameters.url),link_label.html("More "+parameters.name+"");else if("vectors"==parameters.type){title.html("<strong>Image #"+parameters.name+"</strong>"),link_all.remove();var image_id=parameters.name,image_title=parameters.title,image_src=VectorStock.imagePath(image_id,image_title,"small");addImageThumb(0,parameters.url,image_src,image_title)}if(parameters.documents)for(var i=0;i<parameters.documents.length;i++)image_id=parameters.documents[i].id,image_title=parameters.documents[i].title,addImageThumb(0,parameters.documents[i].url,image_src=VectorStock.imagePath(image_id,image_title,"small"),image_title)}(parameters)},INSTANCE.remove=function(){container&&(container.remove(),container=null)},INSTANCE},SearchResults=function(settings){var INSTANCE=VSModule(),URL_SEARCH="/api/search",URL_PURCHASED="/api/template/purchased",URL_PENDING_ARTIST="/api/pending/artist",URL_PENDING_INSPECTOR="/api/pending",FLAG_TYPES={M:"Metadata",K:"Keywords",C:"Categories"},SEARCH_CACHE_LIMIT=10;INSTANCE.PAGE_LIMIT=100,INSTANCE.PAGE_LIMIT_PENDING=100;var pagination,fs_order,fs_order_items,opt_bestmatch,fs_layout,pagenumbers,results_none,results_fail,loadbar,scope=settings.scope,search_params=settings.params,search_cache={},search_current="",search_url=window.location.pathname,search_order="",search_layout="",search_scope="",search_page=1,search_pages=1,search_total=null,search_history=[],search_results={},search_events={},vectorset=[],order_set=!1,show_gallery=settings.gallery,show_cart=settings.cart,is_pending=!1,manage_pending=!1,preferred_filetype=!1;function getSearchID(params){var keys=[];return params.artists&&keys.push("artists="+params.artists),params.categories&&keys.push("categories="+params.categories),params.custom_srp&&keys.push("custom_srp="+params.custom_srp),params.keywords&&keys.push("keywords="+params.keywords),params.order&&keys.push("order="+params.order),params.page&&keys.push("page="+params.page),params.scope&&keys.push("scope="+params.scope),params.similar&&keys.push("similar="+params.similar),params.type&&keys.push("type="+params.type),keys.join("&").toLowerCase()}function createVectors(init){for(var i=vectorset.length;i--;)vectorset[i].delete();vectorset=[];var results=[],search_obj=VectorStock.search_box.getValue();delete search_obj.similar,$("> ul > li",scope).each(function(){var vector=new SearchVector({scope:$(this),search:search_obj,gallery:show_gallery,cart:show_cart,layout:search_layout,pending:is_pending,filetype:preferred_filetype,download:settings.download});vectorset.push(vector),search_events[vector.id]&&vector.loadEventData(search_events[vector.id]),init&&results.push({id:vector.id,title:vector.title,artist_id:vector.artist_id})}),init&&(search_results.results=results)}function updatePagination(results){results&&(search_url=results.url||"",search_pages=results.pages||1);var url_base=search_url.replace(/-page_\d+$/gi,"");if($(".prev",pagination).prop("disabled",search_page<=1),$(".next",pagination).prop("disabled",search_page==search_pages),pagenumbers.empty(),5<search_pages){var stack=[],from=search_page-1,to=search_page+1;from<1?(from=1,to++):search_pages<to&&(from--,to=search_pages);for(var i=from;i<=to;)stack.push(i),i++;1<from&&(2<from&&stack.unshift(null),stack.unshift(1)),to<search_pages&&to+1<search_pages&&stack.push(null);for(var j=0;j<stack.length;){var value=stack[j],item=$("<li />").toggleClass("selected",value==search_page).appendTo(pagenumbers);if(value){var url=url_base+(1<value?"-page_"+value:"");item.append('<a href="'+url+'">'+value.formatCommas()+"</a>")}else item.addClass("period").text("...");j++}}else for(i=1;i<=search_pages;){url=url_base+(1<i?"-page_"+i:"");$('<li><a href="'+url+'">'+i.formatCommas()+"</a></li>").toggleClass("selected",i==search_page).appendTo(pagenumbers),i++}}function jumpTo(page){if(is_pending){var search_data=new SearchResultData({type:"pending",page:page});VectorStock.goToURL(search_data.url)}else search_params.page=page,performSearch(SearchResults.SEARCH_PAGE)}function performSearch(type){var search_id=getSearchID(search_params);if(search_current=search_id,search_history.push(search_id),search_page=search_params.page||1,search_history.length>SEARCH_CACHE_LIMIT){for(var searches_recent=[],cutoff=Math.max(0,search_history.length-SEARCH_CACHE_LIMIT),i=search_history.length;--i>=cutoff;)searches_recent[search_history[i]]=!0;for(var search_cache_id in search_cache)searches_recent[search_cache_id]||delete search_cache[search_cache_id]}if(search_params.keywords){var search_data=new SearchResultData(search_params);VectorStock.trackSearch(search_params.keywords,search_data.url,search_scope,search_data.title)}$("#previewpane").remove();var cached_response=search_cache[search_id];if(cached_response)type==SearchResults.SEARCH_NEW?updatePagination(cached_response):updatePagination(),loadbar&&loadbar.complete(),loadbar=null,scope.attr("data-loading",0),INSTANCE.populate(cached_response),INSTANCE.dispatchEvent(SearchResults.LOAD_CACHED,[type,cached_response,search_params]);else{type==SearchResults.SEARCH_NEW?function(){$("button",pagination).prop("disabled",!0),pagenumbers.empty();var item=$('<li class="period" />').appendTo(pagenumbers);item.loadingIcon&&item.loadingIcon()}():updatePagination(),scope.attr("data-loading",1),INSTANCE.dispatchEvent(SearchResults.LOAD_INIT,[type,search_params]),loadbar=SearchLoadBar();var url=URL_SEARCH;if(search_scope==SearchResults.SCOPE_PURCHASED&&(url=URL_PURCHASED),search_scope==SearchResults.SCOPE_PENDING){var artist=$("#pending_scope").val();url=artist?URL_PENDING_ARTIST+("_self"==artist?"":"/"+artist):URL_PENDING_INSPECTOR}var showFailMessage=function(response){loadbar&&loadbar.complete(),loadbar=null,showMessage(results_fail),scope.attr("data-loading",0),pagenumbers.empty(),INSTANCE.dispatchEvent(SearchResults.LOAD_FAILED,[response,search_params])};$.ajax({url:url,data:search_params,type:"GET",xhr:function(){var xhr=new window.XMLHttpRequest;return xhr.addEventListener("progress",function(event){event.lengthComputable&&loadbar&&loadbar.update(event.loaded/event.total)},!1),xhr}}).done(function(response){if(response){if(response.redirect)VectorStock.goToURL(response.redirect);else if(search_cache[search_id]=response,SearchBox.dictionary.update(response),search_current==search_id){if(response.is_vector&&0===response.results.length)return void VectorStock.goToURL(response.altresults.url);loadbar&&loadbar.complete(),loadbar=null,INSTANCE.populate(response),type==SearchResults.SEARCH_NEW&&updatePagination(response),scope.attr("data-loading",0),INSTANCE.dispatchEvent(SearchResults.LOAD_COMPLETE,[type,response,search_params])}}else showFailMessage(response)}).fail(showFailMessage)}}function showMessage(content){fs_order.hide(),fs_layout.hide(),scope.append(content)}function generateVectorHTML(data){var html="",id=new String(data.id),size=search_layout==SearchResults.LAYOUT_LARGE?"medium":"small",title=data.title+" vector"||"",path=title.replace(/[^\d\w\s-]+/g,"").replace(/[\s-]+/g,"-").toLowerCase()+"-"+id,href=is_pending?"/upload/"+id:"/royalty-free-vector/"+path,src=VectorStock.imagePath(id,title,size,is_pending);if(data.highlight?html+='<li class="artist-highlight" data-vector-id="'+id+'" data-vector-title="'+data.title+'" data-vector-artist-id="'+data.artist_id+'" data-vector-src="'+src+'">':html+='<li data-vector-id="'+id+'" data-vector-title="'+data.title+'" data-vector-artist-id="'+data.artist_id+'" data-vector-src="'+src+'">',html+='<a href="'+href+'" title="'+title+'">',html+='<span class="title">'+title+"</span>",html+='<span class="image"></span>',html+="</a>",data.event_data&&(search_events[id]=data.event_data),manage_pending){var flags=data.alert;if(html+='<div class="info">',html+='<span class="checkbox"></span>',html+="<ul>",data.artist_note&&(html+='<li title="'+data.artist_note+'" class="artist-note">i</li>'),flags)for(var j=0;j<flags.length;j++)html+='<li title="'+FLAG_TYPES[flags[j]]+' Missing" class="missing">'+flags[j]+"</li>";html+='<li title="Artist Score: '+data.artist_score+'" class="score" data-score="'+data.artist_score+'">'+data.artist_score+"</li>",html+="</ul>",html+="</div>"}return html+="</li>"}return INSTANCE.getValue=function(){return search_params},INSTANCE.syncCartButtons=function(){for(var i=0;i<vectorset.length;i++)vectorset[i].setCartState(VectorStock.userData.isInCart(vectorset[i].id))},INSTANCE.getPageIndex=function(){return[search_page,search_pages]},INSTANCE.setOrder=function(params){search_order=params.order||$("li.selected",fs_order_items).attr("data-value"),params.keywords.length?(order_set||(search_order=SearchResults.ORDER_BESTMATCH),opt_bestmatch.show()):(search_order==SearchResults.ORDER_BESTMATCH&&(search_order=SearchResults.ORDER_TRENDING,order_set=!1),opt_bestmatch.hide()),$("li.selected",fs_order_items).removeClass("selected"),$('li[data-value="'+search_order+'"]',fs_order_items).addClass("selected")},INSTANCE.search=function(params){INSTANCE.setOrder(params),(search_params=$.extend({},params)).page=params.page||1,search_params.order=search_order,search_params.limit=params.limit||INSTANCE.PAGE_LIMIT,search_params.type=params.type||search_scope,1===params.noredirect&&(search_params.noredirect=params.noredirect),(search_params.type==SearchResults.SCOPE_FREE&&search_params.categories||search_params.type==SearchResults.SCOPE_PURCHASED)&&(search_scope=SearchResults.SCOPE_ALL,search_params.type=SearchResults.SCOPE_ALL),performSearch(SearchResults.SEARCH_NEW)},INSTANCE.populate=function(dataset){search_events={},scope.empty();var is_results_exact=dataset.results&&dataset.results.length,is_results_expanded=dataset.initial_results&&dataset.initial_results.length;if(is_results_exact||is_results_expanded){fs_order.show(),fs_layout.show();var results_exact=0==dataset.total_hits?[]:dataset.initial_results||dataset.results,results_expanded=dataset.initial_results||0==dataset.total_hits?dataset.results:[],html="";if(results_exact.length){html+='<ul class="exact">';for(var i=0;i<results_exact.length;i++)html+=generateVectorHTML(results_exact[i]);html+="</ul>"}else 1==dataset.page&&(html+='<div class="empty"><p><strong>Empty space!</strong> Sorry, we couldnt find any exact matches.</p></div>');if(results_expanded.length){var title_label="Related vectors";if(dataset.seo.keywords){for(var title_keywords=[],j=0;j<dataset.seo.keywords.length;j++){var keyword=dataset.seo.keywords[j],data=new SearchResultData({type:search_params.type,keywords:keyword});title_keywords.push('<a href="'+data.url+'">'+keyword.toTitleCase()+"</a>")}title_label="Related vectors for <strong>"+title_keywords.join(" or ")+"</strong>"}html+='<div class="expanded title"><h1>'+title_label+'</h1><span class="pages">Page '+dataset.page.formatCommas()+" of "+dataset.pages.formatCommas()+"</span></div>",html+='<ul class="expanded">';for(var k=0;k<results_expanded.length;k++)html+=generateVectorHTML(results_expanded[k]);html+="</ul>"}scope[0].innerHTML=html,createVectors()}else if(search_params.type===SearchResults.SCOPE_FREE){var params=$.extend({},search_params);if(params.type=SearchResults.SCOPE_ALL,dataset.is_artist){var artist=dataset.is_artist;for(i=params.keywords.length;i--;)if(params.keywords[i]===artist){params.keywords.splice(i,1);break}params.artists.push(artist)}(data=new SearchResultData(params)).header=data.header.replace(/\bAll /,""),$("p a",results_none).attr("href",data.url),$("p strong",results_none).replaceWith(data.header),showMessage(results_none)}else showMessage(results_none)},INSTANCE.scrollToTop=function(speed,easing){speed=speed||500,easing=easing||"easeOutExpo";0<($("body").scrollTop()||$("html").scrollTop())&&VectorStock.scrollTo(0,speed,easing)},INSTANCE.setScope=function(scope){search_scope=scope},INSTANCE.togglePreviews=function(is_enabled){for(var i=vectorset.length;i--;)vectorset[i].togglePreview(is_enabled)},function(){if(pagination=$(".pagination"),pagination.filter("#pagination_top"),pagination.filter("#pagination_bot"),fs_order=$("fieldset.type_order",pagination),fs_order_items=$("> ul",fs_order),opt_bestmatch=$('li[data-value="bestmatch"]',fs_order_items),fs_layout=$("fieldset.type_layout",pagination),fs_layout_items=$("> ul",fs_layout),0==(pagenumbers=$("ul.pages",pagination)).length&&(pagenumbers=$('<ul class="pages" />').appendTo(pagination.last())),results_none=$('<div class="message"><h1>Sorry, there are no matches.</h1><p>Keep trying - here are a couple of tips:</p><ul><li>Check the spelling is correct</li><li>Use simpler search terms</li></ul><p>If you continue to have problems, visit the <a href="/contact">Contact page</a> to let us know.</p></div>'),results_fail=$('<div class="message"><h1>Hmmm... this search had problems loading.</h1><p>Try <a href="">reloading this page</a>.</p><p>If you\'re still having issues, <a href="/contact">please let us know.</a> and we\'ll do our best to address the problem.</p></div>'),$(window),search_order=$(".selected",fs_order_items).attr("data-value")||SearchResults.ORDER_LATEST,search_layout=$(".selected",fs_layout_items).attr("data-value")||SearchResults.LAYOUT_LARGE,search_scope=$("#search_type").val()||SearchResults.SCOPE_ALL,search_page=parseInt($("#search_page").val())||search_page,search_pages=parseInt($("#search_pages").val())||search_pages,search_total=parseInt($("#search_total").val())||search_pages,is_pending=search_scope==SearchResults.SCOPE_PENDING,is_pending_admin=is_pending&&"_self"!==$("#pending_scope").val(),manage_pending=$("body > article").hasClass("pending"),preferred_filetype=scope.attr("data-filetype")||!1,is_pending_admin&&(search_layout=SearchResults.LAYOUT_SMALL),fs_order_items.on("click","li",function(){var order;$("li.selected",fs_order_items).removeClass("selected"),$(this).addClass("selected"),search_order=$(this).attr("data-value"),search_page=1,search_order=order=search_order,search_params.page=1,search_params.order=order,order_set=!0,performSearch(SearchResults.SEARCH_REORDER)}),fs_layout_items.on("click","li",function(){$("li.selected",fs_layout_items).removeClass("selected"),$(this).addClass("selected"),function(layout){if(search_layout!=layout){search_layout=layout,scope.attr("data-layout",search_layout);for(var i=0;i<vectorset.length;)vectorset[i++].setSize(search_layout);document.cookie="layout="+search_layout+"; path=/",$(window).trigger("resize")}}($(this).attr("data-value"))}),pagination.on("click","button",function(){var button=$(this);jumpTo(search_page+=button.hasClass("prev")?-1:1),INSTANCE.scrollToTop(),setTimeout(function(){button.blur()},100)}),pagenumbers.on("click","li a",function(){var page_number=$(this).text().replace(/[^0-9]/g,"");return jumpTo(search_page=parseInt(page_number)),setTimeout(function(){INSTANCE.scrollToTop()},1),!1}),opt_bestmatch.length||is_pending||(opt_bestmatch=$('<li role="radio" data-value="bestmatch"><span class="icon"></span>Best Match</li>').prependTo(fs_order_items).hide()),search_params.page=search_page,search_params.order=search_order,search_params.type=search_scope,search_params.limit=INSTANCE.PAGE_LIMIT,is_pending){var pending_scope=$("#pending_scope").val();pending_scope&&(search_params.pending=pending_scope),search_params.limit=INSTANCE.PAGE_LIMIT_PENDING}search_current=getSearchID(search_params),search_history.push(search_current),search_results={url:window.location.pathname,page:search_page,pages:search_pages,total:search_total},createVectors(!0),search_cache[search_current]=search_results}(),INSTANCE};SearchResults.LOAD_INIT="load_init",SearchResults.LOAD_CACHED="load_cached",SearchResults.LOAD_COMPLETE="load_complete",SearchResults.LOAD_FAILED="load_failed",SearchResults.SCOPE_ALL="all",SearchResults.SCOPE_FREE="free",SearchResults.SCOPE_PENDING="pending",SearchResults.SCOPE_PURCHASED="purchased",SearchResults.SCOPE_FOLLOWING="following",SearchResults.SEARCH_NEW="new",SearchResults.SEARCH_PAGE="page",SearchResults.SEARCH_REORDER="reorder",SearchResults.ORDER_BESTMATCH="bestmatch",SearchResults.ORDER_TRENDING="trending",SearchResults.ORDER_LATEST="latest",SearchResults.LAYOUT_SMALL="small",SearchResults.LAYOUT_LARGE="large";var SearchVector=function(settings){var link,preview,image_wrap,image,score,info,viewport_height,viewport_top,timeout_view,INSTANCE=new VSModule,LOAD_ATTEMPTS_MAX=10,show_gallery=!1!==settings.gallery&&VectorStock.isLoggedIn(),show_cart=!1!==settings.cart,show_download=null,in_cart=!1,item_cart=null,button_cart=null,is_mobile=VectorStock.isMobile(),badge_type=!1,preferred_filetype=settings.filetype,image_loaded=!1;function trackEvent(event_type,event_delay){if(settings.search){if(settings.search.scope==SearchResults.SCOPE_ALL||settings.search.scope==SearchResults.SCOPE_FREE){var event={action:event_type,image:INSTANCE.id,search:settings.search.keywords};return settings.search.scope!==SearchResults.SCOPE_ALL&&(event.search_scope=settings.search.scope),settings.search.artists&&(event.search_artist=settings.search.artists),settings.search.categories&&(event.search_category=settings.search.categories),EventTracker.track(EventTrackerLogger.ID_SEARCH,event,event_delay),!0}}else if(settings.topic){var event_data={topic:settings.topic,action:event_type,image:INSTANCE.id,badge:badge_type};return EventTracker.track(EventTrackerLogger.ID_LOG,event_data,event_delay),!0}return!1}function onResize(){viewport_height=$(window).height(),viewport_top=$(window).scrollTop(),INSTANCE.dimensions.width=INSTANCE.item.width(),INSTANCE.dimensions.height=INSTANCE.item.height();var offset=INSTANCE.item.offset();INSTANCE.position.top=offset.top,INSTANCE.position.bottom=INSTANCE.position.top+INSTANCE.dimensions.height,INSTANCE.position.left=offset.left,INSTANCE.position.right=INSTANCE.position.left+INSTANCE.dimensions.width}function onScroll(){viewport_top=$(window).scrollTop()}function isReadyToShowImage(){!image_loaded&&isOnScreen(SearchVector.SCROLL_MARGIN)&&(loadImage(),$(window).off("resize scroll",isReadyToShowImage))}function isOnScreen(offset){var visible=INSTANCE.item.is(":visible"),below_the_top=(offset=offset||0,INSTANCE.position.bottom>viewport_top-offset),above_the_bottom=INSTANCE.position.top<viewport_top+viewport_height+offset;return visible&&below_the_top&&above_the_bottom}function loadImage(){var load_attempts=1,icon=image_wrap.loadingIcon();function loadAttempt(){var image=new Image;image.onload=onLoad,image.onerror=onError,image.src=INSTANCE.src}function onLoad(){icon.remove(),image=$('<img src="'+INSTANCE.src+'" alt="'+INSTANCE.title+'">').appendTo(image_wrap),setTimeout(function(){image.addClass("reveal"),onImageLoad()},10)}function onError(){if(load_attempts<LOAD_ATTEMPTS_MAX){var wait=500+Math.round(500*Math.random());setTimeout(loadAttempt,wait)}else{icon.remove();var icon_broken=$('<span class="icon_broken" />').appendTo(image_wrap);setTimeout(function(){icon_broken.addClass("reveal")},10)}load_attempts++}loadAttempt()}function onImageLoad(){SearchVector.observer_view?(INSTANCE.item.bind("onViewedImage",onViewedImage),SearchVector.observer_view.observe(INSTANCE.item[0])):($(window).on("resize scroll",isImageVisible),isImageVisible()),INSTANCE.dispatchEvent("loaded"),image_loaded=!0}function isImageVisible(){isOnScreen(-INSTANCE.dimensions.height/2)?timeout_view||(timeout_view=setTimeout(function(){$(window).off("resize scroll",isImageVisible)},SearchVector.TIME_VIEWED_DURATION)):timeout_view&&(clearTimeout(timeout_view),timeout_view=null)}function onViewedImage(){trackEvent("view",!0),INSTANCE.dispatchEvent("viewed")}function onClickImage(event){if($(event.target).hasClass(".expand"))return!1;trackEvent("click",!0)&&(settings.topic?EventTracker.store("vs_search_referer",JSON.stringify(settings.topic)):EventTracker.store("vs_search_referer",JSON.stringify(settings.search)))}function onHoverPreviewImage(){trackEvent("preview")}function selectCartButton(){button_cart&&button_cart.html("In Cart"),item_cart&&item_cart.addClass("selected")}function unselectCartButton(){button_cart&&button_cart.html("<em>Add to </em>Cart"),item_cart&&item_cart.removeClass("selected")}function toggleSelect(){INSTANCE.item.toggleClass("selected"),VectorStock.BarPending.toggle(INSTANCE.id)}return INSTANCE.item=settings.scope,INSTANCE.id=null,INSTANCE.title=null,INSTANCE.artist_id=null,INSTANCE.href=null,INSTANCE.src=null,INSTANCE.dimensions={width:0,height:0},INSTANCE.position={top:0,right:0,bottom:0,left:0},INSTANCE.setSize=function(layout){var size=layout==SearchResults.LAYOUT_LARGE?SearchVector.SIZE_MEDIUM:SearchVector.SIZE_SMALL;INSTANCE.size!==size&&(settings.layout=layout,INSTANCE.size=size,INSTANCE.src=VectorStock.imagePath(INSTANCE.id,INSTANCE.title,size,settings.pending),image.attr("src",INSTANCE.src),layout==SearchResults.LAYOUT_LARGE?preview.disable():preview.enable(),onResize())},INSTANCE.setCartState=function(in_cart){show_cart&&(in_cart?selectCartButton():unselectCartButton())},INSTANCE.loadEventData=function(event_data){function addGroupEntry(group,title,value,show_zero){(show_zero||0<value)&&$('<span><span class="dt">'+title+'</span><span class="dm"></span><span class="dd">'+value+"</span></span>").appendTo(group)}var popup,group_summary,group_events;score.length&&score.empty(),score=$('<span class="score" />').appendTo(link),popup=$('<span class="popup" />').appendTo(score),addGroupEntry(group_summary=$('<span class="group summary" />').appendTo(popup),"Rank",event_data.search_term_score,!0),addGroupEntry(group_summary,"Event Score",event_data.calc_event,!0),addGroupEntry(group_summary,"CTR",event_data.calc_ctr.toFixed(2)+"%",!0),addGroupEntry(group_events=$('<span class="group" />').appendTo(popup),"Views",event_data.event_served.formatCommas(),!0),addGroupEntry(group_events,"Clicks",event_data.event_clicks.formatCommas()),addGroupEntry(group_events,"Download Attempt",event_data.event_dattempt.formatCommas()),addGroupEntry(group_events,"Download Comp.",event_data.event_dcomp.formatCommas()),addGroupEntry(group_events,"Add to Cart",event_data.event_cart.formatCommas()),addGroupEntry(group_events,"Add to Gallery",event_data.event_gallery.formatCommas()),event_data.event_likes&&addGroupEntry(group_events,"Likes",event_data.event_likes.formatCommas()),addGroupEntry(group_events,"Purchases",event_data.event_purchase.formatCommas())},INSTANCE.updateState=function(){onResize(),isReadyToShowImage()},INSTANCE.togglePreview=function(is_enabled){is_enabled?preview.enable():preview.disable()},INSTANCE.delete=function(){timeout_view&&clearTimeout(timeout_view),$(window).off("resize",onResize).off("scroll",onScroll).off("resize scroll",isImageVisible)},function(){INSTANCE.item.parent(),link=$("a",INSTANCE.item),image_wrap=$(".image",link),image=$("img",link),score=$(".score",link),info=$(".info",INSTANCE.item),INSTANCE.id=parseInt(INSTANCE.item.attr("data-vector-id")),INSTANCE.title=INSTANCE.item.attr("data-vector-title"),INSTANCE.artist_id=INSTANCE.item.attr("data-vector-artist-id"),INSTANCE.size=settings.layout==SearchResults.LAYOUT_LARGE?SearchVector.SIZE_MEDIUM:SearchVector.SIZE_SMALL,INSTANCE.href=VectorStock.vectorURL(INSTANCE.id,INSTANCE.title,settings.pending),INSTANCE.src=VectorStock.imagePath(INSTANCE.id,INSTANCE.title,INSTANCE.size,settings.pending),preview=new PreviewLink(link,INSTANCE.id,INSTANCE.title,settings.pending),(INSTANCE.size==SearchVector.SIZE_MEDIUM||is_mobile)&&preview.disable(),VectorStock.userData.isInCart(INSTANCE.id)&&(in_cart=!0),show_download=settings.download||VectorStock.userData.hasPurchased(INSTANCE.id)||VectorStock.userData.isArtist(INSTANCE.artist_id);var badge=$(".badge",link);badge_type=!!badge.length&&badge.attr("data-badge"),settings.pending||is_mobile||function(){var background=$('<div class="bg" />').appendTo(INSTANCE.item),actions=$('<div class="actions" />').appendTo(background),actions_list=$("<ul />").appendTo(actions);if(link_similar=$('<span class="link"><em>View </em>Similar Images</span>').appendTo(actions),link.attr("title",""),image.attr("title",""),show_download){var item_download=$("<li />").appendTo(actions_list),button_download=$('<button type="button" data-action="download"><span class="icon"></span><span class="label">Download</span></button>').appendTo(item_download);button_download.on("click",function(){VectorStock.downloadVector(INSTANCE.id,preferred_filetype)})}else if(show_cart&&(item_cart=$('<li class="cart-toggle" />').appendTo(actions_list),(button_cart=$('<button type="button"><em>Add to </em>Cart</button>').appendTo(item_cart)).on("click",function(){item_cart.hasClass("selected")?(unselectCartButton(),VectorStock.removeFromCart(INSTANCE.id)):(selectCartButton(),trackEvent("cart"),VectorStock.addToCart(INSTANCE.id,function(response){response.success||(unselectCartButton(),response.message&&"cart_full"==response.message&&alert("Could not add image #"+INSTANCE.id+" to Cart - limit reached"+(response.cart_total?" ("+response.cart_total+")":"")))}))}),in_cart&&selectCartButton()),show_gallery){var item_gallery=$("<li />").appendTo(actions_list),button_gallery=$('<button type="button">Gallery</button>').appendTo(item_gallery);button_gallery.on("click",function(){trackEvent("gallery"),new GalleryBox(INSTANCE.id,INSTANCE.title)})}link_similar.on("click",function(){VectorStock.search_results&&(trackEvent("similar",!0),VectorStock.search_results.setScope(SearchResults.SCOPE_ALL),VectorStock.search_results.scrollToTop()),VectorStock.search_box.setSimilar(INSTANCE.id)})}(),info.on("click",toggleSelect),link.on("click contextmenu",onClickImage),preview.on("hover",onHoverPreviewImage),$(window).on("resize",onResize).on("scroll",onScroll),score.each(function(){var article=$("body > article");score.on("mouseenter",function(){article.addClass("focus"),score.one("mouseleave",function(){article.removeClass("focus")})})}),setTimeout(function(){onResize(),image.length?image.hasClass("reveal")?onImageLoad():loadImage():SearchVector.observer_load?(INSTANCE.item.bind("loadImage",loadImage),SearchVector.observer_load.observe(INSTANCE.item[0])):($(window).on("resize scroll",isReadyToShowImage),isReadyToShowImage())})}(),INSTANCE};SearchVector.SIZE_SMALL="small",SearchVector.SIZE_MEDIUM="medium",SearchVector.SCROLL_MARGIN=200,SearchVector.TIME_VIEWED_DURATION=2500,window.IntersectionObserver&&(SearchVector.observer_load=new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){entry.isIntersecting&&($(entry.target).trigger("loadImage"),observer.unobserve(entry.target))})},{root:null,rootMargin:SearchVector.SCROLL_MARGIN+"px",threshold:0}),function(){var images_visible={};function checkViewTime(item){return(item.dataset.view_total?parseInt(item.dataset.view_total):0)+(item.dataset.view_start?Date.now()-parseInt(item.dataset.view_start):0)>SearchVector.TIME_VIEWED_DURATION&&(delete item.dataset.view_start,delete item.dataset.view_total,delete images_visible[item.dataset.vectorId],SearchVector.observer_view.unobserve(item),$(item).trigger("onViewedImage"),!0)}SearchVector.observer_view=new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){var item=entry.target,id=item.dataset.vectorId;if(entry.isIntersecting)item.dataset.view_start=Date.now(),images_visible[id]=item;else if(!checkViewTime(item)){var time_diff=item.dataset.view_start?Date.now()-parseInt(item.dataset.view_start):0,time_total=item.dataset.view_total?parseInt(item.dataset.view_total):0;item.dataset.view_total=time_total+time_diff,item.dataset.view_start=null,delete images_visible[id]}})},{root:null,rootMargin:"0px",threshold:.9}),$(function(){setInterval(function(){for(var id in images_visible){checkViewTime(images_visible[id])}},1e3)})}()),VectorStock.isProduction=function(){try{if(document.head.querySelector("[name~=dev-env]"))return!1}catch(err){console.error(err)}return!0},VectorStock.getCDNHost=function(vector_id){return vector_id=parseInt(vector_id),"https://cdn"+((vector_id=isNaN(vector_id)?0:vector_id)%5+1)+".vectorstock.com"},VectorStock.imagePath=function(vector_id,vector_title,image_size,is_pending){if(!vector_id)return"";image_size=(image_size||"small").toLowerCase();if(is_pending)return VectorStock.amazonHost+"/images/"+{small:"112x118",medium:"238x250",large:"380x400"}[image_size]+"/"+vector_id+".jpg";var url_parts=[VectorStock.getCDNHost(vector_id),"i",{small:"thumbs",medium:"thumb-large",large:"1000x1000"}[image_size]],id_formatted=vector_id.zeroPad(4);if(url_parts.push(id_formatted.substr(-4,2),id_formatted.substr(-2)),vector_title&&("string"==typeof vector_title||vector_title instanceof String)){var title_formatted=vector_title.toLowerCase()+"-vector-"+vector_id;title_formatted=(title_formatted=(title_formatted=title_formatted.replace(/[^\d\w\s-]+/g,"")).replace(/[\s-]+/g,"-")).replace(/\-+/g,"-"),url_parts.push(title_formatted+".jpg")}else url_parts.push(vector_id+".jpg");return url_parts.join("/")},VectorStock.vectorURL=function(vector_id,vector_title,is_pending){var path=is_pending?"/upload/":"/royalty-free-vector/";if(vector_title&&("string"==typeof vector_title||vector_title instanceof String)){var title_formatted=vector_title.toLowerCase()+"-vector-"+vector_id;path+=title_formatted=(title_formatted=(title_formatted=title_formatted.replace(/[^\d\w\s-]+/g,"")).replace(/[\s-]+/g,"-")).replace(/\-+/g,"-")}else path+="vector-"+vector_id;return path},VectorStock.formatCredits=function(source,target,max,min,currency){max=max||1/0,min=min||0,currency=!1!==currency;return amount=Number(source.val()),error=!0,display=0,amount===+amount&&amount===(0|amount)&&(error=amount<min||amount>max,display=amount.formatCommas()),currency&&(display="<small>$</small>"+display+".00"),target.html(display),target.parent().toggleClass("error",error),source.parent().toggleClass("error",error),error},VectorStock.formatURL=function(url_string){return url_string=(url_string=(url_string=url_string.replace(/[^\w\s-=&\?\/]+/g,"")).replace(/[\s]+/g,"-")).toLowerCase()},VectorStock.rgbToHex=function(r,g,b){var componentToHex=function(c){var hex=c.toString(16);return 1==hex.length?"0"+hex:hex};return"#"+componentToHex(r)+componentToHex(g)+componentToHex(b)},VectorStock.queryStringToParams=function(query_string){var query_pairs=$.trim(query_string).split("&"),query_params={};if(""!==query_pairs[0])for(var i=0;i<query_pairs.length;i++){var pair=query_pairs[i].split("=");query_params[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return query_params},VectorStock.setupTabs=function(){var selectTab=function(tab_new){if(!tab_new.attr("disabled")){var id_tab=tab_new.attr("data-tab-id"),group=tab_new.closest(".tabs");tab_old=tab_new.siblings(".selected").removeClass("selected"),sec_old=$("section.selected",group).removeClass("selected"),sec_new=$("section[data-tab-id="+id_tab+"]",group).addClass("selected"),tab_new.addClass("selected"),group.trigger("switch",[sec_new,sec_old])}};$(".tabs").each(function(){$("> nav li",this).on("click",function(){selectTab($(this))}).on("selectTab",function(){selectTab($(this))})})},VectorStock.setupFormElements=function(){var doc=$(document);doc.on("mouseup",".checkbox",function(){$(this).toggleClass("checked")}),doc.on("disable","button",function(event,is_loading,loading_label){var value_orig,label_orig,loading_icon,button=$(this),is_master=button.hasClass("master");if(button.prop("disabled",!0),is_loading)if(is_master){var title=$(".title",button),value=$(".value",button),wrap=$('<span class="wrapper" />').hide();value.wrapInner(wrap),label_orig=title.text(),title.text(loading_label||"LOADING..."),loading_icon=value.loadingIcon("medium")}else value_orig=button.text(),button.get(0).lastChild.nodeValue=loading_label||value_orig,loading_icon=button.loadingIcon("small"),button.addClass("loading");$(this).one("enable",function(){button.prop("disabled",!1),loading_icon&&(is_master?($(".wrapper",value).contents().unwrap(),title.text(label_orig)):(button.text(value_orig),button.removeClass("loading")),loading_icon.remove())})})},VectorStock.setupSharingButtons=function(){$("a.addthis_button").length&&$.ajax({url:VectorStock.js.addthis,dataType:"script"}).done(function(){window.addthis&&addthis.addEventListener&&addthis.addEventListener("addthis.menu.share",function(event){VectorStock.track("send","event","Share",event.data.service.toTitleCase()+" (AddThis)",window.location.pathname)})}),$("button.smedia").each(function(){var button=$(this),type=(button.closest(".share"),parseInt(button.attr("data-tally")),button.hasClass("googleplus")?"googleplus":button.hasClass("facebook")?"facebook":button.hasClass("twitter")?"twitter":button.hasClass("pinterest")?"pinterest":button.hasClass("linkedin")?"linkedin":""),popupWindow=function(url,width,height){var popup=window.open(url,"share-dialog-"+type,"width="+width+",height="+height+",resizable=1,toolbar=0,menubar=0,status=0,location=0");if(!button.data("static"))var popup_int=setInterval(function(){popup.closed&&(checkTally(),clearInterval(popup_int))},5e3)},checkTally=function(){};button.on("click",function(){var url=$('meta[property="og:url"]').attr("content"),img=$('meta[property="og:image"]').attr("content"),title=$('meta[property="og:title"]').attr("content"),desc=$('meta[property="og:description"]').attr("content");switch(type){case"googleplus":var params="url="+encodeURIComponent(url);popupWindow("https://plus.google.com/share?"+params,600,450),type="Google";break;case"facebook":params=["s=100","p[url]="+encodeURIComponent(url),"p[images][0]="+encodeURIComponent(img),"p[title]="+escape("VectorStock: "+title),"p[summary]="+escape(desc)];popupWindow("https://www.facebook.com/sharer.php?"+params.join("&"),626,326);break;case"twitter":params="text="+escape(title)+escape(" from VectorStock:\n")+encodeURIComponent(url);popupWindow("https://twitter.com/intent/tweet?"+params,600,256)}VectorStock.track("send","event","Share",type.toTitleCase()+" (Custom)",window.location.pathname)})})},VectorStock.setupFacebookLike=function(){$("#fb-root").length||($("body").append('<div id="fb-root" />'),$.ajax({url:VectorStock.js.facebook,dataType:"script"}))},VectorStock.setupCompetition=function(){var element=$("#competition");element.length&&Competition(element)},VectorStock.goToURL=function(url,replace){try{var anchor=document.createElement("a");anchor.href=url;var pathname=("/"==anchor.pathname[0]?"":"/")+anchor.pathname,event=$.Event("redirect");$(window).trigger(event,[url,pathname]),event.isDefaultPrevented()||(replace?window.location.replace(url):window.location.assign(url))}catch(error){VectorStock.track("send","event","Error (JS)","CustomError: Go to URL failed",url)}},VectorStock.preloadImages=function(images){for(var img=new Image,i=images.length;i--;)img.src=images[i]},VectorStock.loadImage=function(image_src){var event_load,event_error,INSTANCE={},image=new Image;return INSTANCE.then=function(callback){return event_load=callback,INSTANCE},INSTANCE.catch=function(callback){return event_error=callback,INSTANCE},image.onload=function(){event_load&&setTimeout(function(){event_load.apply(image,[image_src])},10)},image.onerror=function(error){event_error&&event_error.apply(image,[error])},image.src=image_src,INSTANCE},VectorStock.addToCart=function(vector_id,license,callback){if(VectorStock.isNumeric(vector_id)){"function"==typeof license&&(callback=license,license=null);var url="/api/cart/add/"+vector_id+(license?"/"+license:"");$.get(url,function(response){try{response.success&&VectorStock.userData.addToSyncedCart(response.id,response.license),response.cart_hash&&($("meta[name=cart-hash]").attr("content",response.cart_hash),VectorStock.cartSync())}catch(e){}VectorStock.setCartTally(response.cart_total),callback&&callback(response)},"json"),VectorStock.track("send","event","Add To Cart","Image",JSON.stringify({id:vector_id}))}},VectorStock.removeFromCart=function(vector_id,callback){VectorStock.isNumeric(vector_id)&&$.get("/api/cart/remove/"+vector_id,function(response){try{response.success&&VectorStock.userData.removeFromSyncedCart(response.id),response.cart_hash&&($("meta[name=cart-hash]").attr("content",response.cart_hash),VectorStock.cartSync())}catch(e){}VectorStock.setCartTally(response.cart_total),callback&&callback(response)},"json")},VectorStock.updateCartImageLicense=function(vector_id,vector_license){$.get("/api/cart/license/"+vector_id+"/"+vector_license,function(response){try{response.success&&VectorStock.userData.addToSyncedCart(response.id,response.license,!1),response.cart_hash&&($("meta[name=cart-hash]").attr("content",response.cart_hash),VectorStock.cartSync())}catch(e){}VectorStock.setCartTally(response.cart_total)},"json")},VectorStock.emptyCart=function(callback){$.get("/api/cart/empty",function(response){try{response.success&&VectorStock.userData.emptySyncedCart(response.id),response.cart_hash&&($("meta[name=cart-hash]").attr("content",response.cart_hash),VectorStock.cartSync())}catch(e){}VectorStock.setCartTally(0),callback&&callback(response)},"json")},VectorStock.cartSync=function(){VectorStock.userData.isCartSynced()||$.put("/api/cart/sync",{cart:VectorStock.userData.getSyncedCart()}).success(function(response){response.success&&VectorStock.userData.setSyncedCart(response.cart_update,response.cart_hash)})},VectorStock.setupCartSync=function(){window.addEventListener("storage",function(e){try{if("synced_cart"===e.key&&(VectorStock.userData.markCartUpdated(),VectorStock.cart_page)){var sc=JSON.parse(e.newValue)||[];document.title="Your Cart ("+sc.length+") - VectorStock"}}catch(err){}},!1),window.addEventListener("focus",function(e){try{VectorStock.userData.hasCartUpdated()&&VectorStock.setCartTally(VectorStock.userData.reloadSyncedCart())}catch(err){}},!1),VectorStock.cartSync()},VectorStock.setupScrollPositionCache=function(){try{var ScrollPositionKey="scrollPosition_"+document.location.pathname;if(window.onbeforeunload=function(){var scrollPosition=$(document).scrollTop();120<=scrollPosition&&sessionStorage.setItem(ScrollPositionKey,scrollPosition.toString())},sessionStorage[ScrollPositionKey]){var scrollPosition=parseInt(sessionStorage.getItem(ScrollPositionKey));scrollPosition&&($(document).scrollTop(scrollPosition),sessionStorage.removeItem(ScrollPositionKey))}}catch(e){}},VectorStock.setCartTally=function(tally,callback){if(tally||0===tally){var item=$("#sb_account li[data-id=cart]");if(0===item.length&&($("#nav_sidebar > nav li[data-tab-id=login]").trigger("selectTab"),0==(item=$("#sb_login li[data-id=cart]")).length)){var extras=$('<div class="extras" />').appendTo("#sb_login"),list=($("<h6>Account</h6>").appendTo(extras),$("<ul />").appendTo(extras));item=$('<li data-id="cart"><a href="/cart"><span class="title">Cart</span><span class="value empty"><var data-value="0">0</var></span><span class="icon"></span></a></li>').appendTo(list),extras.hide().slideDown(500,"easeOutCubic")}if(item.trigger("setTally",tally),item=$('#mobilenav-menu li[data-id="cart"]'),tally=tally&&tally.formatCommas?tally.formatCommas():tally,0===item.length){list=$("#mobilenav-menu ul").eq(1);item=$('<li data-id="cart"><a href="/cart">Cart <em></em></a></li>').appendTo(list)}$("em",item).text("("+tally+")")}},VectorStock.likeImage=function(vector_id,callback){$.get("/api/likes/add/"+vector_id,function(response){callback&&callback(response)},"json")},VectorStock.unlikeImage=function(vector_id,callback){$.get("/api/likes/remove/"+vector_id,function(response){callback&&callback(response)},"json")},VectorStock.updateTally=function(type,offset){$("#sb_account li[data-id="+type+"]").trigger("updateTally",offset)},VectorStock.setTally=function(type,tally){$("#mobilenav-menu li[data-id="+type+"] a em").text("("+tally+")"),$("#sb_account li[data-id="+type+"]").trigger("setTally",tally)},VectorStock.updateFollowingCount=function(offset){var item_sb=$('#sb_account li[data-id="following"]'),item_mb=$('#mobilenav-menu li[data-id="artists"] em'),tally=parseInt($("a .value var",item_sb).data("value"))+offset;item_sb.trigger("setTally",tally),item_mb.length&&item_mb.html("("+tally+")")},VectorStock.addToFollowing=function(artist_name,callback){artist_name&&(VectorStock.updateFollowingCount(1),$.put("/api/following/"+artist_name).success(function(response){response.success?response.artist_id&&VectorStock.userData.followArtist(response.artist_id):VectorStock.updateFollowingCount(-1),callback&&callback(response)}).fail(function(){VectorStock.updateFollowingCount(-1),callback&&callback()}))},VectorStock.removeFromFollowing=function(artist_name,callback){artist_name&&(VectorStock.updateFollowingCount(-1),$.delete("/api/following/"+artist_name).success(function(response){response.success?response.artist_id&&VectorStock.userData.unfollowArtist(response.artist_id):VectorStock.updateFollowingCount(1),callback&&callback(response)}).fail(function(){VectorStock.updateFollowingCount(1),callback&&callback()}))},VectorStock.isLoggedIn=function(){return $("body > header > div > nav ul.account").length&&0==$("body > header > div > nav ul.account li.signup").length||0<$("#nav_sidebar #sb_account").length},VectorStock.trackPurchase=function(transaction_type,transaction_id,transaction_cost,user_email,user_country,provider_type,provider_id){var transaction_name,transaction_category,transaction_price=transaction_cost,transaction_quantity="1";switch(transaction_type.toLowerCase()){case"credits":transaction_price="1",transaction_quantity=transaction_cost,transaction_name=provider_type+" Credit Purchase",transaction_category="VS Currency";break;case"subscription":transaction_name=provider_type+" Subscription Purchase",transaction_category="VS Subscription";break;case"singleimage":case"single-image":transaction_name=provider_type+" Single-Image Purchase",transaction_category="VS Single-Image"}try{ga("require","ecommerce"),ga("ecommerce:addTransaction",{id:transaction_id,affiliation:"VectorStock Media",revenue:transaction_cost,shipping:0,tax:"na"}),ga("ecommerce:addItem",{id:transaction_id,name:transaction_name,sku:provider_id,category:transaction_category,price:transaction_price,quantity:transaction_quantity}),ga("ecommerce:send")}catch(err){window.console&window.console.log&&console.log(err)}},VectorStock.setupPlaceholderSupport=function(){if(!("placeholder"in document.createElement("input"))){$(document).on("focus","input, textarea",function(){$(this).isEmpty()&&$(this).removeClass("empty").val("")}).on("blur","input, textarea",function(){if($(this).isEmpty()){var placeholder=$(this).attr("placeholder")||"";$(this).removeClass("empty").val(placeholder)}}),$("input, textarea").each(function(){var placeholder=$(this).attr("placeholder")||"";""==$(this).val()&&""!=placeholder?$(this).addClass("empty").val(placeholder):$(this).val()==placeholder&&$(this).addClass("empty")})}},VectorStock.scrollTo=function(target,duration,easing,callback){var y_target=isNaN(target)?target.offset().top:target,doc_height=(duration=isNaN(duration)?500:duration,callback="function"==typeof easing?easing:callback,easing=easing||"easeInOutQuad",$(document).height()),win_height=$(window).height();if(win_height<doc_height){doc_height<y_target+win_height&&(y_target=doc_height-win_height);var cancelScroll=function(){$("html, body").stop(),$(window).off("mousewheel",cancelScroll),callback&&callback()};$(window).on("mousewheel",cancelScroll),$("html, body").animate({scrollTop:y_target},duration,easing,cancelScroll)}},VectorStock.downloadVector=function(vector_id,preferred_filetype){$.get("/api/vector/download/"+vector_id,function(response){if(1==response.success){var url_download=response.url;preferred_filetype&&response.file_urls&&response.file_urls[preferred_filetype]&&(url_download=response.file_urls[preferred_filetype]),VectorStock.goToURL(url_download)}},"json")},VectorStock.sanitizeInput=function(value){return"string"==typeof value?value:$(value).text()},VectorStock.trackConversion=function(settings,callback){function track(){if(window.google_conversion_id=1056033416,window.google_conversion_format="3",window.google_remarketing_only=!1,settings)for(var setting in settings)window[setting]=settings[setting];if(window.google_trackConversion){var handler=callback?{onload_callback:callback}:void 0;window.google_trackConversion(handler)}}window.google_trackConversion?track():$.ajax({url:"https://www.googleadservices.com/pagead/conversion_async.js",dataType:"script"}).done(track)},VectorStock.isNumeric=function(value){return!isNaN(parseFloat(value))&&isFinite(value)},VectorStock.browserSupport=function(feature){switch(feature){case"localStorage":try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}case"sessionStorage":try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(e){return!1}default:return null}},VectorStock.isMobile=function(){var ua=window.navigator.userAgent.toLowerCase();return/mobile|midp/.test(ua)},VectorStock.hashString=function(str){var i,hash=0;if(0===str.length)return hash;for(i=0;i<str.length;i++)hash=(hash<<5)-hash+str.charCodeAt(i),hash|=0;return hash},VectorStock.abbreviateNumber=function(value){var newValue=parseInt(value);if(1e3<=parseInt(value)){for(var suffixNum=Math.floor((""+value).length/3),shortValue="",precision=2;1<=precision;precision--){if(((shortValue=parseFloat((0!=suffixNum?value/Math.pow(1e3,suffixNum):value).toPrecision(precision)))+"").replace(/[^a-zA-Z 0-9]+/g,"").length<=2)break}shortValue%1!=0&&(shortValue=shortValue.toFixed(1)),newValue=shortValue+["","k","m","b","t"][suffixNum]}return newValue},VectorStock.setupHeader=function(){$("body > #banner-email-issue").each(function(){var overlay,box,field_email,input_email,but_submit,HTML_TEMPLATE='<div id="box-email-issue"><div class="wrap"><div class="header"><h4>Account Email Issue</h4></div><div class="body"><p>We tried to send you an email but it was rejected by your mail server.</p><p>This can happen for a number of reasons, such as the address does not exist or the email was marked as SPAM.</p><p>Please check the email address we have listed for you below and adjust if necessary:</p><form><fieldset name="email"><input type="email" name="email_address" placeholder="Email address"></fieldset><button type="button"><span class="label">Confirm Email Address</span></button></form></div></div></div>',REGEX_EMAIL=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,API_URL_UPDATE="/api/account/email/quickupdate",API_URL_VALIDATE="/api/account/email/validate",banner=$(this),email_address=banner.data("email-address"),csrf_name=banner.data("csrf-name"),csrf_value=banner.data("csrf-value");function closePopup(){overlay&&(overlay.remove(),overlay=null)}function onClickOverlay(event){overlay&&$(event.target)[0]==overlay[0]&&closePopup()}function showError(message){field_email.addClass("error"),$("p",field_email).remove(),$("<p>"+message+"</p>").appendTo(field_email)}function resetForm(){input_email.prop("disabled",!1).focus(),but_submit.prop("disabled",!1),$(".label",but_submit).text("Confirm Email Address"),$(".vs_loadicon",but_submit).remove()}function updateEmailAddress(){if(field_email.removeClass("error"),$("p",field_email).remove(),input_email.val().match(REGEX_EMAIL)){input_email.prop("disabled",!0),but_submit.prop("disabled",!0).loadingIcon(),$(".label",but_submit).text("Updating Account Email...");var request_url=input_email.val().toLowerCase()===email_address.toLowerCase()?API_URL_VALIDATE:API_URL_UPDATE,request_params={email:input_email.val(),csrf_emailupdate_name:csrf_name,csrf_emailupdate_value:csrf_value};$.put(request_url,request_params).done(function(response){response.success?($(".label",but_submit).text("Email Address updated!"),$(".vs_loadicon",but_submit).remove(),$('<span class="icon" />').appendTo(but_submit),banner.remove(),setTimeout(closePopup,2e3),VectorStock.track("send","event","Action","Bounced Email Address Update",request_params.email)):(resetForm(),showError(response&&response.message?response.message:"There was an error with your email address"),response&&(csrf_name=response.csrf_update.csrf_name,csrf_value=response.csrf_update.csrf_value),VectorStock.track("send","event","Action","Bounced Email Address Update Error",JSON.stringify(response)))}).fail(function(xhr,text_status,error){0==xhr.status&&(resetForm(),showError("Could not connect to update email address"),VectorStock.track("send","event","Action","Bounced Email Address Update Failed",JSON.stringify(response)))})}else showError("Invalid email pattern - update and try again")}banner.on("click",function(){overlay=$('<div class="overlay" />').css({height:$(document).height()}).appendTo("body").on("click",onClickOverlay),setTimeout(function(){overlay.addClass("reveal")}),box=$(HTML_TEMPLATE).appendTo(overlay),setTimeout(function(){box.addClass("reveal")}),field_email=$('fieldset[name="email"]',box),input_email=$('input[type="email"]',field_email),but_submit=$("button",box),input_email.val(email_address),setTimeout(function(){input_email.focus()},500),input_email.on("keydown",function(event){13==event.keyCode&&(updateEmailAddress(),event.preventDefault())}),but_submit.on("click",updateEmailAddress)})}),$("#searchbox").each(function(){var nav_items=$("body > header .grid ul li a"),link_all=nav_items.eq(0),link_free=nav_items.eq(1);VectorStock.search_box=SearchBox($(this)),VectorStock.search_box.on("change",function(params){if(VectorStock.search_box.mode==SearchBox.MODE_STATIC){var data=new SearchResultData(params);VectorStock.goToURL(data.url)}else{(params.artists||params.categories||params.similar)&&(link_all.parent().addClass("selected"),link_free.parent().removeClass("selected"));var data_all=new SearchResultData($.extend({type:SearchResultData.TYPE_BROWSE},params)),data_free=new SearchResultData($.extend({type:SearchResultData.TYPE_FREE},params));link_all.attr("href",data_all.url),link_free.attr("href",data_free.url)}});var search_type=$("#search_type").val();search_type!==SearchResultData.TYPE_BROWSE&&search_type!==SearchResultData.TYPE_FREE&&VectorStock.search_box.setMode(SearchBox.MODE_STATIC)}),$("body > header nav.top .aside li.account").each(function(){$('button[data-action="signup"]',this).on("click",function(){VectorStock.goToURL("/signup")}),$('button[data-action="login"]',this).on("click",function(){new SignupBox({screen:"login"})})});new MenuMobile},VectorStock.setupSidebar=function(){$("#nav_sidebar").each(function(){var scope=$(this),setTally=function(item,value_new){var container=$(".value",item),tally_old=$("var",container).last(),value_old=tally_old.data("value");value_new=Math.max(value_new,0);var label_new=VectorStock.abbreviateNumber(value_new);if(isNaN(label_new)||(label_new=label_new.formatCommas(!0)),value_new!==value_old){if(item.closest("nav").hasClass("primary")){var class_new=value_old<value_new?"increase":"decrease",class_old=value_old<value_new?"decrease":"increase",tally_new=$("<var>"+label_new+"</var>").addClass(class_new).toggleClass("empty",0===value_new).attr("data-value",value_new).appendTo(container);item.addClass("highlight"),setTimeout(function(){tally_old.addClass(class_old),tally_new.removeClass(class_new)},25),setTimeout(function(){item.removeClass("highlight")},1e3)}else tally_old.attr("data-value",value_new).text(label_new).addClass("hidden"),setTimeout(function(){tally_old.removeClass("hidden")},25);0!==value_new||$(".alert",item).length||$('<span class="alert" />').prependTo($("a",item))}};$(".textfield",scope).each(function(){var textfield=$(this),fieldset_tf=textfield.closest("fieldset"),input=$("input",textfield);textfield.on("click",function(){input.focus()}),input.on("focus",function(){fieldset_tf&&fieldset_tf.addClass("focus")}).on("blur",function(){fieldset_tf&&fieldset_tf.removeClass("focus")})}),$(".checkbox label",scope).on("mouseup",function(){$(this).toggleClass("selected")}),$("#sb_signup",scope).each(function(){var tab=$(this);$(".footer button",tab).on("click",function(){VectorStock.goToURL("/signup")})}),$("#sb_login",scope).each(function(){var tab=$(this),form=$("form",tab),login=$("> button",form),credentials_changed=!1;$("#vs_username",tab).on("input",function(){credentials_changed=!0}),$("#vs_password",tab).on("input",function(){credentials_changed=!0});var showMessage=function(message,forgotten){var container=$(".message",tab);if(login.trigger("enable"),0===container.length){container=$('<div class="message" />');var wrap1=$('<div class="wrap1" />').appendTo(container);$('<div class="wrap2" />').appendTo(wrap1);login.before(container)}$(".wrap2",container).empty().append('<p class="offset">'+message+"</p>"),forgotten&&$(".wrap2",container).append('<p class="offset"><a href="/request/password">Click here if you&rsquo;d like a reminder...</a></p>'),setTimeout(function(){$("p",container).removeClass("offset")},25)},matchAutoFillColors=function(){var filled={};try{$("input:-webkit-autofill",form).each(function(){filled[$(this).attr("id")]=!0})}catch(err){}$("input",form).each(function(){var color_txt="",color_bg="";filled[$(this).attr("id")]&&(color_txt=$(this).css("color"),color_bg=$(this).css("backgroundColor")),$(this).css({color:color_txt}),$(this).parent().css({backgroundColor:color_bg})})};$("button.forgot",tab).on("click",function(){VectorStock.goToURL("/request/password")}),$("input",form).on("blur",matchAutoFillColors),setTimeout(matchAutoFillColors,500),login.on("click",function(event){var username=$("#vs_username",tab).val(),password=$("#vs_password",tab).val(),remember=$("#vs_remember",tab).is(":checked");if(""==username)showMessage("Missing username...");else if(""==password)showMessage("Missing password...",!0);else if(credentials_changed){$(".message",tab).remove(),login.trigger("disable",[!0,"Checking..."]);var params={login_user:username,login_password:password,login_remember:remember},csrf_name=$('meta[name="csrf-name"]'),csrf_value=$('meta[name="csrf-value"]');csrf_name.length&&csrf_value.length&&(params.csrf_name=csrf_name.attr("content"),params.csrf_value=csrf_value.attr("content"));var retried=credentials_changed=!1,onDone=function(response,textStatus,xhr){if(1==response.success)response.profile&&VectorStock.userData.setProfile(response.profile),response.redirect?VectorStock.goToURL(response.redirect):window.location.reload(!0);else{if(response.csrf_token&&(csrf_name.attr("content",response.csrf_token.csrf_name),csrf_value.attr("content",response.csrf_token.csrf_value)),response.message)showMessage(response.message,"DISABLED"!==response.error);else{showMessage("Unknown server issue - Please try again later",!0);var log={username:username,status:textStatus,code:xhr.status,response:JSON.stringify(response),headers:xhr.getAllResponseHeaders()};VectorStock.track("send","event","Error (JS)","CustomError: Login issue (sidebar) - Missing server message",JSON.stringify(log))}login.trigger("enable")}},onFail=function(xhr,textStatus,errorThrown){if(400==xhr.status||429==xhr.status){try{var response=JSON.parse(xhr.responseText);if(response.csrf_token&&(csrf_name.attr("content",response.csrf_token.csrf_name),csrf_value.attr("content",response.csrf_token.csrf_value),!retried))return retried=!0,params.csrf_name=response.csrf_token.csrf_name,params.csrf_value=response.csrf_token.csrf_value,void $.ajax({type:"POST",url:"/api/json/login",data:params}).done(onDone).fail(onFail);response.message?showMessage(response.message,!0):showMessage("Connection failed - Please try again later",!0)}catch(e){showMessage("Connection failed - Please try again later",!0)}var log={username:username,status:textStatus,code:xhr.status,response:xhr.responseText,error:errorThrown,headers:xhr.getAllResponseHeaders()};VectorStock.track("send","event","Error (JS)","CustomError: Login issue (sidebar) - Blocked by server",JSON.stringify(log)),login.trigger("enable")}else 403==xhr.status?(showMessage("Connection failed - Please try again later",!0),log={username:username,status:textStatus,code:xhr.status,error:errorThrown,headers:xhr.getAllResponseHeaders()},VectorStock.track("send","event","Error (JS)","CustomError: Login issue (sidebar) - Blocked by firewall",JSON.stringify(log)),window.location.reload(!0)):(showMessage("Connection failed - Please try again later",!0),log={username:username,status:textStatus,code:xhr.status,error:errorThrown,headers:xhr.getAllResponseHeaders()},VectorStock.track("send","event","Error (JS)","CustomError: Login issue (sidebar) - Failed for unknown reason",JSON.stringify(log)),login.trigger("enable"))};$.ajax({type:"POST",url:"/api/json/login",data:params}).done(onDone).fail(onFail)}event.preventDefault(),event.stopPropagation()}),$(".alternatives li",tab).each(function(){var item=$(this),link=$("a",item),title=$(".title",link);link.on("click",function(){var title_pre=title.text();item.addClass("loading"),title.text("Connecting...");var icon=link.loadingIcon("small");function restoreLink(){item.removeClass("loading"),title.html(title_pre),icon.remove()}return item.hasClass("gp")?$.get("/api/google/auth",function(response){restoreLink(),1==response.success&&(VectorStock.userData.destroy(),VectorStock.goToURL(response.url))}):item.hasClass("fb")&&$.post("/api/json/fblogin",function(response){restoreLink(),1==response.success&&(VectorStock.userData.destroy(),VectorStock.goToURL(response.url))},"json"),!1})}),tab.on("setTally",".extras li",function(event,value_new){setTally($(this),value_new)}).on("updateTally",".extras li",function(event,value_offset){var value=parseInt($("var",this).attr("data-value"))+value_offset;setTally($(this),value)})}),$("#sb_account",scope).each(function(){var tab=$(this),form=$("form",tab),logout=$("button",tab);$("li",tab).on("setTally",function(event,value_new){setTally($(this),value_new)}).on("updateTally",function(event,value_offset){var value=parseInt($("var",this).attr("data-value"))+value_offset;setTally($(this),value)}),logout.on("click",function(){VectorStock.userData.destroy(),form.submit()})})})},VectorStock.setupFooter=function(){var sel_legals=$("#legals");sel_legals.length&&(sel_legals.on("change",function(){var path=$("option:checked",this).val();path&&VectorStock.goToURL(path)}),sel_legals.dropdown&&sel_legals.dropdown({theme:"dark"}))},$(function(){VectorStock.userData=UserData(),VectorStock.setupHeader(),VectorStock.setupSidebar(),VectorStock.setupFooter(),VectorStock.setupTabs(),VectorStock.setupFormElements(),VectorStock.setupCompetition(),VectorStock.setupCartSync(),VectorStock.setupScrollPositionCache(),VectorStock.setupPlaceholderSupport()});